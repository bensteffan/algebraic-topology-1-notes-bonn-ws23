\section{Spectral Sequences}
\begin{definition}
	A (\strong{homologically}\index{spectral sequence!homologically graded}/\strong{Serre graded}\index{spectral sequence!Serre graded}) \strong{spectral sequence}\index{spectral sequence} is a triple $(E^\bullet, d^\bullet, h^\bullet)$ where
	\begin{itemize}
		\item $(E^r)_{r \geq 2}$ is a sequence of $\Z$-bigraded abelian groups which we usually write $E^r_{p, q}$.
			The entry $E^r$ is called the $r$th \strong{page}\index{page!of a spectral sequence} of the spectral sequence.
		\item $d^r\colon E^r \to E^r$ is a sequence of morphisms (called \strong{differentials}\index{differential!of a spectral sequence}) of bidegree $(-r, r - 1)$ satisfying $d^r \circ d^r = 0$.
		\item $h^r\colon H_*(E^r) \to E^{r + 1}$ is a sequence of bigrading-preserving isomorphisms.
			Here $H_*(E^r)$ denotes the homology of $E^r$ with respect to $d^r$, which inherits a bigrading.
	\end{itemize}
\end{definition}
\lecture{13.10.23}
\begin{figure}[ht]
	\centering
	\tikzsetnextfilename{specseq_diffstructexpl}
	\begin{tikzpicture}[
		pagemember/.style = {
			fill = white, 
			font = \tiny, 
			inner sep = 0.5pt
		}]
		\def\xmin{-3}
		\def\xmax{3}
		\def\ymin{-3}
		\def\ymax{3}
		\begin{scope}
			\coordinate (origin) at (0, 0);
			\draw[spectral sequence/axis] (\xmin, 0) -- (\xmax, 0) node[below] {$p$};
			\draw[spectral sequence/axis] (0, \ymin) -- (0, \ymax) node[left] {$q$};
			\foreach \x [parse = true, evaluate = \x using int(\x)] in {\xmin + 1, ..., \xmax - 1}{
				\foreach \y [parse = true, evaluate = \y using int(\y)] in {\ymin + 1, ..., \ymax - 1}{
					\node[pagemember] (E2-\x-\y) at (\x, \y) {$E^2_{\x, \y}$};
				}
			}
			\foreach \x [parse = true, evaluate = \x using int(\x)] in {\xmin + 3, ..., \xmax - 1}{
				\foreach \y [parse = true, evaluate = \y using int(\y)] in {\ymin + 1, ..., \ymax - 2}{
					\tikzmath{
						int \tx, \ty;
						\tx = \x - 2;
						\ty = \y + 1;
					}
					\draw[->] (E2-\x-\y) -- (E2-\tx-\ty);
				}
			}
		\end{scope}
		\begin{scope}[xshift = 2.5 * \xmax cm]
			\coordinate (origin) at (0, 0);
			\draw[spectral sequence/axis] (\xmin, 0) -- (\xmax, 0) node[below] {$p$};
			\draw[spectral sequence/axis] (0, \ymin) -- (0, \ymax) node[left] {$q$};
			\foreach \x [parse = true, evaluate = \x using int(\x)] in {\xmin + 1, ..., \xmax - 1}{
				\foreach \y [parse = true, evaluate = \y using int(\y)] in {\ymin + 1, ..., \ymax - 1}{
					\node[pagemember] (E3-\x-\y) at (\x, \y) {$E^3_{\x, \y}$};
				}
			}
			\foreach \x [parse = true, evaluate = \x using int(\x)] in {\xmin + 4, ..., \xmax - 1}{
				\foreach \y [parse = true, evaluate = \y using int(\y)] in {\ymin + 1, ..., \ymax - 3}{
					\tikzmath{
						int \tx, \ty;
						\tx = \x - 3;
						\ty = \y + 2;
					}
					\draw[->] (E3-\x-\y) -- (E3-\tx-\ty);
				}
			}
		\end{scope}
		\draw[|->, thick] (1.2 * \xmax, 0) --++(0:.2 * \xmax) node[anchor = south, midway, font = \scriptsize] {$H_*({{-}})$};
	\end{tikzpicture}
	\caption{$E^2$- and $E^3$-pages of a homologically graded spectral sequence}
\end{figure}
\begin{definition}
	We say a spectral sequence is \strong{first quadrant}\index{spectral sequence!first quadrant} if all the groups $E^2_{p, q}$ are trivial whenever $p < 0$ or $q < 0$.
\end{definition}
\begin{figure}[ht]
	\centering
	\tikzsetnextfilename{specseq_firstquadrant}
	\begin{tikzpicture}[
		shaded/.style = {
			postaction = {
				pattern = {
					Lines[angle = 45, distance = 5pt]
				}
			}
		}]
		\draw[spectral sequence/axis] (-3, 0) -- (3, 0) node[below] {$p$};
		\draw[spectral sequence/axis] (0, -3) -- (0, 3) node[left] {$q$};

		\path[shaded] (0, 0) -- (0, 2.87) -- (-2.87, 2.87) -- (-2.87, -2.87) -- (2.87, -2.87) -- (2.87, 0) -- cycle;
		\node[draw = none, fill = white, inner sep = 2pt, outer sep = 0] at (2.7, 2.7) {$E^2_{p, q}$};
	\end{tikzpicture}
	\caption{A first-quadrant spectral sequence. All potentially nontrivial groups live in the unshaded quadrant.}
\end{figure}
\begin{lemma}
	For a first quadrant spectral sequence $(E^\bullet, d^\bullet, h^\bullet)$ we have $E^r_{p, q} = 0$ if $p < 0$ or $q < 0$ for all $r \geq 2$.
	Moreover, for a given pair $(p, q) \in \Z \times \Z$ the map $h$ induces an isomorphism for all $r > r_0 \coloneq \max(p, q + 1)$, i.e. the groups $E^r_{p, q}$ stabilize as $r \to \infty$.
\end{lemma}
\begin{proof}
	The first statement follows immediately from the existence of $h^\bullet$ by induction on $r$.
	For the second statement, if $r > r_0$, then the target of the differential $d^r\colon E^r_{p, q} \to E^r_{p - r, q + r - 1}$ is trivial since $p - r < 0$, so every element of $E^r_{p, q}$ is a cycle.
	Moreover, the domain of the incoming differential $E^r_{p + r, q - r + 1} \to E^r_{p, q}$ is trivial since $q - r + 1 < 0$, so $E^r_{p, q} \isom H_*(E^r_{p, q}) \isom E^{r + 1}_{p, q}$.
\end{proof}
\begin{definition}
	For a first quadrant spectral sequence $(E^\bullet, d^\bullet, h^\bullet)$ we define its \strong{$E^\infty$-page}\index{$E^\infty$-page} as the bigraded abelian group
	\begin{equation*}
		E^\infty_{p, q} \coloneq E^{r_0(p, q) + 1}_{p, q}
	\end{equation*}
	with $r_0(p, q) \coloneq \max(p, q + 1)$.
	By the previous lemma, $E^\infty_{p, q} \isom E^r_{p, q}$ whenever $r > r_0(p, q)$.
\end{definition}
By a \strong{filtered object}\index{filtered object} $(H, F)$ in an abelian category $\mathcal{A}$ we mean an object $H \in \mathcal{A}$ together with a sequence of inclusions
\begin{equation*}
	0 = F^{-1} \subseteq F^0 \subseteq F^1 \subseteq \ldots \subseteq F^n \subseteq \ldots \subseteq H
\end{equation*}
We will apply this to the category of graded abelian groups and $H = H_*(E; \Z)$.
Notationally, if $(H, F)$ is a filtered object in abelian groups, we write $F^n_m$ for the $n$th object in the filtration associated to the group $H_m$; in other words, $F^0_m \subseteq F^1_m \subseteq \ldots \subseteq H_m$ is the filtration associated to $H_m$.
\begin{definition}
	A first quadrant spectral sequence is said to \strong{converge}\index{convergence!of spectral sequences} to a filtered object in graded abelian groups $(H, F)$ if there is a chosen isomorphism
	\begin{equation*}
		E^\infty_{p, q} \isom F^p_{p + q} / F^{p - 1}_{p + q}
	\end{equation*}
	for all values of $p$ and $q$, and $F^p_n = H_n$ if $p \geq n$.
	In this case, we write $E^2_{p, q} \Rightarrow H$.
\end{definition}
\begin{figure}[ht]
	\centering
	\tikzsetnextfilename{specseq_convergence}
	\begin{tikzpicture}[
			dot/.style = {
				draw,
				fill, 
				circle,
				inner sep = 1pt,
			},
			pin distance = 1em,
			every pin/.style = {
				font = \footnotesize,
			},
			every label/.style = {
				font = \footnotesize,
			},
		]
		\def\maxextent{4}

		\coordinate (Origin) at (0, 0);
		\coordinate (Bottom Right) at (\maxextent, 0);
		\coordinate (Top Left) at (0, \maxextent);
		\coordinate (Y Midway) at ($(Origin)!0.5!(Top Left)$);
		\coordinate (X Midway) at ($(Origin)!0.5!(Bottom Right)$);

		\draw[spectral sequence/axis] (Origin) -- (Bottom Right) node[below] {$p$};
		\draw[spectral sequence/axis] (Origin) -- (Top Left) node[left] {$q$};

		\draw[line width = 0.6pt] (Y Midway) -- (X Midway);

		\node[dot, pin = below left:{$F_0^0 = H_0$}] at (Origin) {};
		\node[dot, "$n$" left, pin = 65:$F_n^0$] at (Y Midway) {};
		\node[dot, pin = 50:$F_n^1 / F_n^0$] at ($(Y Midway)!0.15!(X Midway)$) {};
		\node[dot, pin = 25:$F_n^2 / F_n^1$] at ($(Y Midway)!0.30!(X Midway)$) {};
		\node[inner sep = 0.1pt, circle, fill = white, font = \scriptsize] at ($(Y Midway)!0.45!(X Midway)$) {$\ddots$};
		\node[dot, "$n$" below, pin = above right:{$\overbrace{F_n^n}^{= H_n} / F_n^{n - 1}$}] at (X Midway) {};

		\node[inner sep = 1pt, font = \footnotesize] (Label Node) at (3.5, 3.5) {$E_{p, q}^\infty$};
		\draw[line width = 0.7pt] (Label Node.north west) -- (Label Node.south west) -- (Label Node.south east);
	\end{tikzpicture}
	\caption{Convergence of a first-quadrant spectral sequence.}
\end{figure}
\begin{remark}
	\leavevmode
	\begin{itemize}
		\item Convergence is really a \emph{datum} of isomorphism $E^\infty_{p, q} \isom F^p_{p + q} / F^{p - 1}_{p + q}$ and not a property.
		\item Convergent spectral sequences are often simply encoded as $E^2_{p, q} \Rightarrow H$, but this suppresses not only this data but also the higher pages, the differentials, and the filtration on $H$!
	\end{itemize}
\end{remark}

\subsection{Fibre Sequences}
In order to be able to move onto the definition of the Serre spectral sequence for fibre sequences, let us define exactly what we mean by \enquote{fibre sequence.}
\begin{definition}
	Let $f\colon Y \to X$ be a map of spaces and $x \in X$ a point.
	The \strong{homotopy fibre}\index{homotopy fibre} $\hofib_x(f)$ of $f$ at $x$ is the space
	\begin{equation*}
		\hofib_x(f) \coloneq P_x X \times_X Y
	\end{equation*}
	where $P_x X = \{\gamma\colon I \to X \mid \gamma(1) = x\}$ is the \strong{based path space}\index{path space} of $X$.
	It comes with the evaluation at 0 map $\ev_0\colon P_x X \to X,\ \gamma \mapsto \gamma(0)$.
	In fact, it is the pullback
	\begin{equation*}
		\begin{tikzcd}
			\hofib_x(f)
					\ar[r]
					\ar[d]
					\ar[dr, phantom, "\lrcorner" very near start]
				& P_x X
					\ar[d, "\ev_0"]
			\\
			Y 
					\ar[r, "f"]
				& X
		\end{tikzcd}
	\end{equation*}
\end{definition}
In words, $\hofib_x(f)$ is the space of pairs $(\gamma, y)$ where $y \in Y$ is a point and $\gamma$ is a path from $f(y)$ to $x$.
We note that $P_x X$ is contractible via the homotopy
\begin{align*}
	H\colon P_x X \times I &\to P_x X \\
	(\gamma, t) &\mapsto (s \mapsto \gamma((1 - t)s + t))
\end{align*}
\begin{example}
	If $* \xto{f} X$ is the inclusion of any point, then $\hofib_x(f) = \Omega_x X$.
\end{example}
\begin{definition}
	A \strong{fibre sequence of topological spaces} is a sequence $F \xto{i} Y \xto{f} X$, a basepoint $x \in X$, and a homotopy $h\colon F \to X^I$ from the composite $f \circ i$ to the constant map $c_x\colon F \to X$ such that the induced map
	\begin{equation*}
		F \to \hofib_x(f),\ z \mapsto (h(z), i(z))
	\end{equation*}
	is a weak homotopy equivalence.
\end{definition}
\begin{example}\label{expl:fibresequences}
	\leavevmode
	\begin{enumerate}
		\item Let $f\colon Y \to X$ be any continuous map, $x \in X$ a point.
			Then the pair $(\hofib_x(f) \xto{i} Y \xto{f} X, h)$ where $i(\gamma, y) \coloneq y$ is a fibre sequence since by construction the map $\hofib_x(f) \to \hofib_x(f)$ is just the identity.
	\end{enumerate}
\end{example}
Every fibre sequence is equivalent to such an example in the following sense:
Given $(F \xto{i} Y \xto{f} X)$, there is a commutative diagram
\begin{equation*}
	\begin{tikzcd}
		F
				\ar[r, "\htpyeqv_w"]
				\ar[d]
			& \hofib_x(f)
				\ar[d]
		\\
		Y
				\ar[r, equal, "\id_Y"]
				\ar[d, "f"]
			& Y
				\ar[d, "f"]
		\\
		X 
				\ar[r, equal, "\id_X"]
			& X
	\end{tikzcd}
\end{equation*}
an \enquote{equivalence of fibre sequences}.
In particular, $\Omega X \to * \to X$ is a fibre sequence where $h\colon \Omega X \times I \to X$ is the evaluation map.

\strong{Warning:} If one instead chooses $h$ to be the constant homotopy, one does not obtain a fibre sequence (unless $X$ is weakly contractible) because the induced map $\Omega X \to \hofib_x(f) = \Omega X$ is the constant map which is in general not a weak homotopy equivalence.
Hence, the choice of $h$ is important!

\begin{continueexample}{expl:fibresequences}
	\leavevmode
	\begin{enumerate}[start = 2]
		\item For every two spaces $F$ and $X$ and all basepoints $x \in X$, the pair $(F \to F \times X \xto{\pr_X} X, \const)$ is a fibre sequence called the \strong{trivial fibre sequence}\index{trivial fibre sequence}.
			To see this, note that
			\begin{equation*}
				\hofib_x(\pr_X) = F \times P_x X
			\end{equation*}
			with induced map $F \to F \times P_x X,\ y \mapsto (y, \const_x)$ which is a homotopy equivalence as $P_x X$ is contractible.
		\item\label{expl:fibrebundlefibresequence} Let $p\colon E \to B$ be a fibre bundle with fibre $F = p^{-1}(b)$ for some $b \in B$.
			Then the sequence $F \to E \xto{p} B$ together with the constant homotopy is a fibre sequence.
			This is a special case of the next example:
		\item Recall that $p\colon E \to B$ is a \strong{Serre fibration}\index{fibration!Serre} if in every commutative diagram of the form
			\begin{equation*}
				\begin{tikzcd}
					D^n \times \{0\}
							\ar[r]
							\ar[d, hook]
						& E
							\ar[d, "p"]
					\\
					D^n \times I
							\ar[r]
							\ar[ur, dashed]
						& B
				\end{tikzcd}
			\end{equation*}
			a lift $D^n \times I \to E$ exists making the whole diagram commute.
			Given a Serre fibration $p\colon E \to B$ and a point $b \in B$, the sequence $F = p^{-1}(b) \incl E \to B$ together with the constant homotopy is a fibre sequence (the proof of this is exercise \ref{ex:serrefib}).
		\item\label{expl:hopfbundle} As a special case of \ref{expl:fibrebundlefibresequence}, the \strong{Hopf fibration}\index{Hopf fibration} is a fibre bundle
			\begin{equation*}
				S^1 \to S^3 \xto{\eta} S^2
			\end{equation*}
			It arises by letting $S^1 = \Uni(1)$ act on $S^3 \subseteq \C^2$ via
			\begin{equation*}
				\lambda \cdot (x_1, x_2) = (\lambda x_1, \lambda x_2)
			\end{equation*}
			The quotient space of this action is $\CP^1 = S^2$.
		\item The previous example generalizes to fibre bundles
			\begin{equation*}
				S^1 \to S^{2n + 1} \to \CP^n
			\end{equation*}
			with limit case
			\begin{equation*}
				\begin{tikzcd}
					S^1
							\ar[r]
							\ar[d, "\htpyeqv"]
						& S^\infty
							\ar[r]
							\ar[d, "\htpyeqv"]
						& \CP^\infty
							\ar[d, equal]
					\\
					\Omega \CP^\infty
							\ar[r]
						& * 
							\ar[r]
						& \CP^\infty
				\end{tikzcd}
			\end{equation*}
	\end{enumerate}
\end{continueexample}

\subsection{The Serre Spectral Sequence}\lecture{16.10.23}
We are now ready to state the existence of the Serre spectral sequence:
\begin{theorem}[Serre]\index{Serre spectral sequence}
	For every fibre sequence $(F \to Y \to X, h)$ with $X$ simply connected and abelian group $A$ there exists a first quadrant spectral sequence of the form
	\begin{equation}\label{s3:defn}
		E^2_{p, q} = H_p(X; H_q(F; A)) \Rightarrow H_{p + q}(Y; A)
	\end{equation}
\end{theorem}
The expression in \eqref{s3:defn} does not include information about the differentials and higher pages, nor about the filtration on $H_*(Y; A)$ and the identification of its subquotients with the $E^\infty$-page.

% TODO understand this
One edge case is easy to state:
The map
\begin{equation*}
	H_n(F; A) \isom H_0(Y; H_n(F; A)) = E^2_{0, n} \twoheadrightarrow E^\infty_{0, n} \incl H_n(Y; A)
\end{equation*}
agrees with the factorization
\begin{equation*}
	\begin{tikzcd}
		H_n(F; A) 
				\ar[r, two heads]
			& \img \iota_*
				\ar[r, hook]
			& H_n(Y; A)
	\end{tikzcd}
\end{equation*}
with $\iota\colon F \incl Y$ the fibre inclusion.

Before proving the theorem, let us first look at some examples.
\begin{example}\index{Hopf fibration}
	We revisit the Hopf fibration
	\begin{equation*}
		S^1 \incl S^3 \xto{\eta} S^2
	\end{equation*}
	The $E^2$-page of its associated Serre spectral sequence looks like this:
	\begin{equation*}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_hopfserrespec}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {4ex, between origins},
				row 3/.style = {font = \scriptsize}] {
					1 &[-1.9ex] A & 0 & A \\
					0 & A & 0 & A \\
					& 0 & 1 & 2 \\
			};

			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-1-2.north west) -- ++(0, 1.5) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-2-4.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				% instead of figuring out a difficult path around the page content, we simply shade the whole page, then paint the background behind the page content white
				\draw[spectral sequence/zero region] (m-2-2.south west) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (m-2-2.south west) rectangle (m-1-4.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

			\draw[spectral sequence/differential] (m-2-4) -- (m-1-2); % differential
		\end{tikzpicture}
	\end{equation*}
	There is only one potentially non-zero $d^2$-differential, namely
	\begin{equation*}
		d^2\colon E^2_{2, 0} \to E^2_{0, 1}
	\end{equation*}
	All higher differentials are necessarily trivial for degree reasons.
	Hence, the $E^\infty$-page looks as follows:
	\begin{equation*}
		\tikzsetnextfilename{specseq_hopfserrespec_einfty}
		\pgfsetlayers{background,main}
		\begin{tikzpicture} 
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.5em, between origins},
				row 3/.style = {font = \scriptsize}] {
					1 &[-0.8ex] \coker d^2 & 0 & A \\
					0 & A & 0 & \ker d^2 \\
					& 0 & 1 & 2 \\
			};

			% since (m-1-2.west) (the $coker d^2$-cell) sticks farther out to the left than (m-2-2.south west), we need to do an intersection to get the real "origin" of the system 
			\coordinate (Origin) at (m-1-2.west |- m-2-2.south west);

			\draw[spectral sequence/axis] (Origin) -- (m-1-2.north west) -- ++(0, 1.5) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-2-4.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-1-4.north -| m-2-4.east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^\infty_{p, q}$};
		\end{tikzpicture}
	\end{equation*}
	We know that $H_n(S^3; A) \isom A$ if $n = 0, 3$ and 0 else, so from the $E^\infty$-page we obtain that $H_0(S^3; A) \isom A$, $H_1(S^3; A) \isom \coker d^2$, $H_2(S^3; A) \isom \ker d^2$, and $H_3(S^3; A) \isom A$. 
	Thus, $d^2\colon E^2_{2, 0} \to E^2_{0, 1}$ must be an isomorphism.
\end{example}

\begin{lemma}
	There is a fibre bundle
	\begin{equation*}
		\Uni(n - 1) \xto{i} \Uni(n) \to S^{2n - 1}
	\end{equation*}
	where $\Uni(n)$ denotes the topological group of unitary $(n \times n)$-matrices and $i$ is the standard inclusion which adds a trivial $\C$-summand:
	\begin{equation*}
		i(A) = \begin{pmatrix}
			A & 0 \\
			0 & 1
		\end{pmatrix}
	\end{equation*}
\end{lemma}
\begin{proof}
	The group $\Uni(n)$ acts on $\C^n$ by definition.
	This action restricts to the unit sphere $S^{2n - 1} \subseteq \C^n$.
	Furthermore, this action is transitive because every length 1 vector can be extended to an orthonormal basis.
	Hence, $S^{2n - 1}$ is in bijection with the \enquote{orbit space} $\Uni(n) / \Stab(x)$ for any $x \in S^{2n - 1}$ where $\Stab(x) \coloneq \{A \in \Uni(n) \mid Ax = x\}$ is the \emph{stabilizer} of $x$.
	For $x = (0, \ldots, 0, 1)$, this stabilizer equals $\Uni(n - 1)$.
	We obtain a continuous bijection
	\begin{align*}
		\Uni(n) / \Uni(n - 1) &\to S^{2n - 1} \\
		A \cdot \Uni(n - 1) &\mapsto A \cdot (0, \ldots, 0, 1)
	\end{align*}
	As $\Uni(n) / \Uni(n - 1)$ is quasi-compact and $S^{2n - 1}$ is Hausdorff, this map is a homeomorphism.
	Finally, we use the fact that for a smooth free action of a compact Lie group $G$ on a manifold $M$, the map $M \to M / G$ is always a fibre bundle (in fact a $G$-principal bundle) see \cite[Problem 21-6]{lee_introduction_2012}.
\end{proof}
\begin{example}\label{expl:homology_uni_2}
	We consider the case $n = 2$, i.e. the fibre sequence 
	\begin{equation*}
		S^1 \isom \Uni(1) \to \Uni(2) \to S^3
	\end{equation*}
	Our goal is to compute the homology of $\Uni(2)$ via the Serre spectral sequence, whose $E^2$-page looks as follows:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_uni_1_2_seq}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {3ex, between origins},
				row 3/.style = {font = \scriptsize}
				] {
					1 &[-1ex] \Z 	& 0 & 0 & \Z \\
					0 & \Z 			& 0 & 0 & \Z \\
					& 0 			& 1 & 2 & 3  \\
			};

			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-1-2.north west) -- ++(0, 1.5) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-2-5.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				% instead of figuring out a difficult path around the page content, we simply shade the whole page, then paint the background behind the page content white
				\draw[spectral sequence/zero region] (m-2-2.south west) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (m-2-2.south west) rectangle (m-1-5.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};
		\end{tikzpicture} \\
		$E^2_{p, q} = H_p(S^3; H_q(\Uni(1); \Z))$
	\end{center}
	All differentials on all pages have to be trivial for degree reasons.
	Hence the $E^\infty$-page equals the $E^2$-page.
	Moreover, every antidiagonal has at most one non-trivial term, so we can read off that
	\begin{equation*}
		H_n(\Uni(2); \Z) \isom \begin{cases}
			\Z & n = 0, 1, 3, 4 \\
			0  & \text{else}
		\end{cases}
	\end{equation*}
	In fact, one can show that $\Uni(2)$ is homeomorphic to $S^3 \times \Uni(1)$, so this result could also be derived from the Künneth theorem.
\end{example}
\begin{example}\label{expl:homology_uni_3}
	Next, we consider the fibre sequence 
	\begin{equation*}
		\Uni(2) \to \Uni(3) \to S^5
	\end{equation*}
	which has Serre spectral sequence $E^2$-page of the form
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_uni_2_3_seq}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2ex, between origins},
				row 6/.style = {font = \scriptsize}] {
					4 &[-0.7ex] \Z & & & & & \Z \\
					3 & \Z & & & & & \Z \\
					2 & 0 & & & & & 0 \\
					1 & \Z & & & & & \Z \\
					0 & \Z & & & & & \Z \\
					& 0 & 1 & 2 & 3 & 4 & 5 \\
			};

			\draw[spectral sequence/axis] (m-5-2.south west) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-5-2.south west) -- (m-5-7.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (m-5-2.south west) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (m-5-2.south west) rectangle (m-1-2.north east);
				\fill[white] (m-5-7.south west) rectangle (m-1-7.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

			\draw[spectral sequence/differential] (m-5-7) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$d^5$} (m-1-2);
		\end{tikzpicture} \\
		$E^2_{p, q} = H_p(S^5; H_q(\Uni(2); \Z))$
	\end{center}
	The first potentially non-trivial differential is a $d^5$, the map
	\begin{equation*}
		d^5\colon \underbrace{E^5_{5, 0}}_{\isom \Z} \to \underbrace{E^5_{0, 4}}_{\isom \Z}
	\end{equation*}
	At this point, we cannot decide what this differential is (at least not without resorting to tools like Poincaré duality).
	All higher differentials are again trivial for degree reasons and all filtrations collapse to at most one entry, so we obtain
	\begin{equation*}
		H_n(\Uni(3); \Z) \isom \begin{cases}
			\Z 			& n = 0, 1, 3, 6, 8, 9 \\
			\coker d^5 	& n = 4 \\
			\ker d^5 	& n = 5 \\
			0 			& \text{else}
		\end{cases}
	\end{equation*}
	This example illustrates a typical situation, namely that one can often not fully determine all differentials but still deduce a lot of information.
	We will soon see that $d^5 = 0$ and hence $H_4(\Uni(3); \Z) \isom H_5(\Uni(3); \Z) \isom \Z$.
\end{example}
\begin{example}\label{expl:homology_uni_4}
	We consider 
	\begin{equation*}
		\Uni(3) \to \Uni(4) \to S^7
	\end{equation*}
	and its associated Serre spectral sequence which has $E^2$-page
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_uni_3_4_seq}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2ex, between origins},
				row 11/.style = {font = \scriptsize}] {
					9 &[-0.6ex] \Z & & & & & & & \Z \\
					8 & \Z & & & & & & & \Z \\
					7 & 0 & & & & & & & 0 \\
					6 & \Z & & & & & & & \Z \\
					5 & ? & & & & & & & ? \\
					4 & ? & & & & & & & ? \\
					3 & \Z & & & & & & & \Z \\
					2 & 0 & & & & & & & 0 \\
					1 & \Z & & & & & & & \Z \\
					0 & \Z & & & & & & & \Z \\
					& 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\
			};

			\draw[spectral sequence/axis] (m-10-2.south west) -- (m-1-2.north west) -- ++(0, .8) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-10-2.south west) -- (m-10-9.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (m-10-2.south west) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (m-10-2.south west) rectangle (m-1-2.north east);
				\fill[white] (m-10-9.south west) rectangle (m-1-9.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

			\draw[spectral sequence/differential] (m-10-9) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$d^7$} (m-4-2);
			\draw[spectral sequence/differential] (m-7-9) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$d^7$} (m-1-2);
		\end{tikzpicture} \\
		$E^2_{p, q} = H_p(S^7; H_q(\Uni(3); \Z))$
	\end{center}
	The only possible non-trivial differentials are
	\begin{align*}
		d^7\colon E^7_{7, 0} &\to E^7_{0, 6} \\
		d^7\colon E^7_{7, 5} &\to E^7_{0, 9}
	\end{align*}
	which we cannot compute at this point.
	Nevertheless we can still deduce a lot, for example that
	\begin{equation*}
		H_n(\Uni(4); \Z) \isom \begin{cases}
			\Z 					& n = 0, 1, 3 \\
			H_4(\Uni(3); \Z) 	& n = 4 \\
			H_5(\Uni(3); \Z) 	& n = 5 \\
			0 					& n = 2
		\end{cases}
	\end{equation*}
	and that there is a short exact sequence
	\begin{equation*}
		0 \to \Z \to H_8(\Uni(4); \Z) \to \Z \to 0
	\end{equation*}
	which splits to yield $H_8(\Uni(4); \Z) \isom \Z \dsum \Z$.
\end{example}

In the previous examples we used the Serre spectral sequence to compute the homology of the total space of the fibre sequence.
We now show that it can be used to compute the homology of the basespace or fibre.
\begin{example}\label{expl:homology_cp_n}
	We consider the fibre sequence 
	\begin{equation*}
		S^1 \to S^{2n + 1} \to \CP^n
	\end{equation*}
	for $n \geq 2$.
	Let us pretend that we do not know $H_*(\CP^n)$.
	The only thing we can say about the $E^2$-page of the associated Serre spectral sequence a priori is then that its bottom-left corner looks as follows:
	\begin{center}
		\tikzsetnextfilename{specseq_cpn_initial}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.5ex, between origins},
				row 3/.style = {font = \scriptsize}] {
					1 &[-0.7ex]\Z & ? & ? & \cdots \\
					0 & \Z & ? & ? & \cdots \\
					& 0 & 1 & 2 & \ldots \\
			};

			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-2-5.south east) -- ++(1, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.12, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\draw[spectral sequence/zero region] (m-1-2.north west) rectangle (Slightly Left of p |- Slightly Below q); 

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};
		\end{tikzpicture} \\ 
		$E^2_{p, q} = H_p(\CP^n; H_q(S^1; \Z))$
	\end{center}
	Since $H_1(S^{2n + 1}; \Z) = 0$, there must be a surjective $d^2$-differential $d^2\colon E^2_{2, 0} \to E^2_{0, 1}$.
	As $H_2(S^{2n + 1}; \Z) = 0$, this differential must be injective, so $\Z \isom E^2_{2, 0} = H_2(\CP^n; H_0(S^1; \Z)) = H_2(\CP^n; \Z)$.
	Furthermore, we see that $H_1(\CP^n; \Z) = E^2_{1, 0} = 0$.
	This implies that $E^2_{1, 1} = H_1(\CP^n; H_1(S^1; \Z)) = 0$ and $E^2_{2, 1} = H_2(\CP^n; H_1(S^1; \Z)) \isom \Z$ as $H_1(S^1; \Z) \isom \Z$.
	Since we also have $H_3(S^{2n + 1}; \Z) = 0$, the same argument to deduce that $d^2\colon E^2_{4, 0} = H_4(\CP^n; H_0(S^1; \Z)) \to E^2_{2, 2} \isom \Z$ must be an isomorphism, hence $H_4(\CP^n; \Z) \isom \Z$.
	This can be iterated until we get the following picture:
	\begin{center}
		\tikzsetnextfilename{specseq_cpn_intermediate}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.5em, between origins},
				row 3/.style = {font = \scriptsize}] {
					1 &[-1.8em]\Z 	& 0 	& \Z 	& 0		& \cdots	  	& \textcolor{highlightcol}{\Z} & 0 		& ? 		& \cdots\\
					0 & \Z 			& 0 	& \Z 	& 0		& \cdots	 	& \Z & 0 		& ? 		& \cdots \\
					& 0 			& 1 	& 2 	& 3 	& \cdots 	 	& 2n & 2n + 1 	& 2n + 2 	& \cdots \\
			};

			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-2-10.south east) -- ++(1, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.12, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\draw[spectral sequence/zero region] (m-1-2.north west) rectangle (Slightly Left of p |- Slightly Below q); 

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

			\draw[spectral sequence/differential] (m-2-4) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$\isom$} (m-1-2);
			\draw[spectral sequence/differential] (m-2-6) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$\isom$} (m-1-4);
		\end{tikzpicture}
	\end{center}
	Since $H_{2n + 1}(S^{2n + 1}; \Z) \isom \Z$, we cannot conclude that the $\textcolor{highlightcol}{\Z}$ in bidegree $(2n, 1)$ must be the image of a differential.
	There are then two possibilities:
	\begin{enumerate}
		\item $d^2\colon E^2_{2n + 2, 0} \to E^2_{2n, 1}$ is trivial.
			This implies $E^2_{2n + 2, 0} = 0$ and by induction that $E^2_{p, q} = 0$ for all $p > 2n$; or
		\item $d^2\colon E^2_{2n + 2, 0} \to E^2_{2n, 1} \isom \Z$ is non-zero.
			Since its cokernel is isomorphic to the lowest term of the filtration on $H_{2n + 1}(S^{2n + 1}; \Z) \isom \Z$, this forces $d^2$ to be surjective as no $\Zn{n}$ with $n > 1$ embeds into $\Z$.
			We obtain the following pattern infinite pattern:
			\begin{center}
				\tikzsetnextfilename{specseq_cpn_final_impossible}
				\begin{tikzpicture}
					\matrix[
						spectral sequence/page,
						name = m, 
						column sep = {2.5em, between origins},
						row 3/.style = {font = \scriptsize}] {
							1 &[-1.8em]\Z 	& 0 	& \Z 	& 0		& \cdots	  	& \textcolor{highlightcol}{\Z} & 0 		& \textcolor{highlightcol}{\Z} & 0		& \cdots\\
							0 & \Z 			& 0 	& \Z 	& 0		& \cdots	 	& \Z & 0 		& \textcolor{highlightcol}{\Z} 	& 0 	& \cdots \\
							& 0 			& 1 	& 2 	& 3 	& \cdots 	 	& 2n & 2n + 1 	& 2n + 2 	& 2n + 3 & \cdots \\
					};

					\draw[spectral sequence/axis] (m-2-2.south west) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
					\draw[spectral sequence/axis] (m-2-2.south west) -- (m-2-11.south east) -- ++(1, 0) node[below] (p) {$p$};

					\coordinate (Top Right) at (p |- q);

					\coordinate (Slightly Left of p) at ($(p) - (0.12, 0)$);
					\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

					\draw[spectral sequence/zero region] (m-1-2.north west) rectangle (Slightly Left of p |- Slightly Below q); 

					\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

					\draw[spectral sequence/differential] (m-2-4) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$\isom$} (m-1-2);
					\draw[spectral sequence/differential] (m-2-6) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$\isom$} (m-1-4);
					\draw[spectral sequence/differential, highlightcol] (m-2-9) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$\isom$} (m-1-7);
					\draw[spectral sequence/differential, highlightcol] (m-2-11) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$\isom$} (m-1-9);
				\end{tikzpicture}
			\end{center}
			This can be ruled out using e.g. that $\CP^n$ is $2n$-dimensional CW-complex and therefore $H_k(\CP^n; \Z) = 0$ for $k > 2n$.
	\end{enumerate}
	We thus obtain 
	\begin{equation*}
		H_k(\CP^n; \Z) \isom \begin{cases}
			\Z & k = 2, 4, \ldots, 2n \\
			0  & \text{else}
		\end{cases}
	\end{equation*}
\end{example}

\lecture{20.10.23}
Next, we turn to an exercise of how the Serre spectral sequence can be used to compute the homology of the fibre.
\begin{example}\label{expl:homology_loops_s_3}
	We consider the fibre sequence
	\begin{equation*}
		\Omega S^3 \to * \to S^3
	\end{equation*}
	The $E^2$-page of its associated Serre spectral sequence looks like this:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_loop_s_3_initial}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.5ex, between origins},
				row 5/.style = {font = \scriptsize}] {
					\vdotswithin{1} & \vdotswithin{\Z}  & & & \vdotswithin{\Z} \\
					2 & ?  & & & ? \\
					1 & ?  & & & ? \\
					0 & \Z & & & \Z \\ 
					& 0 & 1 & 2 & 3 \\
			};

			\draw[spectral sequence/axis] (m-4-2.south west) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-4-2.south west) -- (m-4-5.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (m-4-2.south west) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (m-4-2.south west) rectangle (m-1-2.north east);
				\fill[white] (m-4-5.south west) rectangle (m-1-5.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

			\draw[spectral sequence/differential] (m-4-5) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$d^3$} (m-2-2);
		\end{tikzpicture} \\
		$E^2_{p, q} = H_p(S^3; H_q(\Omega S^3; \Z))$
	\end{center}
	The homology groups of the point are trivial in positive degrees, so we must have $E^\infty_{p, q} = 0$ unless $p = q = 0$.
	The only non-trivial differentials are $d^3$'s, so we conclude that $d^3\colon E^3_{3, q} \to E^3_{0, q + 2}$ must be an isomorphism for all $q \in \N$.
	As $E^3_{3, q} \isom H_3(S^3; H_q(\Omega S^3; \Z)) \isom H_q(\Omega S^3; \Z)$ as well as $E^3_{0, q + 2} \isom H_0(S^3; H_{q + 2}(\Omega S^3; \Z)) \isom H_{q + 2}(\Omega S^3; \Z)$ and finally $H_0(\Omega S^3; \Z) \isom \Z$, this implies that $H_k(\Omega S^3; \Z) \isom \Z$ if $k$ is even and 0 else, and the $E^3$-page looks like this:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_loop_s_3_final}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.5ex, between origins},
				row 6/.style = {font = \scriptsize}] {
					\vdotswithin{1} & \vdotswithin{\Z}  & & & \vdotswithin{\Z} \\
					3 & 0  & & & 0 \\
					2 & \Z  & & & \Z \\
					1 & 0  & & & 0 \\
					0 & \Z & & & \Z \\ 
					& 0 & 1 & 2 & 3 \\
			};

			\draw[spectral sequence/axis] (m-5-2.south west) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-5-2.south west) -- (m-5-5.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (m-5-2.south west) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (m-5-2.south west) rectangle (m-1-2.north east);
				\fill[white] (m-5-5.south west) rectangle (m-1-5.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^3_{p, q}$};

			\draw[spectral sequence/differential] (m-5-5) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$\isom$} (m-3-2);
			\draw[spectral sequence/differential] (m-3-5) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$\isom$} (m-1-2);
		\end{tikzpicture}
	\end{center}
	In particular, we see that $\Omega S^3$ is infinite-dimensional.
\end{example}

We now discuss the cohomological version of the Serre spectral sequence and its multiplicative structure.
The multiplication also helps in determining the differentials, for example for the spectral sequences computing (co)homology of unitary groups.
\begin{definition}
	A \strong{cohomologically-graded spectral sequence}\index{spectral sequence!cohomologically graded}	is a triple $(E_\bullet, d_\bullet, h_\bullet)$ where
	\begin{itemize}
		\item $(E_r)_{r \geq 2}$ is a sequence of bigraded abelian groups,
		\item $d_r\colon E_r \to E_r$ is a sequence of differentials (satisfying $d_r^2 = 0$) of bidegree $(r, 1 - r)$, and
		\item $h_r\colon H_*(E_r) \to E_{r + 1}$ is a sequence of bigrading-preserving isomorphisms.
	\end{itemize}
\end{definition}
As before we define what it means for a spectral sequence to be \strong{first quadrant}\index{spectral sequence!first quadrant} (namely $E^{p, q}_2 = 0$ if $p < 0$ or $q < 0$) and the \strong{$E^\infty$-page}\index{$E^\infty$-page}.
For convergence, we consider descending filtrations $H = F_0 \supseteq F_1 \supseteq \cdots$ instead of the ascending filtrations $0 = F^{-1} \subseteq F_0 \subseteq \cdots \subseteq H$ used in the homologically graded case.
\begin{definition}
	A cohomological first quadrant spectral sequence is said to \strong{converge}\index{convergence!of spectral sequences} to a filtered object $(H, F)$ in graded abelian groups if there are isomorphisms $E^{p, q}_\infty \isom F^{p + q}_p / F^{p + q}_{p + 1}$ for all $p, q$ and if $F^n_p = 0$ if $p \geq n$.
	As before, we write $E^{p, q}_2 \Rightarrow H$.
\end{definition}
\begin{definition}
	A (\strong{commutative}) \strong{multiplicative structure}\index{multiplicative structure!on a spectral sequence} on a cohomologically graded spectral sequence $(E_\bullet, d_\bullet, h_\bullet)$ is a bigraded (commutative) ring structure on $E_\bullet$, i.e. associative multiplication maps
	\begin{equation*}
		E_r^{p, q} \tensor E_r^{p', q'} \to E_r^{p + p', q + q'}
	\end{equation*}
	such that $d_r\colon E_r \to E_r$ is a \emph{graded derivation}\index{graded derivation}, that is to say
	\begin{equation*}
		d_r(x \cdot y) = d_r(x) \cdot y + (-1)^{p + q} x \cdot d_r(y)
	\end{equation*}
	for all $x$ in bidegree $(p, q)$ and all $y$.
	Commutativity here is meant in the graded sense: $x \cdot y$ = $(-1)^{(p + q)(p' + q')} y \cdot x$.

	As a result, each $H_*(E_r)$ is a bigraded ring and we accordingly require the maps $h_\bullet\colon H_*(E_\bullet) \xto{\isom} E_{\bullet + 1}$ to be isomorphisms of bigraded rings.
	Furthermore, the $E_\infty$-page also inherits the structure of a (commutative) bigraded ring.
\end{definition}
\begin{definition}\index{multiplicative filtration}
	A filtration $\cdots \subseteq F_n \subseteq \cdots \subseteq F_1 \subseteq F_0 = H$ on a graded ring $H$ is said to be \strong{multiplicative} or \strong{compatible with the multiplicative structure} if $F_s \cdot F_t \subseteq F_{s + t}$.
	We say that $(H, F)$ is a \strong{filtered graded ring}\index{filtered graded ring}.
\end{definition}
It follows that the associated graded group $\bigdsum_p F_p / F_{p + 1}$ of a filtered graded (commutative) ring is a bigraded (commutative) ring.

\begin{definition}
	A multiplicative first quadrant spectral sequence $(E_\bullet, d_\bullet, h_\bullet)$ is said to \strong{converge}\index{convergence!of spectral sequences} to a filtered graded ring $(H, F)$ if it converges additively and the chosen isomorphisms $E_\infty^{p, q} \isom F^{p + q}_p / F^{p + q}_{p + 1}$ are compatible with the graded ring structure.
\end{definition}
\begin{theorem}[Serre]\index{Serre spectral sequence}
	For every fibre sequence of spaces $(F \to Y \to X, h)$ with simply connected base space $X$ and every abelian group $A$ there exists a first quadrant spectral sequence of the form
	\begin{equation*}
		E^{p, q}_2 = H^p(X; H^q(F; A)) \Rightarrow H^{p + q}(Y; A)
	\end{equation*}
	If $A = R$ is a (commutative) ring, then the spectral sequence and its convergence are multiplicative where on the $E_2$-page the multiplication is given by $(-1)^{q \cdot p'}$ times the composite 
	\begin{equation*}
		\begin{tikzcd}
			H^p(X; H^q(F; R)) \tensor_R H^{p'}(X; H^{q'}(F; R))
					\ar[d]
			\\
			H^{p + p'}(X; H^q(F; R) \tensor_R H^{q'}(F; R))
					\ar[d]
			\\
			H^{p + p'}(X; H^{q + q'}(F; R))
		\end{tikzcd}
	\end{equation*}
\end{theorem}
\begin{note}
	If $H^*(F; R)$ or $H^*(X; R)$ is flat (e.g. free) and of finite type over $R$, then the $E_2$-page is isomorphic to the graded tensor product of $H^*(X; R)$ and $H^*(F; R)$.
\end{note}
\begin{example}
	We reconsider the fibre sequence
	\begin{equation*}
		\Uni(1) \to \Uni(2) \to S^3
	\end{equation*}
	from \ref{expl:homology_uni_2}. 
	As for homology, there can be no non-trivial differentials in the associated Serre spectral sequence for degree reasons.
	Let $x_1 \in H^1(\Uni(1); \Z)$ and $x_3 \in H^3(S^3; \Z)$ be generators.
	As a graded ring, the $E_2$-page and thus also the $E_\infty$-page are isomorphic to $H^*(S^3; \Z) \tensor_{\Z} H^*(\Uni(1); \Z)$.
	Then $H^*(\Uni(1); \Z) \isom \Lambda(x_1)$ and $H^*(S^3; \Z) \isom \Lambda(x_3)$ where $\Lambda(M)$ denotes the \emph{exterior algebra}\index{exterior algebra} on a set $M$, i.e. the free algebra on $M$ modulo the relations $x_i x_j = -x_j x_i$ and $x_i^2 = 0$ for all $x_i, x_j \in M$.
	Hence, the $E_2$-page is the exterior algebra $\Lambda(x_1, x_3)$ and the $\Z$ in bidegree $(3, 1)$ is spanned by $x_1 x_3$, so we obtain the following picture:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_uni_1_2_cohom_seq}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2em, between origins},
				row 3/.style = {font = \scriptsize}
				] {
					1 &[-0.8em] \Z x_1 	& 0 & 0 & \Z x_1 x_3 \\
					0 & \Z 			& 0 & 0 & \Z x_3 \\
					& 0 			& 1 & 2 & 3  \\
			};

			\coordinate (Origin) at (m-1-2.west |- m-2-5.south);

			\draw[spectral sequence/axis] (Origin) -- (m-1-2.north west) -- ++(0, 1.5) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-2-5.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-1-5.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};
		\end{tikzpicture} \\
		$E_2^{p, q} = H^p(S^3; H^q(\Uni(1); \Z))$
	\end{center}
	The filtration collapses degree-wise, so $H^*(\Uni(2); \Z)$ is exterior on classes $x_1 \in H^1(\Uni(2); \Z)$ and $x_3 \in H^3(\Uni(2); \Z)$ that are uniquely determined by the spectral sequence.
\end{example}
\begin{example}
	We move on to the fibre sequence 
	\begin{equation*}
		\Uni(2) \to \Uni(3) \to S^5
	\end{equation*}
	from example \ref{expl:homology_uni_3}.
	Again, the $E_2$-page of the associated spectral sequence is given by $H^*(S^5; \Z) \tensor_{\Z} H^*(\Uni(2); \Z) \isom \Lambda(x_1, x_3, x_5)$ where $x_5 \in H^5(S^5; \Z)$ is a generator, and there is only one possibly non-trivial differential $d_5\colon E_5^{0, 4} \to E_5^{5, 0}$, so we obtain the following picture:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_uni_2_3_cohom_seq}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.2em, between origins},
				row 6/.style = {font = \scriptsize}] {
					4 &[-0.7ex] \Z x_1 x_3 & & & & & \Z x_1 x_3 x_5 \\
					3 & \Z x_3 & & & & & \Z x_3 x_5 \\
					2 & 0 & & & & & 0 \\
					1 & \Z x_1 & & & & & \Z x_1 x_5 \\
					0 & \Z & & & & & \Z x_5 \\
					& 0 & 1 & 2 & 3 & 4 & 5 \\
			};

			\coordinate (Origin) at (m-1-2.west |- m-5-7.south);

			\draw[spectral sequence/axis] (Origin) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-5-7.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-1-2.north east);
				\fill[white] (m-1-7.west |- m-5-7.south) rectangle (m-1-7.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};

			\draw[spectral sequence/differential] (m-1-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$d_5$} (m-5-7);
		\end{tikzpicture} \\
		$E_2^{p, q} = H^p(S^5; H^q(\Uni(2); \Z))$
	\end{center}
	However, the product rule now implies that
	\begin{equation*}
		d_5(x_1 x_3) = \underbrace{d_5(x_1)}_{= 0} \cdot x_3 + (-1)^{1 + 0} x_1 \cdot \underbrace{d_5(x_3)}_{= 0} = 0
	\end{equation*}
	Again the filtration collapses, so $H^*(\Uni(3); \Z) \isom \Lambda(x_1, x_3, x_5)$.
\end{example}
\begin{example}
	We revisit the fibre sequence 
	\begin{equation*}
		\Uni(3) \to \Uni(4) \to S^7
	\end{equation*}
	from example \ref{expl:homology_uni_4}.
	The $E_2$-page of the associated Serre spectral sequence looks like this:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_uni_3_4_cohom_seq}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.5em, between origins},
				row 11/.style = {font = \scriptsize}] {
					9 &[-0.6ex] \Z x_1 x_3 x_5 & & & & & & & \Z x_1 x_3 x_5 x_7 \\
					8 & \Z x_3 x_5 & & & & & & & \Z x_3 x_5 x_7 \\
					7 & 0 & & & & & & & 0 \\
					6 & \Z x_1 x_5 & & & & & & & \Z x_1 x_5 x_7 \\
					5 & \Z x_5 & & & & & & & \Z x_5 x_7 \\
					4 & \Z x_1 x_3 & & & & & & & \Z x_1 x_3 x_7 \\
					3 & \Z x_3 & & & & & & & \Z x_3 x_7 \\
					2 & 0 & & & & & & & 0 \\
					1 & \Z x_1 & & & & & & & \Z x_1 x_7\\
					0 & \Z & & & & & & & \Z x_7 \\
					& 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 \\
			};

			\coordinate (Origin) at (m-1-2.west |- m-10-9.south);

			\draw[spectral sequence/axis] (Origin) -- (m-1-2.north west) -- ++(0, 1.2) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-10-9.south east) -- ++(2, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-1-2.north east);
				\fill[white] (m-1-9.west |- m-10-9.south) rectangle (m-1-9.north east);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};

			\draw[spectral sequence/differential] (m-4-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$d_7$} (m-10-9);
			\draw[spectral sequence/differential] (m-1-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$d_7$} (m-7-9);
		\end{tikzpicture} \\
		$E_2^{p, q} = H^p(S^7; H^q(\Uni(3); \Z))$
	\end{center}
	As before, the product rule implies that all $d_7$-differentials must be trivial.
	There is a non-trivial filtration on $H^8(\Uni(4); \Z)$ of the form
	\begin{equation*}
		0 \to \underbrace{E_\infty^{7, 1}}_{\substack{\isom \Z x_1 x_7 \\ \isom \Z}} \to H^8(\Uni(4); \Z) \to \underbrace{E_\infty^{0, 8}}_{\substack{\isom \Z x_3 x_5 \\ \isom \Z}} \to 0
	\end{equation*}
	Additively this sequence splits, but one has to be careful with the multiplicative structure.
	To resolve this, we are precise with the differentiation between the classes $x_1, x_3, x_5, x_7$ on the $E_\infty$-page and the corresponding classes $\bar{x}_1, \bar{x}_3, \bar{x}_5, \bar{x}_7 \in H^*(\Uni(4); \Z)$.
	Note that the choice of each $\bar{x}_i$ is unique since the filtration collapses in degrees 0 to 7.
	Furthermore, we record their filtrations: $\bar{x}_1$ is in $F^1_0$, $\bar{x}_3$ is in $F^3_0$, $\bar{x}_5$ is in $F^5_0$, and $\bar{x}_7$ is in $F^7_7$.
	It follows that $\bar{x}_1 \cdot \bar{x}_7$ is a generator of $F^8_7$ and that $\bar{x}_3 \cdot \bar{x}_5$ maps to a generator of $F^8_0 / F^8_1$.
	Hence $H^8(\Uni(4); \Z)$ is a free group on $\bar{x}_1 \cdot \bar{x}_7$ and $\bar{x}_3 \cdot \bar{x}_5$, and it follows that $H^*(\Uni(4); \Z) \isom \Lambda(\bar{x}_1, \bar{x}_3, \bar{x}_5, \bar{x}_7)$.
\end{example}
\begin{theorem}
	For all $n \in \N$ there is an isomorphism of graded rings
	\begin{equation*}
		H^*(\Uni(n); \Z) \isom \Lambda(x_1, \ldots, x_{2n - 1})
	\end{equation*}
	where each $x_i$ has degree $i$.
\end{theorem}
\lecture{23.10.23}
\begin{proof}
	We will do an induction on $n$.
	The case $n = 1$ is clear.
	Let thus $n \geq 2$ and assume that the statement is true for $n - 1$.
	Consider the Serre spectral sequence for the fibre sequence
	\begin{equation*}
		\Uni(n - 1) \to \Uni(n) \to S^{2n - 1}
	\end{equation*}
	By induction, its $E_2$-page is isomorphic to the tensor product $H^*(S^{2n - 1}; \Z) \tensor H^*(\Uni(n - 1); \Z) \isom \Lambda(x_{2n - 1}) \tensor \Lambda(x_1, x_3, \ldots, x_{2n - 3})$ with $|x_{2n - 1}| = (2n - 1, 0)$ and $|x_i| = (0, i)$ for all $i = 1, 3, \ldots, 2n - 3$.
	For degree reasons, $d_{2n - 1}$ vanishes on all generators $x_1, x_3, \ldots, x_{2n - 3}, x_{2n - 1}$, so by the product rule $d_{2n - 1}$ vanishes on all elements.
	Hence, the $E_\infty$-page is isomorphic to the $E_2$-page and therefore an exterior algebra on $\Lambda(x_1, x_3, \ldots, x_{2n - 1})$.
	The filtrations on $H^*(\Uni(n); \Z)$ collapse in degrees $0, \ldots, 2n - 2$, hence we obtain unique lifts $\bar{x}_1, \ldots, \bar{x}_{2n - 1} \in H^*(\Uni(n); \Z)$.
	We only know that $x_i^2$ is of lower filtration from the spectral sequence and hence a multiple of $\bar{x}_{2n - 1}$, but not necessarily that $\bar{x}_i^2 = 0$.
	However, we know from the additive structure (all the subquotients are free over $\Z$) that $H^*(\Uni(n); \Z)$ is torsion-free as the multiplication is graded-commutative.
	We hence have $\bar{x}_i^2 = 0$.
	Thus, we obtain a ring map
	\begin{equation*}
		f\colon \Lambda(\bar{x}_1, \bar{x}_3, \ldots, \bar{x}_{2n - 1}) \to H^*(\Uni(n); \Z)
	\end{equation*}
	by sending $\bar{x}_i \to \bar{x}_i$.
	We define a grading on $\Lambda(\bar{x}_1, \bar{x}_3, \ldots, \bar{x}_{2n - 1})$ by setting the degree of $\bar{x}_1, \ldots, \bar{x}_{2n - 3}$ to be 0 and the degree of $\bar{x}_{2n - 1}$ to be $2n - 1$.
	This induces a filtration by setting $F_i$ to be the direct sum of the graded pieces of degree $\geq i$. 
	Then $f$ is filtration-preserving and induces an isomorphism on associated graded pieces.
	We now use:
	\begin{lemma}
		Let $A, B$ be graded abelian groups equipped with filtrations
		\begin{gather*}
			\cdots \subseteq F_2 \subseteq F_1 \subseteq F_0 \subseteq A \\
			\cdots \subseteq G_2 \subseteq G_1 \subseteq G_0 \subseteq B
		\end{gather*}
		which are in every degree eventually 0.
		If we have a graded filtration-preserving morphism $f\colon A \to B$ that induces an isomorphism on all associated graded pieces
		\begin{equation*}
			F_i / F_{i + 1} \xto{\isom} G_i / G_{i + 1}
		\end{equation*}
		then it is an isomorphism.
	\end{lemma}
	\begin{smallproof}
		This is an iterated \enquote{5-lemma} argument.
	\end{smallproof}
	This finishes the proof.
\end{proof}
\begin{example}\label{expl:cohomology_cp_n}
	We revisit the fibre sequence
	\begin{equation*}
		S^1 \to S^{2n + 1} \to \CP^n
	\end{equation*}
	from example \ref{expl:homology_cp_n} and use the Serre spectral sequence to compute the ring $H^*(\CP^n; \Z)$.
	Arguing analogously to the homological case, the $E_2$-page looks as follows:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_cpn_cohom_intermediate}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.5em, between origins},
				row 3/.style = {font = \scriptsize}] {
					1 &[-1.8em]\Z 	& 0 	& \Z 	& 0		& \cdots	  	& \Z \\
					0 & \Z 			& 0 	& \Z 	& 0		& \cdots	 	& \Z \\
					& 0 			& 1 	& 2 	& 3 	& \cdots 	 	& 2n \\
			};

			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (m-2-2.south west) -- (m-2-7.south east) -- ++(1, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.12, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (m-2-2.south west) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (m-2-2.south west) rectangle (m-1-7.north east);
			\end{pgfonlayer}

			\draw[spectral sequence/differential] (m-1-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$\isom$} (m-2-4);
			\draw[spectral sequence/differential] (m-1-4) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$\isom$} (m-2-6);

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};
		\end{tikzpicture} \\
		$E_2^{p, q} = H^p(\CP^n; H^q(S^1; \Z))$
	\end{center}
	Let $e$ be a generator for $E_2^{0, 1}$.
	Then $x \coloneq d_2(e)$ is a generator for $E_2^{2, 0}$ and $e x$ is a generator for $E_2^{2, 1}$.
	Hence, $d_2(ex)$ generates $E_2^{4, 0}$.
	By the product rule, we have
	\begin{equation*}
		d_2(ex) = \underbrace{d_2(e)}_{= x} \cdot x + (-1)^1 e \cdot \underbrace{d_2(x)}_{= 0} = x^2
	\end{equation*}
	Hence $x^2$ generates $E_2^{4, 0} \isom H^4(\CP^n; \Z)$.
	Similarly, $d_2(ex^2)$ generates $E_2^{6, 0}$ and
	\begin{equation*}
		d_2(ex^2) = \underbrace{d_2(e)}_{= x} \cdot x^2 - e \cdot \underbrace{d_2(x^2)}_{0} = x^3
	\end{equation*}
	Continuing this process, we arrive at the following picture:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_cpn_cohom_final}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.5em, between origins},
				row 3/.style = {font = \scriptsize}] {
					1 &[-1.6em]\Z e 	& 0 	& \Z e x	& 0		& \cdots	  	& \Z e x^n \\
					0 & \Z 			& 0 	& \Z x 	& 0		& \cdots	 	& \Z x^n \\
					& 0 			& 1 	& 2 	& 3 	& \cdots 	 	& 2n \\
			};

			\coordinate (Origin) at (m-1-2.west |- m-2-2.south);

			\draw[spectral sequence/axis] (Origin) -- (m-1-2.north west) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-2-7.south east) -- ++(1, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.12, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-1-7.north east);
			\end{pgfonlayer}

			\draw[spectral sequence/differential] (m-1-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, sloped] {$e \mapsto x$} (m-2-4);
			\draw[spectral sequence/differential] (m-1-4) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, sloped] {$ex \mapsto x^2$} (m-2-6);

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};
		\end{tikzpicture}
	\end{center}
	and obtain that $H^*(\CP^n; \Z) \isom \Z[x] / (x^{n + 1})$ as well as $H^*(\CP^\infty; \Z) \isom \Z[x]$ in the limit.
\end{example}
\begin{example}
	Next we compute the ring structure on $H^*(\Omega S^3; \Z)$ via the fibre sequence
	\begin{equation*}
		\Omega S^3 \to * \to S^3
	\end{equation*}
	from example \ref{expl:homology_loops_s_3}.
	Dual to before, we obtain the following $E_2$-page:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_loop_s_3_cohom}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {2.8ex, between origins},
				row 6/.style = {font = \scriptsize}] {
					\vdotswithin{1} &[-.7ex] \vdotswithin{\Z}  & & & \vdotswithin{\Z} \\
					3 & 0  & & & 0 \\
					2 & \Z x  & & & \Z e x\\
					1 & 0  & & & 0 \\
					0 & \Z & & & \Z e \\ 
					& 0 & 1 & 2 & 3 \\
			};

			\coordinate (Origin) at (m-3-2.west |- m-5-2.south);

			\draw[spectral sequence/axis] (Origin) -- (Origin |- m-1-2.north) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-5-5.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-1-2.north -| m-3-2.east);
				\fill[white] (m-3-5.west |- m-5-5.south) rectangle (m-3-5.east |- m-1-5.north);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};

			\draw[spectral sequence/differential] (m-3-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$\isom$} (m-5-5);
			\draw[spectral sequence/differential] (m-1-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$\isom$} (m-3-5);
		\end{tikzpicture} \\
		$E_2^{p, q} = H^p(S^3; H^q(\Omega S^3; \Z))$ 
	\end{center}
	Let $x \in H^2(\Omega S^3; \Z) \isom E_3^{0, 2}$ be a generator.
	Then $e \coloneq d_3(x)$ generates $E_3^{3, 0}$ and $ex$ generates $E_3^{3, 2}$.
	We have 
	\begin{equation*}
		d_3(x^2) = d_3(x) \cdot x + (-1)^2 x \cdot d_3(x) = d_3(x) \cdot x + x \cdot d_3(x) = 2ex
	\end{equation*}
	Hence $x^2$ is twice a generator of $H^4(\Omega S^3; \Z)$, which we denote by \enquote{$x^2 / 2$}.
	Similarly, we find that
	\begin{equation*}
		d_3(x^3) = d_3(x) \cdot x^2 + x d_3(x^2) = ex^2 + 2ex^2 = 3ex^2 = 6 \underbrace{e (x^2 / 2)}_{\substack{\text{generator} \\ \text{of } E_3^{3, 4}}}
	\end{equation*}
	Inductively, we get that $x^n$ is $n!$ times a generator of $H^{2n}(\Omega S^3; \Z)$.
	Thus, there is an isomorphism
	\begin{align*}
		H^*(\Omega S^3; \Z) &\isom \Z\bigg[x, \frac{x^2}{2!}, \frac{x^3}{3!}, \ldots\bigg] \subseteq \Q[x] \\
							&\isom \Z\big[x_1, x_2, \ldots\big] \big/ \big\langle {\textstyle\binom{n + m}{n}} x_{m + n} = x_m x_n \big\rangle \\
							&\eqcolon \Gamma(x)
	\end{align*}
	We call $\Gamma(x)$ a \strong{divided power algebra}\index{divided power algebra} on one generator.
	Note that $\Gamma(x)$ is not finitely generated as a ring (and therefore not isomorphic to $\Z[x]$)!
\end{example}
\begin{remark}
	There is also a ring structure on the \emph{homology} $H_*(\Omega S^3; \Z)$ induced by the H-space (in fact $A_\infty$- or $E_1$-space) structure via concatenation of loops.
	One can show that $H_*(\Omega S^3; \Z)$ is actually a polynomial ring on one generator in degree 2.
	More generally, if $H_*(X; \Z)$ is free over $\Z$ then $H_*(\Omega \Sigma X; \Z)$ is the tensor algebra on $H_*(X; \Z)$ (this is the \strong{Bott-Samelson theorem}\index{Bott-Samelson theorem}) and the map
	\begin{equation*}
		H_*(X; \Z) \to H_*(\Omega \Sigma X; \Z) \isom \Tang(H_*(X; \Z))
	\end{equation*} 
	is induced by the map $X \to \Omega \Sigma X$.
\end{remark}
\begin{remark}
	Let us compare $\Omega S^3$ and $\CP^\infty$:
	Both spaces have isomorphic homology groups and a CW-structure with exactly one cell in every even dimension.
	However, they have very different homotopy groups: $\pi_n(\CP^\infty) = 0$ for $n > 2$ whereas $\pi_n(\Omega S^3) \isom \pi_{n + 1}(S^3) \neq 0$ for all $n \geq 2$ (although this is a rather difficult theorem).

	They also have non-isomorphic cohomology rings: $H^*(\CP^\infty; \Z) \isom \Z[x]$ whereas $H^*(\Omega S^3; \Z) \isom \Gamma(x)$ as we just saw.
	Comparing the attaching maps $S^3 \to S^2$ of the 4-cell, we know that for $\CP^\infty$ it is a generator of $\pi_3(S^2)$ while for $\Omega S^3$ it is twice a generator (this follows from the fact that $x^2 \in H^4(\Omega S^3; \Z)$ is twice a generator (via the Hopf invariant)).

	Finally, both are loopspaces (as $\CP^\infty \htpyeqv \Omega K(\Z, 3)$) but $H_*(\Omega S^3; \Z)$ is polynomial while $H_*(\CP^\infty; \Z)$ is a divided power algebra.
\end{remark}
\begin{example}\label{expl:postnikov_section_s_3}
	We consider the map
	\begin{equation*}
		S^3 \to K(\Z, 3)
	\end{equation*}
	classifying a generator of $H^3(S^3; \Z) \isom \Z$ (equivalently, inducing an iso on $\pi_3({{-}})$).
	Let $X$ denote the homotopy fibre of this map so that 
	\begin{equation*}
		X \to S^3 \to K(\Z, 3)
	\end{equation*}
	is a fibre sequence.
	By the long exact sequence in homotopy groups, $X$ is 3-connected and $\pi_n(X) \isom \pi_n(S^3)$ for $n \geq 4$. 

	We want to understand the (co)homology of $X$.
	As we do not know $H_*(K(\Z, 3); \Z)$ yet, we take a second homotopy fibre yielding a fibre sequence
	\begin{equation*}
		\underbrace{\Omega K(\Z, 3)}_{\htpyeqv \CP^\infty} \to X \to S^3
	\end{equation*}
	from which we obtain a Serre spectral sequence with $E_2$-page as follows:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_postnikov_section_s_3_e_2}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {3ex, between origins},
				row 8/.style = {font = \scriptsize}] {
					\vdotswithin{1} &[-.3ex] \vdotswithin{\Z}  & & & \vdotswithin{\Z} \\
					5 & 0  & & & 0 \\
					4 & \Z x^2  & & & \Z \\
					3 & 0  & & & 0 \\
					2 & \Z x  & & & \Z \\
					1 & 0  & & & 0 \\
					0 & \Z & & & \Z \\ 
					& 0 & 1 & 2 & 3 \\
			};

			\coordinate (Origin) at (m-3-2.west |- m-7-2.south);

			\draw[spectral sequence/axis] (Origin) -- (Origin |- m-1-2.north) -- ++(0, 1) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-7-5.south east) -- ++(1.3, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-1-2.north -| m-3-2.east);
				\fill[white] (m-7-5.south west) rectangle (m-3-5.east |- m-1-5.north);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};

			\draw[spectral sequence/differential] (m-5-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$d_3$} (m-7-5);
			\draw[spectral sequence/differential] (m-3-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$d_3$} (m-5-5);
			\draw[spectral sequence/differential] (m-1-2) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white] {$d_3$} (m-3-5);
		\end{tikzpicture} \\
		$E_2^{p, q} = H^p(S^3; H^q(\CP^\infty; \Z)) \isom H^p(S^3; \Z) \tensor H^q(\CP^\infty; \Z)$
	\end{center}
	Since $X$ is 3-connected, $d_3\colon E_3^{0, 2} \to E_3^{3, 0}$ must be an isomorphism.
	Let $x \in E_2^{0, 2}$ be a generator.
	By the product rule,
	\begin{equation*}
		d_3(x^2) = d_3(x) x + x d_3(x) = 2 d_3(x)x
	\end{equation*}
	is twice a generator.
	Inductively, $d_3(x^n)$ is $n$ times a generator of $E_2^{3, 2n - 2}$.
	We therefore obtain the following $E_\infty$-page:
	\begin{center}
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_postnikov_section_s_3_e_infty}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {3.3ex, between origins},
				row 8/.style = {font = \scriptsize}] {
					\vdotswithin{1} &[-1.3ex] & & & \vdotswithin{\Z} \\
					5 &  & & & 0 \\
					4 &  & & & \Zn{3} \\
					3 &  & & & 0 \\
					2 &  & & & \Zn{2} \\
					1 &  & & & 0 \\
					0 & \Z & & & 0 \\ 
					& 0 & 1 & 2 & 3 \\
			};

			\coordinate (Origin) at (m-7-2.south west);

			\draw[spectral sequence/axis] (Origin) -- (Origin |- m-1-2.north) -- ++(0, 1.2) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-7-5.south east) -- ++(1.5, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-7-2.north east);
				\fill[white] (m-7-5.south -| m-3-5.west) rectangle (m-3-5.east |- m-1-5.north);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_\infty^{p, q}$};
		\end{tikzpicture}
	\end{center}
	and hence read off that
	\begin{equation*}
		\tilde{H}^n(X; \Z) \isom \begin{cases}
			\Zn{k}  & n = 2k + 1 \\
			0 		& \text{else}
		\end{cases}
	\end{equation*}
	with trivial cup product.
	By the universal coefficient theorem, we then get
	\begin{equation*}
		\tilde{H}_n(X; \Z) \isom \begin{cases}
			\Zn{k} 	& n = 2k \\
			0 	  	& \text{else}
		\end{cases}
	\end{equation*}
\end{example}
\begin{corollary}
	We have $\pi_4(S^3) \isom \pi_4(S^2) \isom \Zn{2}$.
\end{corollary}
\begin{proof}
	$X$ is 3-connected and $H_4(X; \Z) \isom \Zn{2}$, so the Hurewicz theorem says that $\pi_4(X) \isom \Zn{2}$.
	Furthermore we saw that $\pi_n(X) \isom \pi_n(S^3)$ for $n \geq 4$.
	Finally, by the Hopf fibration $S^1 \to S^3 \to S^2$, we have that $\pi_n(S^3) \isom \pi_n(S^2)$ for $n \geq 3$, hence $\pi_4(S^2) \isom \Zn{2}$ as well.
\end{proof}

\lecture{27.10.23}
\subsection{Construction of the Serre Spectral Sequence}
We focus on the cohomological version.
Roughly speaking, it goes as follows:
We will show how one one obtains filtered complexes from double complexes, exact couples from filtered complexes, and finally spectral sequences from exact couples (all of these terms will be defined in the process; see also figure \ref{fig:doublecpxtospecseq}).
Then we will find double complexes giving rise to the Serre spectral sequence via this construction and prove its properties.
\begin{figure}[ht]
	\begin{equation*}
		\text{double complexes} \Rightarrow \text{filtered complexes} \Rightarrow \text{exact couples} \Rightarrow \text{spectral sequences}
	\end{equation*}
	\caption{Going from double complexes to spectral sequences}
	\label{fig:doublecpxtospecseq}
\end{figure}
\begin{definition}
	An \strong{exact couple}\index{exact couple} is a pair of abelian groups $(A, E)$ together with a triangle
	\begin{equation*}
		\begin{tikzcd}[column sep = small]
			A 
					\ar[rr, "i"]
				& & A
					\ar[dl, "j"]
			\\
				& E
					\ar[ul, "k"]
		\end{tikzcd}
	\end{equation*}
	which is \strong{exact}, i.e. it is exact at all three corners.
\end{definition}

Define $d_1\colon E \to E$ as $d_1 \coloneq j \circ k$.
We then have $d_1 \circ d_1 = jkjk = 0$ as $kj = 0$, so $d_1$ is a differential.
Defining $H(E) \coloneq \ker d_1 / \img d_1$, we claim that there is a new triangle
\begin{equation*}
	\begin{tikzcd}[column sep = small]
		A_2
				\ar[rr, "i_2"]
			& & A_2
				\ar[dl, "j_2"]
		\\
			& E_2
				\ar[ul, "k_2"]
	\end{tikzcd}
\end{equation*}
where $E_2 \coloneq H(E)$ and $A_2 \coloneq \img i \subseteq A$.
As for the morphisms:
\begin{itemize}
	\item $i_2$ is just the restriction $i|_{A_2}$.
	\item $j_2$ is given by $j_2(a) \coloneq [j(b)]$ where $b \in A$ is such that $a = i(b)$.
		This is well-defined since $j(b) \in \ker d_1$ since $kj = 0$, and if $i(b') = a$ is another choice of preimage, then $i(b' - b) = 0$ so $b' - b = k(e)$ for some $e \in E$ by exactness.
		Then $j(b - b') = j(k(e)) = d_1(e)$, so $[j(b)] = [j(b')]$.
	\item $k_2$ is given by $k_2([e]) \coloneq k(e)$.
		This is well-defined since $d_1(e) = j(k(e)) = 0$ implies $k(e) \in \img i$ by exactness and if $e \in \img d_1$ then $e \in \img j$ as $d_1 = jk$, so $k(e) = 0$.
\end{itemize}
\begin{lemma}
	The triangle
	\begin{equation*}
		\begin{tikzcd}[column sep = small]
			A_2
					\ar[rr, "i_2"]
				& & A_2
					\ar[dl, "j_2"]
			\\
				& E_2
					\ar[ul, "k_2"]
		\end{tikzcd}
	\end{equation*}
	is an exact couple.
\end{lemma}
\begin{proof}
	This is a straightforward diagram chase and therefore omitted.
\end{proof}
As a result, we can iterate and obtain a sequence of exact couples $(A_n, E_n)$ with maps $i_n$, $j_n$, and $k_n$.
In particular, we obtain a sequence of abelian groups $(E_n)$ with differentials $d_n = j_n k_n$ and isomorphisms $H(E_n) \isom E_{n + 1}$.
This is like a spectral sequence, except we are missing the bigrading.

For the Serre spectral sequence, the two gradings play different roles:
A filtration (x-axis) and the difference between the cohomological degree and the filtration degree.
\begin{definition}
	An \strong{unrolled exact couple}\index{exact couple!unrolled} is a collection of pairs $(A^s, E^s)_{s \in \Z}$ of abelian groups together with maps
	\begin{equation*}
		\begin{tikzcd}[column sep = small]
			\cdots	
					\ar[rr, "i"]
				& & A^{s + 1}
					\ar[rr, "i"]
					\ar[dl, "j"]
				& & A^s
					\ar[rr, "i"]
					\ar[dl, "j"]
				& & A^{s - 1}
					\ar[rr, "i"]
					\ar[dl, "j"]
				& & \cdots
			\\
				& \cdots
				& & E^s
					\ar[ul, "k"]
				& & E^{s - 1}
					\ar[ul, "k"]
				& & \cdots
					\ar[ul, "k"]
		\end{tikzcd}
	\end{equation*}
	such that each triangle is exact.
	We call $s$ the \strong{filtration degree}\index{filtration degree!of an unrolled exact couple}.
\end{definition}
Every unrolled exact couple gives an exact couple via $A \coloneq \bigdsum_s A^s$ and $E \coloneq \bigdsum_s E^s$ combined in a single triangle.
We obtain a cochain complex
\begin{equation*}
	\begin{tikzcd}
		\cdots
				\ar[r, "jk"]
			& E^{s - 1}
				\ar[r, "jk"]
			& E^s
				\ar[r, "jk"]
			& E^{s + 1}
				\ar[r, "jk"]
			& \cdots
	\end{tikzcd}
\end{equation*}
Thus, $H(E)$ inherits a grading, i.e. $H_*(E) = \bigdsum_s H^s(E)$.
Generally we can write $E_r = \bigdsum_s E_r^s \isom \bigdsum_s H^s(E_{r - 1})$.
Given $e \in E^s$, we can chase its \enquote{life} in the spectral sequence:
If $d_1(e) \neq 0$, then $e$ does not define a class in $H^*(E)$; otherwise $[e] \in H^s(E) = E_2^s$.
In the unrolled picture, $d_2([e]) = j_2 k_2(e)$ is computed as follows:
If $d_2(e) \neq 0$, then $e$ does not define a class in $H^*(E_2)$; otherwise we continue this way.
% TODO diagram

In general, if $k(e) = i^r(b)$ for some $r \geq 0$ and $b \in A^{s + r + 1}$, then $e$ defines a class in $E^s_{r + 1} = H^s(E_r)$ and $d_{r + 1}([e])$ is represented by $j(h)$.
If $e$ \enquote{survives} in every step, it is called a \strong{permanent cycle}\index{permanent cycle}.
We note:
If $e \in E_r^s$, then $d_r([e])$ is represented by some element of $E_r^{s + r}$, i.e. $d_r$ raises the filtration degree by $r$.
\begin{definition}
	A \strong{filtered cochain complex}\index{filtered cochain complex} is a cochain complex $C^*$ together with a sequence of subcomplexes
	\begin{equation*}
		\cdots \subseteq F^2 C^* \subseteq F^1 C^* \subseteq F^0 C^* = C^*
	\end{equation*}
	For convenience, we extend the filtration grading to $\Z$ via $F^s C^* = C^*$ for $s < 0$.
	The \strong{associated graded complex}\index{graded complex!associated to a filtered chain complex} is the collection of subquotients $\gr^s C^* \coloneq F^s C^* / F^{s +1} C^*$.
\end{definition}
The short exact sequence
\begin{equation*}
	\begin{tikzcd}
		0 
				\ar[r]
			& F^{s + 1} C^* 
				\ar[r]
			& F^s C^* 
				\ar[r]
			& \gr^s C^* 
				\ar[r]
			& 0
	\end{tikzcd}
\end{equation*}
induces a long exact sequence
\begin{equation*}
	\begin{tikzcd}[column sep = small]
		\cdots
				\ar[r]
			& H^t(F^{s + 1} C^*)
				\ar[r]
			& H^t(F^s C^*)
				\ar[r]
			& H^t(\gr^s C^*) 
				\ar[r]
			& H^{t + 1}(F^{s + 1} C^*)
				\ar[r]
			& \cdots
	\end{tikzcd}
\end{equation*}
Taking the direct sum over all $t$, we obtain
\begin{equation*}
	\begin{tikzcd}[column sep = -1.4em]
		\cdots 
				\ar[rr, "i"]
			& & H^\bullet(F^{s + 1} C^*) 
				\ar[rr, "i"]
				\ar[dl, "j"]
			& & H^\bullet(F^s C^*)
				\ar[rr, "i"]
				\ar[dl, "j"]
			& & H^\bullet(F^{s - 1} C^*)
				\ar[rr, "i"]
				\ar[dl, "j"]
			& & \cdots
		\\
			& \mathmakebox[\widthof{$\displaystyle H^\bullet(\gr^s C^*)$}]{\cdots}
			& & H^\bullet(\gr^s C^*)
				\ar[ul, "k"]
			& & H^\bullet(\gr^{s + 1} C^*)
				\ar[ul, "k"]
			& & \mathmakebox[\widthof{$\displaystyle H^\bullet(\gr^s C^*)$}]{\cdots}
				\ar[ul, "k"]
	\end{tikzcd}
\end{equation*}
in which each triangle is exact.
We observe that $i$ and $j$ preserve the cohomological degree $t$, but $k$ raises it by 1.
We hence obtain an unrolled exact couple with an additional cohomological degree and exact couple with $A = \bigdsum_{s, t} H^t(F^s C^*)$, $E = \bigdsum_{s, t} H^t(\gr^s C^*)$ and therefore an associated spectral sequence.
What does it converge to?

We define a filtration on $H^\bullet(C^*)$ by setting $F^s H^t(C^*) \coloneq \img(H^t(F^s C^*) \to H^t(C^*))$.
\begin{theorem}\label{thm:couplespecseqconvergence}
	If for every $t$ the cohomology $H^t(F^s C^*)$ becomes trivial for $s \gg 0$, then the spectral sequence associated to this exact couple converges to $(H^\bullet(C^*), F^s H^\bullet(C^*))$ with $E_1$-page $E_1^{s, t} = H^t(\gr^s C^*)$.
\end{theorem}
\begin{remark}
	The grading of this spectral sequence is different from the one for the Serre spectral sequence: $d_r$ raises filtration degree by $r$ and the cohomological degree by 1.
	If $C^*$ is concentrated in non-negative degrees, we get a first quadrant spectral sequence.
	% TODO illustration
	For the Serre spectral sequence, we use cohomological degree minus filtration degree.
	This regrading remains in the first quadrant because all terms with filtration degree greater than the cohomological degree are trivial.
\end{remark}
\begin{proof}[Proof of theorem \ref{thm:couplespecseqconvergence}.]
	In the exact couple, $A_r$ is the direct sum over all $s$ of
	\begin{equation*}
		A_r^s \coloneq \img(i^{r - 1}\colon H^\bullet(F^{s + r - 1} C^*) \to H^\bullet(F^s C^*))
	\end{equation*}
	For $t \in \Z$, we set $n_t \in \N$ to be the minimum over all $n$ such that $H^t(F^n C^*) = 0$.
	Then for $r \geq n_t + 1$, we have:
	\begin{enumerate}
		\item If $s > 0$, then $s + r - 1 > n_t$, so $H^t(F^{s + r - 1} C^*) = 0$ and $A_r^{s, t} = 0$. % TODO check upper index on this last term
		\item If $s \leq 0$, then $H^t(F^s C^*) = H^t(C^*)$ and $A_r^{s, t} = F^{s + r - 1} H^t(C^*)$.
	\end{enumerate}
	Thus, $A_r^t = \bigdsum_{s \leq 0} F^{s + r - 1} H^t(C^*) = \bigdsum_{0 \leq p \leq n_t} F^p H^t(C^*)$.
	This is independent of $r \geq n_t + 1$.
	Let $A_\infty^t$ be this value.
	The map $i_r\colon A_r^t \to A_r^t$ is the direct sum over the inclusions $F^{p + 1} H^t(C^*) \to F^p H^t(C^*)$.
	In particular, $i_r$ is injective, so by exactness $k_r\colon E_r^{t + 1} \to A_r^t$ must be 0.
	Hence all differentials are zero for large $r$ and the terms $E_r^t$ stabilize as well with stable value $E_\infty^t$.
	Moreover, by exactness of
	\begin{equation*}
		\begin{tikzcd}[column sep = small]
			A_\infty
					\ar[rr, "i_r"]
				& & A_\infty
					\ar[dl, "j_r"]
			\\
				& E_\infty
					\ar[ul, "0"]
		\end{tikzcd}
	\end{equation*}
	we have $E_\infty^t \isom \coker(i_r\colon A_r^t \to A_r^t) \isom \bigdsum_{p \leq n_t} F^p H^t(C^*) / F^{p + 1} H^t(C^*)$.
\end{proof}
\begin{example}\label{epl:cwfiltration}
	Let $X$ be a CW-complex with skeleta
	\begin{equation*}
		\sk_0 X \subseteq \sk_1 X \subseteq \cdots \subseteq X
	\end{equation*}
	and $A$ any abelian group.
	We can filter $C^*(X; A)$ by
	\begin{align*}
		F^s C^*(X; A) &= \ker(C^*(X; A) \to C^*(\sk_s X; A)) \\
					  &= C^*(X, \sk_s X; A)
	\end{align*}
	We then obtain a spectral sequence with $E_1$-page
	\begin{align*}
		H^t(C^*(X, \sk_s X; A) / C^*(X, \sk_{s + 1} X)) &\isom H^t(\sk_{s + 1} X, \sk_s X; A) \\
													  &\isom \tilde{H}^t(\underbrace{\sk_{s + 1} X / \sk_s X}_{\isom \bigvee S^{k + 1}}; A)
	\end{align*}
	It converges to $H^\bullet(C^*(X; A)) = H^\bullet(X; A)$.
	In other words, this reproves that the cellular cochain complex computes ordinary cohomology.
	% TODO figure
\end{example}
\begin{figure}[ht]
	\centering
	\tikzsetnextfilename{specseq_diagonalexample}
	\pgfdeclarelayer{background}
	\pgfsetlayers{background, main}
	\begin{tikzpicture}[
		pagemember/.style = {
			fill = white, 
			font = \scriptsize, 
			inner sep = 0.5pt
		},
		differential/.style = {
			commutative diagrams/every arrow, 
			thick, 
			preaction = {
				draw = white, 
				arrows = -, 
				line width = 0.5ex
			}
		}]
		\begin{scope}[local bounding box = E1box]
			\matrix[
				name = m, 
				nodes in empty cells, 
				matrix of math nodes, 
				nodes = {outer sep = 0ex, inner sep = 2pt},
				column sep = {4ex, between origins},
				row sep = {4ex, between origins},
				row sep = 0.5ex,
				column 1/.style = {anchor = base east, font = \scriptsize}, 
				row 5/.style = {font = \scriptsize}] {
					3 &[-2ex] \phantom{\circ} & & & \cdots \\
					2 & & & \circ & \\
					1 & & \circ & & \\
					0 & \circ & & & \\
					& 0 & 1 & 2 & 3 \\
			};

			% bounding box coordinates for the "graph" drawing area
			\coordinate (bottom left) at (m-4-2.south west);
			\coordinate (bottom right) at ($(m-4-5.south east) + (0.3, 0)$);
			\coordinate (top left) at ($(m-1-2.north west) + (0, 0.3)$);
			\coordinate (top right) at (bottom right |- top left);

			\path[spectral sequence/axis, line cap = round] (bottom left) edge (bottom right)
														edge (top left); % axes

			\draw[differential] (m-4-2) -- (m-3-3);
			\draw[differential] (m-3-3) -- (m-2-4);
			\draw[differential] (m-2-4) -- (m-1-5);

			\begin{pgfonlayer}{background}
				\draw[draw = none, pattern = {Lines[angle = 45, distance = 2pt]}] (m-4-2.south west) rectangle ($(top right) - (.125, .125)$); % shaded background
				\begin{scope}
					% here we overlay the "band" in which all non-trivial groups occur with a white rectangle
					% since this has to happen after the matrix is drawn, we need the background layer
					\clip (bottom left) rectangle (top right);
					\coordinate (direction) at ($(m-1-5.center) - (m-4-2.center)$);
					\path[draw = white, line width = 2.5ex] ($(m-4-2.center) - (direction)$) -- ($(m-1-5.center) + (direction)$);
				\end{scope}
			\end{pgfonlayer}

			\node[font = \scriptsize] at (top right) {$E_1$};
		\end{scope}


		\begin{scope}[xshift = 6cm, local bounding box = E2box]
			\matrix[
				name = m, 
				nodes in empty cells, 
				matrix of math nodes, 
				font = \tiny,
				nodes = {outer sep = 0ex, inner sep = 2pt},
				column sep = {4ex, between origins},
				row sep = 0.5ex,
				column 1/.style = {anchor = base east, font = \scriptsize}, 
				row 5/.style = {font = \scriptsize}] {
					3 &[-0.5ex] \phantom{H^0(X; A)} & & & \cdots \\
					2 & & & H^2(X; A) & \\
					1 & & H^1(X; A) & & \\
					0 & H^0(X; A) & & & \\
					& 0 & 1 & 2 & 3 \\
			};

			% bounding box coordinates for the "graph" drawing area
			\coordinate (bottom left) at (m-4-2.south west);
			\coordinate (bottom right) at ($(m-4-5.south east |- bottom left) + (0.3, 0)$);
			\coordinate (top left) at ($(m-1-2.north west) + (0, 0.3)$);
			\coordinate (top right) at (bottom right |- top left);

			\path[spectral sequence/axis, line cap = round] (bottom left) edge (bottom right)
														edge (top left); % axes

			\begin{pgfonlayer}{background}
				\draw[draw = none, pattern = {Lines[angle = 45, distance = 2pt]}] (m-4-2.south west) rectangle ($(top right) - (.125, .125)$); % shaded background
				\begin{scope}
					% here we overlay the "band" in which all non-trivial groups occur with a white rectangle
					% since this has to happen after the matrix is drawn, we need the background layer
					\clip (bottom left) rectangle (top right);
					\coordinate (direction) at ($(m-1-5.center) - (m-4-2.center)$);
					\path[draw = white, line width = 4.1ex] ($(m-4-2.center) - (direction)$) -- ($(m-1-5.center) + (direction)$);
				\end{scope}
			\end{pgfonlayer}

			\node[font = \scriptsize] at (top right) {$E_2 = E_\infty$};
		\end{scope}

		% we use the intersection coordinate to make sure that the arrow is level
		\draw[->, thick] ($(E1box.east) + (.5, 0)$) -- ($(E2box.west |- E1box.east) - (.5, 0)$);
	\end{tikzpicture}
	\caption{$E_1$- and $E_\infty$-pages of the spectral sequence from example \ref{epl:cwfiltration}.}
\end{figure}
\begin{example}
	Let $p\colon Y \to X$ b ea Serre fibration with $X$ a CW-complex.
	Then we can filter $Y$ via the preimages $p^{-1}(\sk_s X)$ and obtain a filtration on $C^*(Y; A)$.
	The resulting spectral sequence is in fact the Serre spectral sequence.
	However, some aspects, in particular the multiplicative structure are more readily proved in the construction via double complexes.
\end{example}
\lecture{30.10.23}
\subsection{Spectral sequences of double complexes}
\begin{definition}
	A \strong{double complex}\index{double complex} is a bigraded abelian group $C^{\bullet, \bullet}$ equipped with two differentials
	\begin{equation*}
		\delta_h\colon C^{\bullet, \bullet} \to C^{\bullet + 1, \bullet} \quad\text{and}\quad \delta_v\colon C^{\bullet, \bullet} \to C^{\bullet, \bullet + 1}
	\end{equation*}
	satisfying $\delta_h^2 = \delta_v^2 = 0$ and $\delta_h \delta_v = \delta_v \delta_h$.
	\begin{equation*}
		\begin{tikzcd}
			C^{p - 1, q + 1}
					\ar[r, "\delta_h"]
				& C^{p, q + 1}
					\ar[r, "\delta_h"]
				& C^{p + 1, q + 1}
			\\
			C^{p - 1, q}
					\ar[r, "\delta_h"]
					\ar[u, "\delta_v"]
				& C^{p, q}
					\ar[r, "\delta_h"]
					\ar[u, "\delta_v"]
				& C^{p + 1, q}
					\ar[u, "\delta_v"]
			\\
			C^{p - 1, q - 1}
					\ar[r, "\delta_h"]
					\ar[u, "\delta_v"]
				& C^{p, q - 1}
					\ar[r, "\delta_h"]
					\ar[u, "\delta_v"]
				& C^{p + 1, q - 1}
					\ar[u, "\delta_v"]
		\end{tikzcd}
	\end{equation*}
	The \enquote{vertical cohomology groups} $H^q_{\delta_v}(C^{p, \bullet})$ inherit a horizontal differential $\delta_h\colon H^q_{\delta_v}(C^{p, \bullet}) \to H^q_{\delta_v}(C^{p + 1, \bullet})$ and vice-versa.
	We write $H_{\delta_h}^p H_{\delta_v}^q(C^{\bullet, \bullet})$ and $H_{\delta_v}^q H_{\delta_h}^p(C^{\bullet, \bullet})$ for the resulting cohomology groups, respectively.
\end{definition}
\begin{example}
	Let $D_1$ and $D_2$ be cochain complexes. 
	Then the tensor products $D_1^p \tensor D_2^q$ form a double complex with $\delta_h$ obtained from the differential of $D_1$ and $\delta_v$ from that of $D_2$.
\end{example}
\begin{definition}
	Let $(C^{\bullet, \bullet}, \delta_h, \delta_v)$ be a double complex.
	Its \strong{total complex}\index{total complex!of a double complex} $\Tot(C)$ is the cochain complex with $\Tot(C)^n \coloneq \bigdsum_{p + q = n} C^{p, q}$ and $\delta \coloneq \delta_h + (-1)^p \delta_v$.
	Note that the sign $(-1)^p$ is needed to guarantee $\delta^2 = 0$.
\end{definition}
A double complex $C^{\bullet, \bullet}$ can be filtered by 
\begin{equation*}
	F^s(C^{p, q}) \coloneq \begin{cases}
		C^{p, q} 	& p \geq s \\
		0 			& \text{else}
	\end{cases}
\end{equation*}
This induces a filtration on $\Tot(C)$ via $F^s \Tot(C) \coloneq \Tot(F^s(C))$.
Then its associated graded pieces are $\gr_s \Tot(C)^t = C^{s, t - s}$ with differential $(-1)^s \delta_v$.
The sign does not affect cohomology, hence
\begin{equation*}
	H^t(\gr_s \Tot(C)) = H^{t - s}_{\delta_v}(C^{s, \bullet})
\end{equation*}
We hence obtain a spectral sequence with $E_1$-page $E_1^{s, t} = H^t(\gr_s \Tot(C)) \isom H_{\delta v}^{t - s}(C^{s, \bullet})$.
Moreover, $d_1$ agrees with the horizontal differential $\delta_h$ (this we leave as an exercise to the reader), so
\begin{equation*}
	E_2^{s, t} \isom H_{\delta_h}^s H_{\delta_v}^{t - s}(C^{\bullet, \bullet})
\end{equation*}
If $C^{p, q} = 0$ whenever $p < 0$ or $q < 0$, then the $E_1$-page is concentrated in degrees $t \geq s \geq 0$ and the spectral sequence converges to $H^*(\Tot(C))$.
It is hence customary to reindex to $(s, t - s)$ and obtain a first quadrant spectral sequence with Serre grading $H_{\delta_h}^s H_{\delta_v}^t(C^{\bullet, \bullet}) \Rightarrow H^{s + t}(\Tot(C))$.
\begin{remark}
	Swapping the horizontal and vertical directions yields a \emph{different} spectral sequence converging to $H^*(\Tot(C))$.
	We will exploit this below.
\end{remark}

\subsection{Dress' construction of the Serre spectral sequence}
Let $f\colon E \to B$ be a Serre fibration.
A \strong{singular $(p, q)$-simplex}\index{singular $(p, q)$-simplex} of $f$ is a commutative diagram
\begin{equation*}
	\begin{tikzcd}
		\Delta^p \times \Delta^q
				\ar[r]
				\ar[d, swap, "\pr_1"]
			& E
				\ar[d, "f"]
		\\
		\Delta^p
				\ar[r]
			& B
	\end{tikzcd}
\end{equation*}
Let $C_{p, q}(f)$ be the free abelian group on all singular $(p, q)$-simplices.
There is a differential $\delta_h\colon C_{p, q}(f) \to C_{p - 1, q}(f)$ given by taking the alternating sum over the faces of the $p$-simplex, where the $i$th face is given by the outer rectangle in
\begin{equation*}
	\begin{tikzcd}
		\Delta^{p - 1} \times \Delta^q
				\ar[r, "d_i \times \id"]
				\ar[d, swap, "\pr_1"]
			& \Delta^p \times \Delta^q
				\ar[r]
				\ar[d, swap, "\pr_1"]
			& E
				\ar[d, "f"]
		\\
		\Delta^{p - 1}
				\ar[r, "d_i"]
			& \Delta^p
				\ar[r]
			& B
	\end{tikzcd}
\end{equation*}
where $d_i\colon \Delta^{p - 1} \incl \Delta^p$ is the $i$th face inclusion.
Similarly, we obtain a vertical differential $\delta_v\colon C_{p, q}(f) \to C_{p, q - 1}(f)$ as the alternating sum of the faces of $q$-simplex where the $i$th face is defined by
\begin{equation*}
	\begin{tikzcd}
		\Delta^p \times \Delta^{q - 1}
				\ar[r, "\id \times d_i"]
				\ar[d, swap, "\pr_1"]
			& \Delta^p \times \Delta^q
				\ar[r]
				\ar[d, swap, "\pr_1"]
			& E
				\ar[d, "f"]
		\\
		\Delta^p
				\ar[r, equal, "\id"]
			& \Delta^p
				\ar[r]
			& B
	\end{tikzcd}
\end{equation*}
By dualizing, we obtain a double complex $C^{\bullet, \bullet}(f; A) \coloneq \Hom(C_{\bullet, \bullet}(f), A)$ for every coefficient group $A$.
We have $C^{p, q}(f; A) = 0$ for $p < 0$ or $q < 0$, so we obtain a Serre-graded first quadrant spectral sequence with $E_2$-page $E_2^{p, q} = H^s_{\delta_h} H^t_{\delta_v}(C^{\bullet, \bullet}(f; A))$ converging to $H^*(\Tot(C^{\bullet, \bullet}(f; A)))$.
This is the Serre spectral sequence.
We have to show that
\begin{enumerate}
	\item $H^*(\Tot(C^{\bullet, \bullet}(f; A))) \isom H^*(E; A)$, and that
	\item the $E_2$-page is isomorphic to $H^*(B; H^*(F; A))$ (if $B$ is simply connected).
\end{enumerate}
We start with the first point.
For this, we swap the horizontal and vertical directions to obtain another spectral sequence with $E_2$-page $E_2^{s, t} = H_{\delta_v}^s H_{\delta_h}^t(C^{\bullet, \bullet}(f; A))$.
% For some reason without this \par we get a spurious new line and a very underfull hbox

\begin{claim}
	$E_2^{s, t} = 0$ if $s \neq 0$ and $H_{\delta_v}^0 H_{\delta_h}^t(C^{\bullet, \bullet}(f; A)) \isom H^t(E; A)$.
\end{claim}
\begin{proof}
	We fix $s \geq 0$ and consider diagrams of the form
	\begin{equation*}
		\begin{tikzcd}
			\Delta^t \times \Delta^s
					\ar[r]
					\ar[d, swap, "\pr_1"]
				& E
					\ar[d, "f"]
			\\
			\Delta^t
					\ar[r]
				& B
		\end{tikzcd}
	\end{equation*}
	We can rewrite this to
	\begin{equation*}
		\begin{tikzcd}
			\Delta^t
					\ar[r]
					\ar[d]
				& \map(\Delta^s, E)
					\ar[d, "{\map(\Delta^s,\, f)}"]
			\\
			B
					\ar[r, "\const"]
				& \map(\Delta^s, B)
		\end{tikzcd}
	\end{equation*}
	This in turn is equivalent to a single map $\Delta^t \to P$ into the pullback $P \coloneq B \times_{\map(\Delta^s, B)} \map(\Delta^s, E)$, i.e. a single $t$-simplex of the space $P$.
	One checks that $C^{s, t}(f; A)$ is in fact isomorphic $C^\bullet(P; A)$.
	Now $\Delta^s$ is contractible, so $B \to \map(\Delta^S, B)$ is a homotopy equivalence.
	Since $f$ is a Serre fibration, it follows that $P \to \map(\Delta^s, E) \htpyeqv E$ is a weak homotopy equivalence.
	In particular, $H_{\delta_h}^t(C^{s, \bullet}(f; A)) \isom H^t(E; A)$ for all $s \geq 0$.
	Under these identifications, every face map of $\Delta^s$ induces the identity on these groups.
	Hence the complex computing $H_{\delta_v}^s H^t(E; A)$ equals
	\begin{equation*}
		\begin{tikzcd}
			H^t(E; A)
					\ar[r, "0"]
				& H^t(E; A)
					\ar[r, "\id"]
				& H^t(E; A)
					\ar[r, "0"]
				& H^t(E; A)
					\ar[r, "\id"]
				& \cdots
		\end{tikzcd}
	\end{equation*}
	Hence $H_{\delta_v}^s H_{\delta_h}^t(C^{\bullet, \bullet}(f; A)) = H^t(E; A)$ if $s = 0$ and 0 else.
	It follows that the $E_\infty$-page equals the $E_2$-page and therefore that $H^t(\Tot(C(f; A))) \isom H^t(E; A)$.
\end{proof}
It remains to compute the $E_2$-term.
For this, it will be useful to consider a generalization of ordinary (co)homology.

\subsubsection{(Co)homology with local coefficients}
\begin{definition}
	The \strong{fundamental groupoid}\index{fundamental groupoid} $\pi_1 X$ of a space $X$ is the category with
	\begin{itemize}
		\item objects the points of $X$, and
		\item as morphisms between $x, y \in X$ the set 
			\begin{equation*}
				\mor_{\pi_1 X}(x, y) \coloneq 
					\begin{Bmatrix}
						\text{endpoint-preserving homotopy} \\ 
						\text{classes of paths } \gamma\colon x \rightsquigarrow y
					\end{Bmatrix}
			\end{equation*}
			(we use the notation $x \rightsquigarrow y$ to denote a path starting in $x$ and ending in $y$).
	\end{itemize}
	Composition is the concatenation of paths.
\end{definition}
As the name suggests, $\pi_1 X$ is a \strong{groupoid}\index{groupoid}, i.e. every morphism is invertible, and by definition $\mor_{\pi_1 X}(x, x) = \Aut_{\pi_1 X}(x) = \pi_1(X, x)$.
\begin{definition}
	A \strong{local system}\index{local system} on $X$ is a functor $M\colon \pi_1 X \to \Ab$.
	We write $M_x$ for the group $M(x)$ for any point $x \in X$.
\end{definition}
Note:
\begin{itemize}
	\item If $X$ is path-connected, then $\pi_1 X$ is equivalent to the groupoid with one object $x \in X$ and automorphism group $\pi_1(X, x)$.
		Hence a local system is equivalent to an abelian group with action by $\pi_1(X, x)$.
	\item If $X$ is simply connected, every local system on $X$ is isomorphic to the constant local system for any abelian group $A$.
\end{itemize}
\begin{example}
	Let $f\colon E \to B$ be a Serre fibration, $A$ an abelian group, and $q \in \N$.
	We write $F_x \coloneq f^{-1}(x)$ for the fibre over $x \in B$.
	There is then a local system $x \mapsto H_q(F_x; A)$.
	On homotopy classes of paths $[\gamma\colon x \rightsquigarrow y]$ this is defined as follows:
	Consider the pullback
	\begin{equation*}
		\begin{tikzcd}
				\textcolor{knowngray}{F_x}
					\ar[r, knowngray]
					\ar[d, knowngray]
					\ar[dr, knowngray, phantom, "\lrcorner" very near start]
				& F_\gamma
					\ar[r]
					\ar[d]
					\ar[dr, phantom, "\lrcorner" very near start]
				& E
					\ar[d, "f"]
			\\
			\textcolor{knowngray}{*} 
					\ar[r, knowngray, "\htpyeqv"]
				& I
					\ar[r, "\gamma"]
				& B
		\end{tikzcd}
	\end{equation*}
	which comes with weak homotopy equivalences $F_x \htpyeqv_w F_\gamma$, $F_y \htpyeqv_w F_\gamma$ (via the \textcolor{knowngray}{gray} square).
	Hence on homology we obtain an induced map
	\begin{equation*}
		H_q(\gamma; A) \colon H_q(F_x; A) \xto{\isom} H_q(F_\gamma; A) \xto{\isom} H_q(F_y; A)
	\end{equation*}
	To show compatibility with composition and homotopy invariance, consider the pullback
	% TODO ???
	\begin{equation*}
		\begin{tikzcd}
			P_{\Delta}
					\ar[r]
					\ar[d]
					\ar[dr, phantom, "\lrcorner" very near start]
				& E
					\ar[d]
			\\
			\Delta^2 
					\ar[r]
				& B
		\end{tikzcd}
	\end{equation*}
	Similarly, we obtain a local system $x \mapsto H^q(F_x; A)$.
\end{example}
\begin{example}
	Let $M$ be a topological manifold of dimension $n$.
	Then the assignment $x \mapsto M_x \coloneq H_n(M, M \setminus \{x\})$ extends to a local system which we denote by $\Z^\text{or}$.
	For a path $\gamma\colon x \rightsquigarrow y$, cover the path by contractible opens $U_i$ and use that $H_n(M, M \setminus \{x\}) \isom H_n(M, M \setminus U)$ iteratively.
	$M$ is orientable iff this local system is isomorphic to the constant one.
\end{example}
Next, we define (co)homology with coefficients in a local system $M$ on $X$.
We set
\begin{equation*}
	C_n(X; M) \coloneq \bigdsum_{\sigma\colon \Delta^n \to X} M_{\sigma_0}
\end{equation*}
where $\sigma_0 \in X$ is the image of the 0th vertex of $\Delta^n$.
There is a differential $d\colon C_n(X; M) \to C_{n - 1}(X; M)$ given by
\begin{equation*}
	d(\sigma, m) = (\sigma \circ d_0, (\sigma_{0, 1})_*(m)) + \sum_{i = 1}^n (-1)^i (\sigma \circ d_i, m)
\end{equation*}
where $d_i\colon \Delta^{n - 1} \incl \Delta^n$ is the $i$th face map and $\sigma_{0, 1}$ is the image under $\sigma$ of any path from the 0th to the 1st vertex in $\Delta^n$.
Note that $(\sigma \circ d_i)_0 = \sigma_0$ unless $i = 0$, in which case $(\sigma \circ d_0)_0 = \sigma_1$, so this formula is well-defined.
The proof that this defines a chain complex is similar to the one for ordinary singular chains and we omit it.
\begin{definition}\index{homology with local coefficients}
	For a local system $M$ we define $H_*(X; M)$ as the homology of this complex.
\end{definition}
Observe the following:
\begin{itemize}
	\item If $M$ is constant, this recovers ordinary homology.
	\item A map $M \to N$ of local systems on $X$ (i.e. a natural transformation) induces a map $H_*(X; M) \to H_*(X; N)$.
	\item A map of spaces $f\colon X' \to X$ induces a map $H_*(X', f^* M) \to H_*(X, M)$ where $f^* M$ is the \strong{pullback}\index{pullback!of a local system} of the local system $M$ under $X$ given pointwise by $(f^* M)_x' \coloneq M_{f(x')}$ and similarly on paths.
\end{itemize}
\lecture{03.11.23}
Moving on to cohomology, we similarly define
\begin{equation*}
	C^n(X; M) \coloneq \prod_{\sigma\colon \Delta^n \to X} M_{\sigma 0}
\end{equation*}
with differential
\begin{equation*}
	d(f(\sigma)) \coloneq M_{(\sigma_{0, 1})^{-1}}(f(d^0 \sigma)) + \sum_{i = 1}^n f(d^i \sigma)
\end{equation*}
\begin{example}
	One can show that using local coefficients there is a version of Poincaré duality\index{Poincaré duality!with local coefficients} without an orientability assumption:
	If $M$ is a compact topological manifold of dimension $n$, there is a fundamental class
	\begin{equation*}
		[M] \in H_n(M; \Z^\text{or})
	\end{equation*}
	such that there are isomorphisms
	\begin{gather*}
		{{-}} \frown [M]\colon H^*(M; \Z) \xto{\isom} H_{n - *}(M; \Z^\text{or}) \\
		{{-}} \frown [M]\colon H^*(M; \Z^\text{or}) \xto{\isom} H_{n - *}(M; \Z)
	\end{gather*}
\end{example}
We now get back to the spectral sequence constructed out of the double complex $C^{\bullet, \bullet}(p; A)$ for a Serre fibration $p\colon E \to B$.
We already know that it is a first quadrant spectral sequence converging to $H^*(E; A)$.
It remains to study the $E_2$-page.
We fix a map $\sigma\colon \Delta^p \to B$ and consider a square
\begin{equation*}
	\begin{tikzcd}
		\Delta^p \times \Delta^q
				\ar[r]
				\ar[d]
			& E
				\ar[d, "f"]
		\\
		\Delta^p
				\ar[r, "\sigma"]
			& B
	\end{tikzcd}
\end{equation*}
This is equivalent to a square
\begin{equation*}
	\begin{tikzcd}
		\Delta^q
				\ar[r]
				\ar[d]
			& \map(\Delta^p, E)
				\ar[d, "{\map(\Delta^p, f)}"]
		\\
		*
				\ar[r, "\sigma"]
			& \map(\Delta^p, B)
	\end{tikzcd}
\end{equation*}
which in turn is equivalent to a map $\Delta^q \to F_\sigma$ where $F_\sigma$ is the fibre of the fibration $\map(\Delta^p, E) \to \map(\Delta^p, B)$ over the point $\sigma$.
Thus the columns of the double complex are isomorphic to a product over all maps $\sigma\colon \Delta^p \to X$ of the singular cochain complex of $F_\sigma$.
Again, $F_\sigma$ is weakly homotopy equivalent to the fibre $F_{\sigma_0}$ of the original fibration $p\colon E \to B$ over the 0th vertex $\sigma_0$ (using that $\Delta^p$ is contractible).
Hence, the vertical cohomologies of the double complex are the product
\begin{equation*}
	\prod_{\sigma\colon \Delta^p \to B} H^q(F_\sigma; A) \isom \prod_{\sigma\colon \Delta^p \to B} H^q(F_{\sigma_0}; A)
\end{equation*}
with this composition, the horizontal differentials work out as follows:
For $i > 0$, the diagram
\begin{equation*}
	\begin{tikzcd}
		H^q(F_{\sigma_0}; A)
		\\
		H^q(F_\sigma; A) 
				\ar[r, "d^i"]
				\ar[u, "\isom"]
			& H^q(F_{\sigma \circ d}; A)
				\ar[ul, swap, "\isom"]
	\end{tikzcd}
\end{equation*}
commutes.
For $i = 0$, we have a commutative square
\begin{equation*}
	\begin{tikzcd}[column sep = large]
		H^q(F_{\sigma_0}; A)
				\ar[r, "H^q(\gamma; A)"]
			& H^q(F_{(\sigma \circ d_0)_0}; A)
		\\
		H^q(F_\sigma; A)
				\ar[r, "d^0"]
				\ar[u, "\isom"]
			& H^q(F_{\sigma \circ d_0}; A)
				\ar[u, "\isom"]
	\end{tikzcd}
\end{equation*}
where $\gamma$ is the image of any path from $\sigma_0$ to $\sigma_1$ in $\Delta^p$ in $X$ essentially by definition of $H^q(\gamma; A)$.
Hence, the vertical cohomologies equipped with the horizontal differentials are isomorphic to the cochain complex $C^*(X; H^q(F_{-}; A))$.
This shows that the $E_2$-page is given by $E_2^{p, q} \isom H^p(B; H^q(F_{-}; A))$ as claimed.

Analogously, the spectral sequence associated to the double complex $C_{\bullet, \bullet}(f; A)$ yields the homological Serre spectral sequence with $E_2$-term the local system homology $H_p(B; H_q(F_{-}; A))$.

It remains to discuss multiplicative properties.
\begin{definition}
	A \strong{multiplicative structure}\index{multiplicative structure!on a double complex} on a double complex $C^{\bullet, \bullet}$ is a collection of maps $\mu\colon C^{p, q} \tensor C^{p', q'} \to C^{p + p', q + q'}$ that are associative and unital (with unit 1 in degree $(0, 0)$).
	Moreover, the differential $\delta = \delta_h + (-1)^p \delta_v$ of $\Tot(C)$ must satisfy the Leibniz rule, i.e.
	\begin{equation*}
		\delta(xy) = \delta(x)y + (-1)^{p + q} x \delta(y)
	\end{equation*}
\end{definition}
Chasing through the construction, we find:
\begin{proposition}
	The spectral sequence associated to a multiplicative double complex is multiplicative.
\end{proposition}
\begin{proof}
	Omitted.
\end{proof}
To apply this, we define a multiplicative structure on $C^{\bullet, \bullet}(p; R)$ where $R$ is a ring and $p\colon E \to B$ a Serre fibration.
Recall that for cochains $\phi \in C^p(X; R)$, $\psi \in C^q(X; R)$, and $\sigma\colon \Delta^{p + q} \to X$ one defines
\begin{equation*}
	(\phi \smile \psi)(\sigma) = \phi(d_{p\text{-front}}^* \sigma) \cdot \psi(d_{q\text{-back}}^* \sigma)
\end{equation*}
where $d_{p\text{-front}}\colon \Delta^p \to \Delta^{p + q}$ and $d_{q\text{-back}}\colon \Delta^q \to \Delta^{p + q}$ are the inclusions into the sub-$p$-simplex on the first $p + 1$ vertices and the sub-$q$-simplex on the last $q + 1$ vertices, respectively.
Similarly, for $\phi \in C^{p, q}(p; R)$, $\psi \in C^{p', q'}(p; R)$ and a singular $(p + p', q + q')$-simplex $\sigma$ represented by
\begin{equation*}
	\begin{tikzcd}
		\Delta^{p + p'} \times \Delta^{q + q'}
				\ar[r, "d"]
				\ar[d, "\pr_1"]
			& E
				\ar[d, "p"]
		\\
		\Delta^{p + p'} 
				\ar[r, "\beta"]
			& B
	\end{tikzcd}
\end{equation*}
we set $(\phi \smile \psi)(\sigma) \coloneq \phi(d_{(p, q)\text{-front}}^* \sigma) \circ \psi(d_{(p', q')\text{-back}}^* \sigma)$ where $d_{(p, q)\text{-front}^*}$ is given via
\begin{equation*}
	\begin{tikzcd}
		\Delta^p \times \Delta^q
				\ar[r, "d_{p\text{-front}} \times d_{q\text{-front}}"]
				\ar[d, "\pr_1"]
			&[4em] \Delta^{p + p'} \times \Delta^{q + q'}
				\ar[r, "d"]
				\ar[d, "\pr_1"]
			& E
				\ar[d, "p"]
		\\
		\Delta^p
				\ar[r, "d_{p\text{-front}}"]
			& \Delta^{p + p'} 
				\ar[r, "\beta"]
			& B
	\end{tikzcd}
\end{equation*}
and similarly for $d_{(p, q)\text{-back}}^*$.
\begin{lemma}
	Both the horizontal and vertical differentials on $C^{\bullet, \bullet}(p; R)$ satisfy the graded Leibniz rule with respect to this cup product and $C^{\bullet, \bullet}(p; R)$ becomes a multiplicative double complex.
\end{lemma}
\begin{proof}
	Analogous to the Leibniz rule for the ordinary cup product.
\end{proof}
Thus, the cohomological Serre spectral sequence becomes multiplicative and one checks that the identification $E_2^{\bullet, \bullet} = H^\bullet(B; H^\bullet(F; R))$ is multiplicative with respect to the multiplication on $H^\bullet(B; H^\bullet(F; R))$ described earlier and that the convergence to $(H^*(E; R), F)$ is multiplicative.

Finally, we record the naturality of the Serre spectral sequence.
\begin{definition}
	A \strong{morphism of cohomologically graded spectral sequences}\index{morphism of spectral sequences}
	\begin{equation*}
		f\colon (E_r, d_r, h_r) \to (E'_r, d'_r, h'_r)
	\end{equation*}
	is a collection of bigrading-preserving maps $f_r\colon E_r \to E'_r$ that commutes with the differentials and satisfies $h'_r \circ f_{r + 1} = H^*(f_r) \circ h_r$.
\end{definition}
Note that $f$ is determined by $f_2$, but it is a condition that the higher $f_r$ commute with the differentials.
We make the analogous definition for homological grading.

Consider now the category $\Fib$ of Serre fibrations $p\colon E \to B$ with morphisms all commutative squares
\begin{equation*}
	\begin{tikzcd}
		E 
				\ar[r, "g^E"]
				\ar[d, "p"]
			& E'
				\ar[d, "p'"]
		\\
		B
				\ar[r, "g^B"]
			& B'
	\end{tikzcd}
\end{equation*}
Then:
\begin{itemize}
	\item $C_{\bullet, \bullet}({{-}}; A)$ becomes a functor from $\Fib$ to double complexes by postcomposition.
		Hence the assignment sending $p\colon E \to B$ to its Serre spectral sequence becomes a functor (similarly for the cohomological version).
	\item The identification $E^2_{p, q} \isom H_p(B; H_q(F_{-}; A))$ is a natural isomorphism of functors $\Fib \to \Ab$.
	\item The maps $H_*(g^E; A)$ and $H^*(g^E; A)$ preserve the filtration and
		\begin{equation*}
			E^\infty_{p, q} \isom F^p(H_{p + q}(E; A)) / F^{p - 1}(H_{p + q}(E; A))
		\end{equation*}
		is natural (similarly for the cohomological version).
\end{itemize}
We give a simple application of naturality.
Let $p\colon E \to B$ be a Serre fibration.
We have surjections
\begin{equation*}
	E_2^{p, 0} \surj E_3^{p, 0} \surj \cdots \surj E_\infty^{p, 0}
\end{equation*}
as well as an inclusion $E_\infty^{p, 0} = F^p(H^p(F_{-}; A)) \incl H^p(E; A)$ and a map $H^p(B; A) \to H^p(B; H^0(F_{-}; A)) = E_2^{p, 0}$ induced by the map of local systems $A \to H^*(F_{-}; A)$ from the projections $F_* \to *$.
% TODO rename the p
The composite $e(p)\colon H^p(B; A) \to H^p(E; A)$ is called the \strong{edge homomorphism}\index{edge homomorphism}.
\begin{lemma}
	The map $e(p)$ agrees with $H^p(p; A)$.
\end{lemma}
\begin{proof}
	By naturality of the Serre spectral sequence, the edge homomorphism is also natural.
	We consider the square of fibrations
	\begin{equation*}
		\begin{tikzcd}
			E
				\ar[r, "p"]
				\ar[d, swap, "p"]
				& B
					\ar[d, equals]
			\\
			B
					\ar[r, equals]
				& B
		\end{tikzcd}
	\end{equation*}
	and obtain a commutative square
	\begin{equation*}
		\begin{tikzcd}
			H^*(B; A)
					\ar[r, equals]
					\ar[d, "e(\id)"]
				& H^*(B; A)
					\ar[d, "e(p)"]
			\\
			H^*(B; A)
					\ar[r, "p^*"]
				& H^*(E; A)
		\end{tikzcd}
	\end{equation*}
	It hence suffices to check that $e(\id) = \id$ which one easily checks directly.
\end{proof}
There is also an edge homomorphism of the form
\begin{align*}
	H^q(E; A) &\surj F_0 H^q(E; A) / F_1 H^q(E; A) \isom E_\infty^{0, q} \\
			  &\incl E_2^{0, q} \isom H^0(B; H^q(F_{-}; A)) \to H^q(F_*; A)
\end{align*}
where the last map is induced by the inclusion $* \incl B$ which one can show similarly to agree with $H^q(F_* \incl E; A)$.
There are also homological versions of the edge homomorphisms.

\lecture{06.11.23}
We now turn to structural application of the Serre spectral sequence.

\subsection{Structure applications}
As a warmup, we reprove the Hurewicz theorem using only the case $\pi_1(X, *)^\ab \to H_1(X; \Z)$ for path connected $X$ as input.
\begin{proposition}[Hurewicz]\index{Hurewicz theorem}\label{thm:hurewicz}
	Let $n > 1$ and $X$ be $(n - 1)$-connected.
	Then $H_k(X; \Z) = 0$ for $0 < k < n$ and the Hurewicz map $\pi_n(X, *) \to H_n(X; \Z)$ is an isomorphism.
\end{proposition}
\begin{proof}
	We proceed by induction on $n$.
	Assume the theorem holds up to $n - 1$.
	The loop space $\Omega X$ is $(n - 2)$-connected and satisfies $\pi_k(X, *) \xto{\isom} \pi_{k - 1}(\Omega X, *)$ for all $k$, so by the induction hypothesis $H_k(\Omega X; \Z) = 0$ for $0 < k < n - 1$ and we have an isomorphism
	\begin{equation*}
		\pi_n(X, *) \isom \pi_{n - 1}(\Omega X, *) \isom H_{n - 1}(\Omega X; \Z)
	\end{equation*}
	Applying the Serre spectral sequence for the fibre sequence $\Omega X \to * \to X$ (see figure \ref{fig:loopshurspecseq}), the $E^\infty$-page must be 0 away from $(0, 0)$, hence we see directly that $H_k(X; \Z) = 0$ for $0 < k < n$.
	\begin{figure}[ht]
		\centering
		\pgfsetlayers{background,main}
		\tikzsetnextfilename{specseq_loops_generic_hurewicz}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {
					4.5em, 
					between origins
				},
				row sep = {
					6ex, 
					between origins
				},
				column 1/.append style = {
					anchor = center
				},
				row 5/.style = {
					font = \scriptsize
				}] {
					\vdotswithin{n - 1} &[-.2ex] \vdotswithin{H_{n - 1}(\Omega X; \Z)} & & \vdotswithin{\adots} & \phantom{0} \\ 
					n - 1 & H_{n - 1}(\Omega X; \Z) & & \adots & \cdots \\
					\vdotswithin{0} & \phantom{0} \\
					0 	& \Z 	& 			& H_n(X; \Z) 	& \cdots \\[-3ex]
						& 0 	& \cdots 	& n 		& \cdots \\
			};

			\coordinate (Origin) at (m-4-4.south -| m-2-2.west);

			\draw[spectral sequence/axis] (Origin) -- (Origin |- m-1-2.north) -- ++(0, .5) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-4-5.east |- Origin.south) -- ++(.8, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
				\fill[white] (Origin) rectangle (m-4-2.north -| m-2-2.east);
				\fill[white] (m-2-2.south west) rectangle (m-2-2.east |- Top Right);
				\fill[white] (m-4-4.south west) rectangle (m-4-4.north -| Top Right);
				\fill[white] (m-2-2.south -| m-4-4.west) rectangle (Top Right);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

			\draw[spectral sequence/differential] (m-4-4) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$d^n$} (m-2-2);
		\end{tikzpicture} \\
		$E^2_{p, q} = H_p(X; H_q(\Omega X; \Z))$
		\caption{$E^2$-page of the Serre spectral sequence associated to $\Omega X \to * \to X$.}
		\label{fig:loopshurspecseq}
	\end{figure}
	Moreover, $d^n\colon H_n(X; \Z) \to H_{n - 1}(\Omega X; \Z)$ must be an isomorphism.

	We therefore obtain an isomorphism
	\begin{equation*}
		\begin{tikzcd}
			\pi_n(X, *)
					\ar[r, "\isom"']
					\ar[rrr, bend right = 12, swap, "\eqcolon c_X"]
				& \pi_{n - 1}(\Omega X, *)
					\ar[r, "\Hur", "\isom"']
				& H_{n - 1}(\Omega X; \Z)
				& H_n(X; \Z)
					\ar[l, swap, "d^n", "\isom"']
		\end{tikzcd}
	\end{equation*}
	where $\Hur\colon \pi_{n - 1}(\Omega X, *) \to H_{n - 1}(\Omega X; \Z)$ is the Hurewicz map.

	Why does this composite $c_X$ agree with the Hurewicz map (up to sign)?
	Note that $c_X$ is natural in $(n - 1)$-connected spaces.
	We can therefore reduce to the universal case $X = S^n$:
	Let $x \in \pi_n(X, *)$ be represented by $f\colon S^n \to X$.
	We obtain a square
	\begin{equation*}
		\tikzsetnextfilename{specseq_commsquare}
		\begin{tikzpicture}[
			% setup some helpers to declutter the matrix head below
			gray column/.style args = {#1}{
				column #1/.append style = {
					knowngray
				},
			},
			column separators/.style args = {#1/#2}{
				column #1/.append style = {
					column sep = #2,
				},
			},
			row separators/.style args = {#1/#2}{
				row #1/.append style = {
					row sep = #2,
				},
			},
			commutative diagrams/.cd, 
			every diagram, 
			sep = large]
			\matrix[
				matrix of math nodes, 
				name = m, 
				commutative diagrams/every matrix,
				commutative diagrams/every cell,
				gray column/.list = {1, 4},
				column separators/.list = {1/0pt, 3/0pt},
				row separators/.list = {1/0pt, 3/0pt}] {
				{[\id]} 	& 				& 			 	& c_{S^n}([\id]) \\
							& \pi_n(S^n, *) & H_n(S^n; \Z) 					 \\
							& \pi_n(X, *) 	& H_n(X; \Z) 					 \\
				{[f] = x} 	& 				& 				& c_X(x) 		 \\
			};
			\draw[commutative diagrams/.cd, every arrow, every label]
				(m-2-2) edge["$c_{S^n}$", "$\isom$"'] (m-2-3)
						edge["$f_*$"'] (m-3-2)
				(m-2-3) edge["$H_n(f)$"] (m-3-3)
				(m-3-2) edge["$c_X$", "$\isom$"'] (m-3-3);
			\draw[commutative diagrams/.cd, every arrow, every label, mapsto, knowngray]
				(m-1-1) edge (m-1-4)
						edge (m-4-1)
				(m-1-4) edge (m-4-4)
				(m-4-1) edge (m-4-4);
		\end{tikzpicture}
	\end{equation*}
	Note that $c_{S^n}$ must send $[\id]$ to one of the two orientation classes for $S^n$, i.e. $c_{S^n} = \pm \Hur_{S^n}$.
	Hence,
	\begin{align*}
		c_X(x) &= H_n(f)(c_{S^n}([\id])) \\
			   &= H_n(f)(\pm \Hur_{S^n}([\id])) \\
			   &= \pm \Hur([f]) \\
			   &= \pm \Hur(x)
	\end{align*}
	and the sign is the same for all $(n - 1)$-connected spaces $X$ and $x \in \pi_n(X, *)$.
\end{proof}

\subsubsection{Serre classes}
\begin{definition}
	Let $\catfont{C} \subseteq \Ab$ be a non-empty full subcategory.
	$\catfont{C}$ is called a \strong{Serre class}\index{Serre class} if it is closed under extensions, subgroups, quotient groups, and isomorphisms, i.e. such that given a short exact sequence 
	\begin{equation*}
		\begin{tikzcd}
			0 
					\ar[r]
				& A
					\ar[r, hook]
				& B
					\ar[r, two heads]
				& C
					\ar[r]
				& 0
		\end{tikzcd}
	\end{equation*}
	of abelian groups, $B \in \catfont{C}$ if and only if $A, C \in \catfont{C}$.
\end{definition}
\begin{example}
	The following full subcategories of $\Ab$ are Serre classes:	
	\begin{enumerate}
		\item $\Cfg$, the class of finitely generated abelian groups.
		\item $\Ctor$, the class of torsion abelian groups (i.e. abelian groups $A$ such that for all $a \in A$ there exists some $n \in \N$ with $n a = 0$).
		\item $\Cptor$, the class of $p$-power torsion abelian groups (i.e. abelian groups $A$ such that for all $a \in A$ there exists $n \in \N$ with $p^n a = 0$).
		\item $\Cfin$, the class of finite abelian groups.
		\item $\Cfinp$, the class of finite $p$-power torsion abelian groups.
	\end{enumerate}
\end{example}
\begin{example}
	The following full subcategories of $\Ab$ are \emph{non-examples} of Serre classes:
	\begin{enumerate}
		\item The category of torsion-free groups (consider $0 \to \Z \xto{\cdot 2} \Z \to \Zn{2} \to 0$).
		\item The category of $p$-torsion groups (consider $0 \to \Zn{p} \xto{\cdot p} \Zn{p^2} \to \Zn{p} \to 0$).
		\item The category of rational / uniquely divisible abelian groups (consider $0 \to \Z \to \Q \to \Q / \Z \to 0$).
	\end{enumerate}
\end{example}
\begin{lemma}\label{lmm:serreclasssequences}
	Let $\catfont{C}$ be a Serre class.
	Then:
	\begin{enumerate}
		\item Given an exact sequence $0 \to A_1 \to A_2 \to \cdots \to A_n \to 0$, if all but one of the $A_i$ are in $\catfont{C}$, then all $A_i$ are in $\catfont{C}$.
		\item If $C_*$ is a chain complex in $\catfont{C}$, then $H_n(C_*) \in \catfont{C}$ for all $n$.
		\item If $0 = A_0 \subseteq A_1 \subseteq \cdots \subseteq A_n = A$ is a finite filtration, then $A \in \catfont{C}$ if and only if $A_i / A_{i - 1} \in \catfont{C}$ for all $i = 1, \ldots, n$.
	\end{enumerate}
\end{lemma}
\begin{proof}
	\leavevmode
	\begin{enumerate}
		\item From $A_{i - 1} \xto{f} A_i \xto{g} A_{i + 1}$ we get a short exact sequence
			\begin{equation*}
				\begin{tikzcd}
					0 
							\ar[r]
						& \img f
							\ar[r, hook]
						& A_i
							\ar[r, two heads]
						& \img g
							\ar[r]
						& 0
				\end{tikzcd}
			\end{equation*}
			and $\img f \in \catfont{C}$ as it is a quotient of $A_{i - 1}$ as well as $\img_g \in \catfont{C}$ as a subgroup of $A_{i + 1} \in \catfont{C}$, so $A_i \in \catfont{C}$.
		\item Similarly, we get
			\begin{equation*}
				\begin{tikzcd}
					0 
							\ar[r]
						& \img d_{n + 1}
							\ar[r, hook]
						& \ker d_n
							\ar[r, two heads]
						& H_n(C_*)
							\ar[r]
						& 0
				\end{tikzcd}
			\end{equation*}
			for $d_{n + 1}\colon C_{n + 1} \to C_n$ the differential, so since $\img d_{n + 1} \in \catfont{C}$ as a quotient of $C_{n + 1}$ and $\ker d_n \subseteq C_n \in \catfont{C}$, we conclude that $H_n(C_*) \in \catfont{C}$ as well.
		\item This claim follows similarly by induction on $n$.
			\qedhere
	\end{enumerate}
\end{proof}

We sometimes require stronger axioms:
\begin{definition}
	A Serre class $\catfont{C}$ satisfies
	\begin{enumerate}
		\item the \strong{tensor axiom}\index{Serre class!tensor axiom} if $A \tensor B \in \catfont{C}$ and $\Tor(A, B) \in \catfont{C}$ whenever $A, B \in \catfont{C}$.
		\item the \strong{group homology axiom}\index{Serre class!group homology axiom} if $H_n(K(A, 1); \Z) \in \catfont{C}$ for all $n \geq 1$ whenever $A \in \catfont{C}$.
	\end{enumerate}
\end{definition}
Recall that $\Tor(A, B)$ computes the kernel of $P_1 \tensor B \surj P_0 \tensor B$ where $0 \to P_1 \to P_2 \to A \to 0$ is a free resolution of $A$ while $A \tensor B$ is the cokernel of this map.
Hence the tensor axiom is automatic if
\begin{itemize}
	\item $\catfont{C}$ is closed under infinite direct sums (this holds for $\Ctor$, for instance), or
	\item $\catfont{C}$ is a subclass of $\Cfg$ since then $P_1$ and $P_0$ can be chosen free of finite rank and every Serre class is closed under finite sums.
\end{itemize}

Furthermore we have:
\begin{lemma}
	Every Serre class $\catfont{C}$ of finitely generated abelian groups satisfies the group homology axiom.
\end{lemma}
\begin{proof}
	We have
	\begin{equation*}
		\tilde{H}_n(K(\Z, 1); \Z) \isom \begin{cases}
			\Z & n = 1 \\
			0  & \text{else}
		\end{cases}
	\end{equation*}
	as $S^1$ is a $K(\Z, 1)$ and
	\begin{equation*}
		\tilde{H}_n(K(\Zn{m}, 1); \Z) \isom \begin{cases}
			\Zn{m} & n \text{ odd} \\
			0 	   & n \text{ even}
		\end{cases}
	\end{equation*}
	This latter statement can for example be seen via lens space models for $K(\Zn{n}, 1)$ which have $S^\infty$ as universal cover with $\Zn{m}$ acting by multiplication with an $m$th root of unity.
	Alternatively, this result can also be obtained via group homology.

	As every finitely generated abelian group is a finite direct sum of $\Zn{m}$'s and $\Z$'s, the claim then follows by induction using the Künneth short exact sequences
	\begin{equation*}
		\begin{tikzcd}[column sep = smallish]
			0
					\ar[r]
				& H_*(K(A, 1)) \tensor H_*(K(B, 1); \Z)
					\ar[r, hook]
				& H_*(K(A \times B, 1); \Z)
					\ar[dl, rounded corners, two heads, to path = {
						-- ([xshift = 1em] \tikztostart.east)
						|- ($(\tikzcdmatrixname-1-2)!0.5!(\tikzcdmatrixname-2-2)$) \tikztonodes
						-| ([xshift = -2ex] \tikztotarget.west)
						--(\tikztotarget)
					}]	
			\\
				& {[-1]\Tor(H_*(K(A, 1); \Z), H_*(K(B, 1); \Z))}
					\ar[r]
				& 0
		\end{tikzcd}
	\end{equation*}
	We have already seen that $\catfont{C}$ satifies the tensor axiom, hence $H_*(K(A \times B, 1); \Z) \in \catfont{C}$.
\end{proof}

Our next goal is to show the following:
\begin{theorem}\label{thm:protohurmodc}
	Let $\catfont{C}$ be a Serre class satisfying the tensor and group homology axioms and $X$ a simple space.
	Then the following statements are equivalent:
	\begin{enumerate}
		\item $H_n(X; \Z) \in \catfont{C}$ for all $n \geq 1$.
		\item $\pi_n(X, *) \in \catfont{C}$ for all $n \geq 1$.
	\end{enumerate}
\end{theorem}
Recall that a space $X$ is \strong{simple}\index{simple space} if it is path-connected and $\pi_1(X, *)$ abelian acting trivially on $\pi_n(X, *)$ for all $n > 1$.
In particular, every H-space is simple.

This theorem immediately has important consequences:
\begin{corollary}\label{crl:htpygrpsofspheresfg}
	$\pi_k(S^n, *)$ is finitely generated for all $k, n$.
\end{corollary}
\begin{corollary}
	More generally, $\pi_k(X, *)$ is finitely generated for every simple finite CW-complex.
\end{corollary}
\begin{remark}
	Theorem \ref{thm:protohurmodc} holds more generally for \strong{nilpotent spaces}\index{nilpotent space}.

	On the other hand, $X = S^1 \vee S^2$ shows that the theorem does not hold for all spaces, since $\pi_2(X, *) \isom H_2(\tilde{X}; \Z) \isom \bigdsum_{\Z} \Z$ where $\tilde{X}$ is the universal covering of $X$.
\end{remark}
\begin{lemma}\label{lmm:twointhreeserreclass}
	Let $\catfont{C}$ be a Serre class satisfying the tensor axiom, $F \to Y \to X$ a fibre sequence of path-connected spaces with $\pi_1(X, *)$ acting trivially on $H_*(F; \Z)$ (so that the local system $H_*(F_{-}; \Z))$ is isomorphic to the trivial one).
	If two out of $F$, $Y$, and $X$ have $H_n({{-}}; \Z) \in \catfont{C}$ for all $n \geq 1$, then so does the third.
\end{lemma}
\begin{proof}
	We abbreviate $H_*({{-}}; \Z)$ to $H_*({{-}})$ and distinguish the following cases:
	\begin{enumerate}
		\item $H_k(F)$, $H_k(X) \in \catfont{C}$ for all $k \geq 1$.
			Then for the associated Serre spectral sequence we have
			\begin{equation*}
				E^2_{p, q} = H_p(X; H_q(F)) \isom H_p(X) \tensor H_q(F) \dsum \Tor(H_{p - 1}(X), H_q(F)) \in \catfont{C}
			\end{equation*}
			for $(p, q) \neq (0, 0)$.
			Note that for $p = 1$ we have $\Tor(H_{p - 1}(X), H_q(F)) = 0$ since $H_0(X)$ is free.
			Hence lemma \ref{lmm:serreclasssequences} implies $E^\infty_{p, q} \in \catfont{C}$ for $(p, q) \neq (0, 0)$ and thus $H_k(Y) \in \catfont{C}$ for $k \geq 1$.
		\item $H_k(F)$, $H_k(Y) \in \catfont{C}$ for all $k \geq 1$.
			By lemma \ref{lmm:serreclasssequences} we have $E^\infty_{p, q} \in \catfont{C}$ for $(p, q) \neq (0, 0)$.
			We now show that $H_n(X) \in \catfont{C}$ by induction over $n$.
			% TODO picture?
			For $n = 1$ we have $H_1(X) \isom E^2_{1, 0} \isom E^\infty_{1, 0} \in \catfont{C}$.
			Let now $n \geq 1$ and assume $H_k(X) \in \catfont{C}$ for $k = 1, \ldots, n - 1$.
			Then $E^r_{p, q} \in \catfont{C}$ for $p < n$, $(p, q) \neq (0, 0)$ and all $r$.
			We have a filtration $H_n(X) \supseteq E^3_{n, 0} \supseteq E^4_{n, 0} \supseteq \cdots \supseteq E^{n + 1}_{n, 0} = E_{n, 0}^\infty$ and short exact sequences
			\begin{equation*}
				\begin{tikzcd}
					0
							\ar[r]
						& E^{i + 1}_{n, 0}
							\ar[r, hook]
						& E^i_{n, 0}
							\ar[r, two heads, "d^i"]
						& \img d^i
							\ar[r]
						& 0
				\end{tikzcd}
			\end{equation*}
			with $\img d^i \subseteq E^i_{n - i, i - 1}$.
			Since $n - i < n$, this group lies in $\catfont{C}$, hence so does $\img d^i$.
			By backwards induction (starting with $E^{n + 1}_{n, 0}$) it follows that $H_n(X) \in \catfont{C}$.
		\item $H_k(X), H_k(Y) \in \catfont{C}$ for all $k \geq 1$.
			This case is similar to the last and therefore left as an exercise to the reader.
			\qedhere
	\end{enumerate}
\end{proof}
\begin{corollary}\label{crl:maclanespaceserreclass}
	Let $\catfont{C}$ be a Serre class satisfying the tensor and group homology axioms.
	Then if $A \in \catfont{C}$, we have $H_k(K(A, n); \Z) \in \catfont{C}$ for all $k > 0, n \geq 1$.
\end{corollary}
\begin{proof}
	By induction on $n$ starting with the group homology axiom for $n = 1$ and using the fibre sequences
	\begin{equation*}
		K(A, n - 1) \htpyeqv \Omega K(A, n) \to * \to K(A, n)
		\qedhere
	\end{equation*}
\end{proof}
\lecture{10.11.23}
We return to our goal of proving theorem \ref{thm:protohurmodc}.
Let $X$ be a space and recall that a \strong{Postnikov tower}\index{Postnikov tower} of $X$ is a commutative diagram
\begin{equation*}
	\begin{tikzcd}
			& \vdotswithin{=}
				\ar[d]
		\\
			& \tau_{\leq 1} X
				\ar[d]
		\\
		X
				\ar[uur]
				\ar[ur]
				\ar[r]
			& \tau_{\leq 0} X
	\end{tikzcd}
\end{equation*}
of spaces such that $\pi_k(\tau_{\leq n} X) = 0$ for $k > n$ and $X \to \tau_{\leq n} X$ induces an isomorphism on $\pi_k$ for $k \leq n$.
The map $X \to \holim_n \tau_{\leq n} X$ is then a weak homotopy equivalence.

For simplicity's sake, we assume $X$ to be path-connected.
Then each $\tau_{\leq n} X$ is also path-connected and there is a fibre sequence
\begin{equation*}
	K(\pi_n(X), n) \to \tau_{\leq n} X \to \tau_{\leq n - 1} X
\end{equation*}
obtained by taking the homotopy fibre and studying the resulting long exact sequence of homotopy groups.
The key point is that if $X$ is simple, the action of $\pi_1(\tau_{\leq n} X) \isom \pi_1(X)$ on $H_*(K(\pi_n X, n))$ is trivial.
This follows from the following two facts:
\begin{enumerate}
	\item The action of $\pi_1(X) \isom \pi_1(\tau_{\leq n - 1} X)$ on $\pi_n(K(\pi_n X, n)) \isom \pi_n(X)$ agrees with the \enquote{usual} one (this is exercise \ref{ex:postnikovaction}).
	\item Any self-map of $K(A, n)$ which induces the identity on $\pi_n(K(A, n))$ is homotopic to the identity.
		In fact, $[K(A, n), K(A, n)] \xto[\isom]{\pi_n} \Hom(A, A)$ is a bijection.
\end{enumerate}
We can now prove theorem \ref{thm:protohurmodc}, or in fact a more general version, after setting up some additional terminology:
\begin{definition}
	Let $\catfont{C}$ be a Serre class.
	We say that a map $f\colon A \to B$ of abelian groups is an \strong{isomorphism modulo $\catfont{C}$}\index{Serre class!isomorphism modulo} if $\ker f, \coker f \in \catfont{C}$.  
	It is a \strong{monomorphism modulo $\catfont{C}$}\index{Serre class!isomorphism modulo} if $\ker f \in \catfont{C}$ and an \strong{epimorphism modulo $\catfont{C}$}\index{Serre class!epimorphism modulo} if $\coker f \in \catfont{C}$.
\end{definition}
\begin{example}
	$f\colon A \to B$ is an isomorphism modulo $\Ctor$ if and only if $f \tensor \Q$ is an isomorphism.
	The map $\Z \xto{\cdot 2} \Z$ is an isomorphism modulo $\Cfinp[2]$.
\end{example}
\begin{theorem}[Hurewicz modulo $\catfont{C}$]\index{Hurewicz theorem!modulo $\catfont{C}$}
	Let $\catfont{C}$ be a Serre class satisfying the tensor and group homology axioms.
	For $n > 0$ and a simple space $X$ the following are equivalent:
	\begin{itemize}
		\item $H_k(X) \in \catfont{C}$ for all $0 < k < n$.
		\item $\pi_k(X) \in \catfont{C}$ for all $0 < k < n$.
	\end{itemize}
	In this case, the Hurewicz map 
	\begin{equation*}
		\pi_n(X) \to H_n(X)
	\end{equation*}
	is an isomorphism modulo $\catfont{C}$.
\end{theorem}
\begin{proof}
	We first assume $\pi_k(X) \in \catfont{C}$ for $0 < k < n$.
	Consider the Postnikov tower of $X \isom \holim_n \tau_{\leq n} X$.
	Since $H_k(X) \isom H_k(\tau_{\leq k} X)$\footnote{(from me) This holds since we can construct a model of $\tau_{\leq k} X$ from (a CW-approximation of) $X$ by attaching cells of dimension $\geq k + 2$ to kill off higher homotopy groups so that the map $X \to \tau_{\leq k} X$ induces an isomorphism on (cellular) homology in degrees $\leq k$.} it suffices to show that $H_m(\tau_{\leq k} X) \in \catfont{C}$ for all $k < n$ and all $m > 0$.
	This follows by induction from the fibre sequences
	\begin{equation*}
		K(\pi_k(X), k) \to \tau_{\leq k} X \to \tau_{\leq k - 1} X
	\end{equation*}
	via lemma \ref{lmm:twointhreeserreclass} and corollary \ref{crl:maclanespaceserreclass}.

	Next we show by induction on $n$ that if $H_k(X) \in \catfont{C}$ for all $0 < k < n$, then $\pi_n(X) \to H_n(X)$ is an isomorphism modulo $\catfont{C}$, which proves the general statement by applying it inductively for smaller $n$:
	The Hurewicz map $\pi_n(X) \to H_n(X)$ is equivalent to the map $\pi_n(X) \isom \pi_n(K(\pi_n(X), n)) \xto{\isom} H_n K(\pi_n(X), n) \xto{\isom} H_n(\tau_{\leq n} X) \isom H_n(X)$; the induction hypothesis implies that $\pi_k(X) \in \catfont{C}$ for $k < n$ and by the first part of the proof we know that $H_k(\tau_{\leq n - 1} X) \in \catfont{C}$ for all $k > 0$.
	We now analyze the Serre spectral sequence for the fibre sequence
	\begin{equation*}
		K(\pi_n(X), n) \to \tau_{\leq n} X \to \tau_{\leq n - 1} X
	\end{equation*}
	The first interesting differential from the 0th row is $d^{n + 1}\colon H_{n + 1}(\tau_{\leq n - 1} X) \to H_n(K(\pi_n(X), n))$ with cokernel $E^\infty_{0, n}$ which sits in a short exact sequence
	\begin{equation*}
		\begin{tikzcd}
			0
					\ar[r]
				& E^\infty_{0, n}
					\ar[r, hook]
				& H_n(\tau_{\leq n} X)
					\ar[r, two heads]
				& H_n(\tau_{\leq n - 1} X)
					\ar[r]
				& 0
		\end{tikzcd}
	\end{equation*}
	from the filtration.
	Put together, we obtain an exact sequence
	\begin{equation*}
		\begin{tikzcd}[column sep = small]
			H_{n + 1}(\tau_{\leq n - 1} X)
					\ar[r, "d^{n + 1}"]
				&[1.1em] H_n(K(\pi_n(X), n))
					\ar[r]
				& H_n(\tau_{\leq n})
					\ar[r]
				& H_n(\tau_{\leq n - 1} X) 
					\ar[r]
				& 0
		\end{tikzcd}
	\end{equation*}
	As the first and last term are in $\catfont{C}$, this finishes the proof.
\end{proof}
\begin{figure}[ht]
	\centering
	\tikzsetnextfilename{specseq_hur_mod_c_prf}
	\begin{tikzpicture}
		\matrix[
			spectral sequence/page,
			name = m, 
			column sep = {
				4.5em, 
				between origins
			},
			row sep = {
				5.2ex, 
				between origins
			},
			column 1/.append style = {
				anchor = center
			},
			row 5/.style = {
				font = \scriptsize
			}] {
				\vdotswithin{n} &[.2ex] \vdotswithin{H_n(K(\pi_n(X), n))} & \phantom{0} \\
				n & H_n(K(\pi_n(X), n)) & \cdots \\
				\vdotswithin{0} & \phantom{0} \\
				0 & \Z & \cdots & H_{n + 1}(\tau_{\leq n - 1} X) & \cdots \\[-2.5ex]
				& 0  & \cdots & n + 1 & \cdots \\
		};

		\coordinate (Origin) at (m-4-4.south -| m-2-2.west);

		\draw[spectral sequence/axis] (Origin) -- (Origin |- m-1-2.north) -- ++(0, .5) node[left] (q) {$q$};
		\draw[spectral sequence/axis] (Origin) -- (m-4-5.east |- Origin.south) -- ++(.8, 0) node[below] (p) {$p$};

		\coordinate (Top Right) at (p |- q);

		\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
		\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

		\draw[spectral sequence/zero region] (m-4-2.north -| m-2-2.west) rectangle (m-2-2.south -| Slightly Left of p); 

		\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

		\draw[spectral sequence/differential] (m-4-4) -- node[commutative diagrams/every label, inner sep = 1pt, fill = white, swap] {$d^{n + 1}$} (m-2-2);
	\end{tikzpicture} \\
	$E^2_{p, q} = H_p(\tau_{\leq n - 1} X; H_q(K(\pi_n(X), n)))$
	\caption{$E^2$-page of the Serre spectral sequence for the fibre sequence $K(\pi_n(X), n) \to \tau_{\leq n} X \to \tau_{\leq n - 1} X$.}
\end{figure}
\begin{corollary}
	Let $p$ be a prime.
	Then the first $p$-power torsion in $\pi_*(S^3)$ is a copy of $\Zn{p}$ in degree $2p$.
\end{corollary}
\begin{proof}
	Recall that we computed the homology of the homotopy fibre of $S^3 \to K(\Z, 3) = \tau_{\leq 3} S^3$ as
	\begin{equation*}
		H_k(F) \isom \begin{cases}
			\Z / n 	& k = 2n \\
			0 		& k \text{ odd}
		\end{cases}
	\end{equation*}
	Application of the modulo $\catfont{C}$ Hurewicz theorem for the Serre class of finite abelian groups with order coprime to $p$ shows that $\pi_k(F)$ is finite with no $p$-torsion for $k < 2p$ and that the kernel and cokernel of $\pi_{2p}(F) \to H_{2p}(F) \isom \Zn{p}$ have order coprime to $p$.
	It follows that the $p$-power torsion of $\pi_{2p}(F) \isom \pi_{2p}(S^3)$ is a copy of $\Zn{p}$.
\end{proof}

Next, we want to prove the Whitehead theorem modulo $\catfont{C}$ which requires a further condition:
\begin{definition}
	A good Serre class $\catfont{C}$ is called a \strong{Serre ideal}\index{Serre ideal} if for every $A \in \catfont{C}$ and any abelian group $B$, the tensor product $A \tensor B$ lies in $\catfont{C}$.
\end{definition}
\begin{lemma}
	A Serre class $\catfont{C}$ is a Serre ideal if and only if $\bigdsum_I A \in \catfont{C}$ whenever $A \in \catfont{C}$ for all sets $I$.
\end{lemma}
\begin{proof}
	We have $\bigdsum_I A = \big(\bigdsum_I \Z\big) \tensor A$.
	For the other direction, use that any abelian group is a quotient of a free group and ${{-}} \tensor {{-}}$ is right exact.
\end{proof}
\begin{example}
	$\Cptor$, $\Ctor$ are Serre ideals, but $\Cfg$ is not.
\end{example}
\begin{theorem}[Whitehead modulo $\catfont{C}$]\index{Whitehead's theorem!modulo $\catfont{C}$}
	Let $\catfont{C}$ be a Serre ideal, $f\colon X \to Y$ a map of 1-connected spaces and $n > 0$.
	The following statements are equivalent:
	\begin{enumerate}
		\item $\pi_k(f)\colon \pi_k(X) \to \pi_k(Y)$ is an isomorphism modulo $\catfont{C}$ for $0 < k < n$ and an epimorphism modulo $\catfont{C}$ for $k = n$.
		\item $H_k(f)\colon H_k(X) \to H_k(Y)$ is an isomorphism modulo $\catfont{C}$ for $0 < k < n$ and an epimorphism modulo $\catfont{C}$ for $k = n$.
	\end{enumerate}
\end{theorem}
\begin{proof}
	We consider the fibre sequence $F \coloneq \hofib(f) \to X \xto{f} Y$.
	By the long exact sequence on homotopy groups reduced modulo $\catfont{C}$, the first condition is equivalent to saying that $F$ is $(n - 1)$-connected modulo $\catfont{C}$, i. e. that $\pi_k(F) \in \catfont{C}$ for $0 < k \leq n - 1$.
	By the Hurewicz theorem modulo $\catfont{C}$, this is equivalent to saying that $H_k(F) \in \catfont{C}$ for $0 < k < n$.
	We claim that $H_p(Y; H_q(F)) \in \catfont{C}$ for $0 < q \leq n - 1$, or in fact that $H_p(Y; A)$ for any $A \in \catfont{C}$.
	This follows from the ideal property of $\catfont{C}$ which implies that $C_m(Y; A) \in \catfont{C}$ for all $m$ and hence so is its homology.
	Thus, the region $0 < q \leq n - 1$ of the Serre spectral sequence $E^2$-page lies in $\catfont{C}$ and likewise for the $E^\infty$-page.
	\begin{figure}[ht]
		\centering	
		\tikzsetnextfilename{specseq_whitehead_mod_c_prf}
		\begin{tikzpicture}
			\matrix[
				spectral sequence/page,
				name = m, 
				column sep = {
					1.7em, 
					between origins
				},
				row sep = {
					8ex, 
					between origins
				},
				column 1/.append style = {
					anchor = center
				},
				row 4/.style = {
					font = \scriptsize
				}] {
					n - 1 & \phantom{\Z} \\
					\vdotswithin{n - 1} \\
					0 & \Z \\[-5.8ex]
					& 0 & \cdots \\
			};

			\coordinate (Origin) at (m-3-2.south west);

			\draw[spectral sequence/axis] (Origin) -- ++(0, 4) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- ++(6, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\coordinate (Alignment Helper) at (m-1-2.west |- m-1-1.center);

			\draw[draw = none, pattern = {Dots[distance = 2pt, radius = .4pt]}] (m-3-2.north west) rectangle (Alignment Helper -| Slightly Left of p); 

			\node[draw = none, fill = white, inner sep = 1pt] at ($(Top Right)!.5!(Origin)$) {$\in \mathcal{C}$};
			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};
		\end{tikzpicture} \\
		$E^2_{p, q} = H_p(Y; H_q(F))$
		\caption{$E^2$-page of the Serre spectral sequence for the fibre sequence $F \to X \to Y$.}
	\end{figure}
	Hence, $H_k(X)$ admits a filtration $0 \subseteq F_0 \subseteq F_1 \subseteq \cdots \subseteq F_k = H_k(X)$ with $F_i / F_{i - 1} \in \catfont{C}$ whenever $i \geq k - n + 1$ and $i < k$.
	Moreover, the last quotient $F_k / F_{k - 1}$ is isomorphic to $H_k(Y) \isom E^2_{k, 0}$ modulo $\catfont{C}$ for $k \leq n$.
	This implies the result for $0 < k < n$ via the edge homomorphism (all terms on the $k$th antidiagonal except for $(k, 0)$ lie in $\catfont{C}$).
	It also implies surjectivity modulo $\catfont{C}$ for $k = n$ (it might not be injective modulo $\catfont{C}$ as $E^\infty_{0, n}$ might not be in $\catfont{C}$).

	For the converse we assume that $H_k(X) \to H_k(Y)$ is an isomorphism modulo $\catfont{C}$ for $0 < k < n$ and an epimorphism modulo $\catfont{C}$ for $k = n$.
	We want to show that $\pi_k(F) \in \catfont{C}$ for $k < n$.
	If this was not the case, there would be a minimal $0 < k < n$ for which $\pi_k(F) \notin \catfont{C}$.
	Inspecting the Serre spectral sequence as before, we find that
	\begin{equation*}
		H_k(F) \isom E^2_{0, k} \surj E^3_{0, k} \surj \ldots \surj E^{k + 1}_{0, k}
	\end{equation*}
	are all isomorphisms modulo $\catfont{C}$ as well as that
	\begin{equation*}
		E^{k + 1}_{k + 1, 0} \incl E^k_{k + 1, 0} \incl \ldots \incl E^2_{k + 1, 0} \isom H_{k + 1}(Y)
	\end{equation*}
	are all isomorphisms modulo $\catfont{C}$.
	By the modulo $\catfont{C}$ Hurewicz theorem, $H_k(F) \notin \catfont{C}$ and hence $E^{k + 1}_{0, k} \notin \catfont{C}$.
	By assumption, $H_{k + 1}(X) \to H_{k + 1}(Y)$ is an epimorphism modulo $\catfont{C}$, which by the description of the edge homomorphism implies that $E^{k + 1}_{k + 1, 0} \to E^{k + n}_{k + 1, 0} = E^\infty_{k + 1, 0}$ must also be an epimorphism modulo $\catfont{C}$, i.e. that its cokernel lies in $\catfont{C}$.
	This in turn implies that $E^{k + 1}_{0, k} \surj E^{k + 2}_{0, k} \isom E^\infty_{0, k}$ is an isomorphism modulo $\catfont{C}$ and hence $E^\infty_{0, k} \notin \catfont{C}$.
	Since $E^\infty_{0, k} \isom F_0 \subseteq H_k(X)$ lies in the kernel of the edge homomorphism $H_k(X) \to H_k(Y)$, contradicting that $H_k(X) \to H_k(Y)$ is an isomorphism modulo $\catfont{C}$.
\end{proof}
\lecture{13.11.23}
Note that the modulo $\catfont{C}$ Whitehead theorem fails in general for Serre classes $\catfont{C}$ that are not Serre ideals:
\begin{example}
	Consider $\CP^\infty \times X \xto{\pr_X} X$ where $X$ is 1-connected and $H_2(X)$ is not finitely generated (e.g. $X = \bigvee_{\N} S^2$).
	Then $\pi_k(\CP^\infty \times X) \isom \pi_k(\CP^\infty) \times \pi_k(X) \xto{(\pr_X)_*} \pi_k(X)$ is an isomorphism modulo $\Cfg$ for all $k \geq 1$, but
	\begin{equation*}
		H_4(\CP^\infty \times X) \isom \Z \dsum H_2(X) \dsum H_4(X) \xto{(\pr_X)_*} H_4(X)
	\end{equation*}
	is not an isomorphism modulo $\Cfg$ since $H_2(X)$ is not finitely generated.
\end{example}

\subsubsection{Rational homotopy groups}
Our next goal is to study the rational homotopy groups $\pi_k(S^n) \tensor \Q$ of spheres. 
For a start, we have already seen that $\pi_k(S^3)$ is finite for $k > 3$ and therefore
\begin{equation*}
	\pi_k(S^3) \tensor \Q \isom \begin{cases}
		\Q 	& k = 3 \\
		0 	& \text{else}
	\end{cases}
\end{equation*}
In particular, the 3rd Postnikov section $S^3 \to K(\Z, 3)$ is an isomorphism on $\pi_*({{-}}) \tensor \Q$ (since its homotopy fibre is a $\tau_{\geq 4} S^3$; or equivalently an isomorphism on $\pi_*({{-}})$ modulo $\Ctor$).
By the modulo $\Ctor$ Whitehead theorem, $S^3 \to K(\Z, 3)$ also induces an isomorphism on $H_*({{-}}; \Q)$.
In particular, $H^*(K(\Z, 3); \Q) \isom H^*(S^3; \Q) \isom \Lambda(x)$ with $x \in H^3(S^3; \Q)$ a generator.

We now turn this around and study $H^*(K(\Z, n); \Q)$ to compute $\pi_*(S^n) \tensor \Q$.
\begin{proposition}\label{prop:rationalKZncohom}
	We have
	\begin{equation*}
		H^*(K(\Z, n); \Q) \isom \begin{cases}
			\Lambda(x) 	& n \text{ odd} \\
			\Q[x] 		& n \text{ even}
		\end{cases}
	\end{equation*}
	for $x \in H^n(K(\Z, n); \Q)$ the image of the tautological class in $H^n(K(\Z, n); \Z)$ under the coefficient map
	\begin{equation*}
		H^n(K(\Z, n); \Z) \to H^n(K(\Z, n); \Q)
	\end{equation*}
\end{proposition}
\begin{proof}
	We do an induction on $n$, using the fibre sequence
	\begin{equation*}
		K(\Z, n - 1) \isom \Omega K(\Z, n) \to * \to K(\Z, n)
	\end{equation*}
	The cases $n = 1, 2$ are clear since $S^1$ is a $K(\Z, 1)$ and $\CP^\infty$ a $K(\Z, 2)$. 
	The step $n - 1$ odd to $n$ even is entirely analogous to the previously studied fibre sequence $S^1 \to * \to \CP^\infty$, see example \ref{expl:cohomology_cp_n}.

	For the step $n$ even to $n + 1$ odd, let $y \in H^n(K(\Z, n); \Q)$ be the fundamental class and set $x = d_{n + 1}(y)$.
	By the product rule, $d_{n + 1}(y^m) = m (x y^{m - 1})$ which is a generator of $E_n^{n + 1, (m - 1) n}$ as $y^m$ generates $H^{m n}(K(\Z, n); \Q)$ by assumption.
	If the group $H^k(K(\Z, n + 1); \Q)$ was non-trivial for some $k > n + 1$, the corresponding class in $E_2^{2, 0}$ could not be in the image of a differential, contradicting that $E_\infty^{p, q} = 0$ for all $(p, q) \neq (0, 0)$.
\end{proof}
\begin{figure}[ht]
	\centering
	\pgfsetlayers{background,main}
	\tikzsetnextfilename{specseq_rational_cohomology_K_Z_n}
	\begin{tikzpicture}
		\matrix[
			spectral sequence/page,
			name = m, 
			column sep = {4em, between origins},
			row sep = 2.5ex, 
			column 1/.append style = {anchor = base},
			row 7/.style = {font = \scriptsize}] {
				\vdotswithin{1} &[-2.1em] \vdotswithin{\Z}  & & \vdotswithin{\Z} \\
				n^2 & \Q y^2 & & \Q x y^2\\
				\vdotswithin{0} \\
				n & \Q y  & & \Q x y\\
				\vdotswithin{0} \\
				0 & \Q & & \Q x \\[-2ex]
				& 0 & \cdots & n + 1 \\
		};

		\coordinate (Origin) at (m-2-2.west |- m-6-2.south);

		\draw[spectral sequence/axis] (Origin) -- (Origin |- m-1-2.north) -- ++(0, .5) node[left] (q) {$q$};
		\draw[spectral sequence/axis] (Origin) -- (m-6-4.south east) -- ++(1.8, 0) node[below] (p) {$p$};

		\coordinate (Top Right) at (p |- q);

		\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
		\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

		\begin{pgfonlayer}{background}
			\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
			\fill[white] (Origin) rectangle (m-6-2.north -| m-2-2.east);
			\fill[white] (Origin |- m-4-2.south) rectangle (m-4-2.north -| m-2-2.east);
			\fill[white] (m-2-2.south west) rectangle (m-2-2.north east);
			\fill[white] (Origin |- m-1-2.south) rectangle (Slightly Below q -| m-2-2.east);

			\fill[white] (m-6-4.south -| m-2-4.west) rectangle (m-6-4.north -| m-2-4.east);
			\fill[white] (m-4-4.south -| m-2-4.west) rectangle (m-4-4.north -| m-2-4.east);
			\fill[white] (m-2-4.south west) rectangle (m-2-4.north east);
			\fill[white] (m-1-4.south -| m-2-4.west) rectangle (Slightly Below q -| m-2-4.east);
		\end{pgfonlayer}

		\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};

		\path[spectral sequence/differentials]
			(m-4-2) edge["d_{n + 1}", "\isom"'] (m-6-4)
			(m-2-2) edge["d_{n + 1}", "\isom"'] (m-4-4);
	\end{tikzpicture} 
	\begin{align*}
		E_2^{p, q} &= H^p(K(\Z, n + 1); H^q(K(\Z, n); \Q)) \\ 
				   &\isom H^p(K(\Z, n + 1); \Q) \tensor H^q(K(\Z, n); \Q)
	\end{align*}
	\caption{$E_2$-page of the Serre spectral sequence for the fibre sequence $K(\Z, n) \to * \to K(\Z, n + 1)$ with rational coefficients discussed in the proof of proposition \ref{prop:rationalKZncohom}.}
\end{figure}
\begin{remark}
	Note that $K(\Z, n) \to K(\Q, n)$ is a rational $\pi_*$-isomorphism, hence by the modulo $\Ctor$ Whitehead theorem it also induces an isomorphism on $H_*({{-}}; \Q)$ and hence $H^*({{-}}; \Q)$ (for $n > 1$).
	This is also true for $n = 1$, which one can see by noting that a model for $K(\Q, 1)$ is given by the mapping telescope $\tel\big(S^1 \xto{({{-}})^2} S^1 \xto{({{-}})^3} S^1 \xto{({{-}})^4} \cdots \big)$.
	Each $({{-}})^n$ induces an isomorphism on $H_*({{-}}; \Q)$ and $H^*({{-}}; \Q)$.
\end{remark}
\begin{theorem}[Rational homotopy groups of spheres]\label{thm:rationalhomotopyofspheres}\index{rational homotopy groups!of spheres}
	We have
	\begin{equation*}
		\pi_k(S^n) \tensor \Q \isom \begin{cases}
			\Q 	& k = n \text{ or } n \text{ even and } k = 2n - 1 \\
			0 	& \text{else}
		\end{cases}
	\end{equation*}
\end{theorem}
\begin{proof}
	We start with the case $n$ odd.
	As the case $n = 1$ is easy, we can further assume that $n \geq 3$.
	The $n$th Postnikov section $S^n \to K(\Z, n)$ induces an isomorphism on $H^*({{-}}; \Q)$, hence by duality also on homology and by the modulo $\Ctor$ Whitehead theorem also on $\pi_*({{-}}) \tensor \Q$.
	Hence,
	\begin{equation*}
		\pi_k(S^n) \tensor \Q \isom \pi_k(K(\Z, n)) \tensor \Q \isom \begin{cases}
			\Q 	& k = n \\
			0 	& \text{else}
		\end{cases}
	\end{equation*}

	For even $n$, the map $S^n \to K(\Z, n)$ is not an isomorphism on $H^*({{-}}; \Q)$ since $H^*(K(\Z, n); \Q)$ is polynomial while $H^*(S^n; \Q)$ is exterior.
	We try to build a space out of $K(\Z, m)$'s whose rational cohomology is exterior as follows:

	Let $K(\Z, n) \to K(\Z, 2n)$ classify the cup square of the fundamental class, using that $[K(\Z, n), K(\Z, 2n)]_* \isom H^{2n}(K(\Z, n); \Z)$.
	We obtain a fibre sequence $F \to K(\Z, n) \to K(\Z, 2n)$ by taking the homotopy fibre and a map $S^n \xto{f} F$ since the composite $S^n \to K(\Z, n) \to K(\Z, 2n)$ is nullhomotopic (as $\pi_n(K(\Z, 2n)) = 0$) and note that
	\begin{equation*}
		\pi_k(F) \isom \begin{cases}
			\Z 	& k = n, 2n - 1 \\
			0 	& \text{else}
		\end{cases}
	\end{equation*}
	from the long exact sequence of homotopy groups.

	We claim that $f$ induces an isomorphism on $H^*({{-}}; \Q)$:
	Consider the Serre spectral sequence for the fibre sequence $K(\Z, 2n - 1) \to F \to K(\Z, n)$.
	The differential $d_{2n}\colon H^{2n - 1}(K(\Z, 2n - 1); \Q) \to H^{2n}(K(\Z, n); \Q)$ must be surjective since we know by construction that the squaring map $H^n(F; \Q) \xto{({{-}})^2} H^{2n}(F; \Q)$ is zero.
	By the product rule, each $d_{2n}\colon E_{2n}^{kn, 2n - 1} \to E_{2n}^{(k + 2)n, 0}$ with $k \geq 0$ is an isomorphism.
	Hence, $H^*(F; \Q) \isom \Lambda(x_n)$ and $S^n \to F$ induces an isomorphism on $H^*({{-}}; \Q)$ and therefore on $\pi_*({{-}}) \tensor \Q$.
	Therefore,
	\begin{equation*}
		\pi_k(S^n) \tensor \Q \isom \pi_k(F) \tensor \Q \isom \begin{cases}
			\Q 	& k = n, 2n - 1 \\
			0 	& \text{else}
		\end{cases}
	\end{equation*}
	if $n$ is even, as claimed.
\end{proof}
\begin{figure}[ht]
	\centering
	\pgfsetlayers{background,main}
	\tikzsetnextfilename{specseq_rational_htpy_grps_auxiliary}
	\begin{tikzpicture}
		\matrix[
			spectral sequence/page,
			name = m, 
			column sep = {2em, between origins},
			row sep = 2.5ex, 
			column 1/.append style = {anchor = base},
			row 4/.style = {font = \scriptsize}] {
				2n - 1 & \Q  & & \Q & & \Q & & \Q & \cdots \\
				\vdotswithin{0} \\
				0 & \Q & & \Q & & \Q & & \Q & \cdots \\[-2ex]
				& 0 & \cdots & n & \cdots & 2n & \cdots & 3n & \cdots \\
		};

		\coordinate (Origin) at (m-3-2.south west);

		\draw[spectral sequence/axis] (Origin) -- (Origin |- m-1-2.north) -- ++(0, 1) node[left] (q) {$q$};
		\draw[spectral sequence/axis] (Origin) -- (m-3-9.east |- m-3-8.south) -- ++(.8, 0) node[below] (p) {$p$};

		\coordinate (Top Right) at (p |- q);

		\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
		\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

		\begin{pgfonlayer}{background}
			\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 
			\foreach \x in {2, 4, ..., 8}
				\foreach \y in {1, 3} 
					\fill[white] (m-\y-\x.south west) rectangle (m-\y-\x.north east);
			\foreach \y in {1, 3} 
				\fill[white] (m-\y-9.west |- m-\y-8.south) rectangle (m-\y-8.north -| Slightly Left of p);
		\end{pgfonlayer}

		\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E_2^{p, q}$};

		\path[spectral sequence/differentials]
			(m-1-2) edge["d_{2n}", "\isom"'] (m-3-4)
			(m-1-4) edge["d_{2n}", "\isom"'] (m-3-6)
			(m-1-6) edge["d_{2n}", "\isom"'] (m-3-8);
	\end{tikzpicture}
	\begin{align*}
		E_2^{p, q} &= H^p(K(\Z, n); H^q(K(\Z, 2n - 1); \Q)) \\
				&\isom H^p(K(\Z, n); \Q) \tensor H^q(K(\Z, 2n - 1); \Q)
	\end{align*}
	\caption{$E_2$-page of the Serre spectral sequence for the fibre sequence $K(\Z, 2n - 1) \to F \to K(\Z, n)$ with rational coefficients discussed in the proof of theorem \ref{thm:rationalhomotopyofspheres}.}
\end{figure}
\begin{corollary}
	The homotopy groups of the spheres satisfy
	\begin{equation*}
		\pi_k(S^n) \isom \begin{cases}
			\Z \dsum \text{(finite group)} 	& k = n \text{ or } n \text{ even and } k = 2n - 1 \\
			\text{(finite group)} 			& \text{else}
		\end{cases}
	\end{equation*}
\end{corollary}
\begin{proof}
	This follows from theorem \ref{thm:rationalhomotopyofspheres} and the fact that $\pi_k(S^n)$ is finitely generated (corollary \ref{crl:htpygrpsofspheresfg}).
\end{proof}
What is an example of an infinite order element of $\pi_{2n - 1}(S^n)$ ($n$ even) and how does one detect them?
For $n = 2$ we know that $\pi_3(S^2)$ is generated by the Hopf map $\eta\colon S(\C^2) \to \CP^1 \isom S^2$.
For general $n$, let $f\colon S^{2n - 1} \to S^n$ be a map and choose generators $a \in H^n(S^n; \Z)$ and $b \in H^{2n}(S^{2n}; \Z)$.
Then the mapping cone $C(f)$ satisfies
\begin{equation*}
	H^k(C(f); \Z) \isom \begin{cases}
		\Z 	& k = 0, n, 2n \\
		0 	& \text{else}
	\end{cases}
\end{equation*}
More precisely,
\begin{align*}
	H^n(C(f); \Z) &\xto{\isom} H^n(S^n; \Z) \\
	\tilde{a} &\mapsto a
\end{align*}
and
\begin{align*}
	H^{2n}(S^{2n}; \Z) &\xto{\isom} H^{2n}(C(f); \Z) \\
	b &\mapsto \tilde{b}
\end{align*}
(induced by $C(f) \to \Sigma S^{2n - 1} \isom S^{2n}$).
Then $\tilde{a} \smile \tilde{a} = h(f) \tilde{b}$ for a unique $h(f) \in \Z$.
\begin{definition}
	This $h(f)$ is called the \strong{Hopf invariant}\index{Hopf invariant} of $f$.
\end{definition}
\begin{lemma}
	\leavevmode	
	\begin{itemize}
		\item The Hopf invariant defines a group homomorphism
			\begin{equation*}
				h\colon \pi_{2n - 1}(S^n) \to \Z
			\end{equation*}
		\item $h(f) = 0$ if $n$ is odd.
		\item If $n$ is even, $h([\iota_n, \iota_n]) = \pm 2$ where $[\iota_n, \iota_n]$ is the composite
			\begin{equation*}
				S^{2n - 1} \to S^n \vee S^n \to S^n
			\end{equation*}
			where the first map is the attaching map for the $2n$-cell in $S^n \times S^n$ and the second map is the fold map (this is known as the \emph{Whitehead square}\index{Whitehead square}).
	\end{itemize}
\end{lemma}
\begin{proof}
	This is exercise \ref{ex:hopfinvariant}.
\end{proof}
\begin{corollary}
	For even $n$, the map $h\colon \underbrace{\pi_{2n - 1}(S^n) / \text{torsion}}_{\isom \Z} \to \Z$ is injective.
	As a special case, we have that $h(\eta\colon S^3 \to S^2) = \pm 1$ since $C(\eta) \isom \CP^2$ and $H^*(\CP^2; \Z) \isom \Z[x] / x^3$ as well as $h(S^7 \to S^4) = h(S^{15} \to S^8) = \pm 1$ by noting similarly that $S^7 \isom S(\fieldfont{H}^2)$, $S^4 \isom \HP^1$, $S^{15} \isom S(\fieldfont{O}^2)$, and that $S^8 \isom \fieldfont{O}\mathrm{P}^1$ with the given maps being the attaching maps of the respective cells in the projective spaces one dimension higher.
\end{corollary}
\begin{theorem}[Adams 1960, Hopf invariant 1 problem]\index{Hopf invariant 1 problem}
	$n = 2, 4$ and 8 are the only dimensions with elements of Hopf invariant 1.
\end{theorem}
Note that $\pi_{2n - 1}(S^n)$ is the last \enquote{unstable} homotopy group of codimension $n - 1$ (in the sense of the Freudenthal suspension theorem) and therefore surjects onto the stable, finite group $\pi_{2n}(S^{n + 1})$.
Hence, $\pi_{2n - 1}(S^n) \xto{\Sigma} \pi_{2n}(S^{n + 1})$ must have a nontrivial kernel.
In fact, $\Sigma [\iota_n, \iota_n] = 0$ (consider e.g. $\Z \isom \pi_3(S^2) \surj \pi_4(S^3) \isom \Zn{2}$, $\Z \dsum \Zn{12} \isom \pi_7(S^4) \surj \pi_8(S^5) \isom \Zn{24}$).

Using our computation of $H^*(K(\Z, n); \Q)$, we can deduce a rationl Hurewicz theorem which is stronger than the general modulo $\catfont{C}$ one:
\begin{theorem}[Rational Hurewicz theorem]\index{rational Hurewicz theorem}
	Let $X$ be simply-connected and $\pi_i(X) \tensor \Q \isom 0$ for $i \leq n - 1$.
	Then the Hurewicz map $\pi_i(X) \tensor \Q \to H_i(X; \Q)$ is an isomorphism for $1 \leq i \leq 2n - 2$ and a surjection for $i = 2n - 1$.
\end{theorem}
\begin{proof}
	Let $\tau_{\geq i} X$ be the $(i - 1)$-connected cover of $X$, i.e. the fibre of $X \to \tau_{\leq i - 1} X$.
	We consider the diagram
	\begin{equation*}
		\begin{tikzcd}
			\pi_i(\tau_{\geq i} X) \tensor \Q
					\ar[r, "\isom"]
					\ar[d, "\isom"]
				& H_i(\tau_{\geq i} X; \Q)
					\ar[d]
			\\
			\pi_i(X) \tensor \Q
					\ar[r]
				& H_i(X; \Q)
		\end{tikzcd}
	\end{equation*}
	where the top row horizontal isomorphism stems from the Hurewicz theorem.
	Hence, $\pi_i(X) \tensor \Q \to H_i(X; \Q)$ is an isomorphism (surjective, respectively) if and only if $H_i(\tau_{\geq i} X; \Q) \to H_i(X; \Q)$ is.
	\begin{lemma}\label{lmm:rationalhurewiczhelper}
		If $X$ is 1-connected and rationally $(n - 1)$-connected, then
		\begin{equation*}
			H_i(\tau_{\geq n + 1} X; \Q) \to H_i(X; \Q)
		\end{equation*}
		is an isomorphism for $n < i \leq 2n - 2$ and surjective for $i = 2n - 1$.
	\end{lemma}
	\begin{smallproof}[Proof of lemma]
		Let $A$ be an abelian group.
		% TODO give an argument as to why this is true!
		Then $H_*(K(A, n); \Q)$ is concentrated in degrees a multiple of $n$ and $H_n(K(A, n); \Q) \isom A \tensor \Q$.
		We consider the fibre sequence $\tau_{\geq n + 1} X \to X \to \tau_{\leq n} X$ and its rotation $\Omega \tau_{\leq n} X \to \tau_{\geq n + 1} X \to X$.
		There is a diagram of fibre sequences
		\begin{equation*}
			\begin{tikzcd}
				\Omega \tau_{\leq n} X 
						\ar[r]
						\ar[d, equal]
					& \tau_{\geq n + 1} X
						\ar[r]
						\ar[d]
					& X
						\ar[d]
				\\
				\Omega \tau_{\leq n} X
						\ar[r]
					& *
						\ar[r]
					& \tau_{\leq n} X
				\\
				K(\pi_n(X), n - 1)
						\ar[r]
						\ar[u, "f"]
					& *
						\ar[r]
						\ar[u, equal]
					& K(\pi_n(X), n)
						\ar[u, "g"]
			\end{tikzcd}
		\end{equation*}
		where $f$ induces an isomorphism on $H_*({{-}}; \Q)$ and $g$ induces an isomorphism on $\pi_*({{-}}) \tensor \Q$ and by the Hurewicz theorem therefore also on $H_*({{-}}; \Q)$.
		Up to total degree $2n - 1$, the rational Serre spectral sequence for the top row has potentially non-trivial entries only in degrees $(0, 0)$, $(i, 0)$ for $i \geq n$, $(0, n - 1)$, $(n, n - 1)$, and $(0, 2n - 2)$.
		By naturality, the differential $d_n\colon H_n(X; \Q) \to H_{n - 1}(\Omega \tau_{\leq n} X; \Q)$ must also be an isomorphism since the corresponding differential in the Serre spectral sequence of the middle sequence is, and $d_n\colon E^n_{n, n - 1} \to E^n_{0, 2n - 1}$ is surjective.
		Hence, in this range the $(n + 1)$st page has entries at most in the positions $(0, 0)$, $(i, 0)$ for $i > n$, and $(n, n - 1)$.
		For degree reasons there are no further differentials.
		By the edge homomorphism, the claim follows.
	\end{smallproof}
	Iterated application of this lemma then yields the result.
	% TODO? picture
\end{proof}
\begin{figure}[ht]
	\centering
	\pgfsetlayers{background,main}
	\tikzsetnextfilename{specseq_rational_hurthm_specseq_comp}
	\begin{tikzpicture}
		% these values should be the same for both matrices below, so we define some macros.
		% we could also set up a style but hey
		\def\colsep{2.5em}
		\def\rowsep{1ex}
		\def\colsepcorr{-.6ex}
		\def\rowsepcorr{-1.3ex}
		\begin{scope}[local bounding box = box 1, xshift = -4cm]
			\matrix[
				spectral sequence/page,
				name = m, 
				every node/.append style = {inner sep = 5pt},
				column sep = {\colsep, between origins},
				row sep = \rowsep, 
				column 1/.append style = {anchor = base},
				row 7/.style = {font = \scriptsize}] {
					\vdotswithin{2n - 2} &[\colsepcorr] \vdotswithin{\bullet} & & \vdotswithin{\bullet} & \adots \\
					2n - 2 & \bullet & & \bullet & \cdots \\
					\vdotswithin{n - 1} & \phantom{0} \\	
					n - 1 & \bullet & & \bullet & \cdots \\
					\vdotswithin{0} & \phantom{0} \\	
					0 & \bullet & & \bullet & \cdots \\[\rowsepcorr]
					& 0 & \cdots & n & \cdots \\
			};

			\coordinate (Origin) at (m-6-2.south west);

			\draw[spectral sequence/axis] (Origin) -- (Origin |- m-1-2.north) -- ++(0, .8) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (m-6-5.south east) -- ++(1, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 

				\fill[white] 
					(m-6-2.south west) rectangle (m-6-2.north east)
					(m-4-2.south west) rectangle (m-4-2.north east)
					(m-2-2.south west) rectangle (m-2-2.east |- Slightly Below q)
					(m-6-4.south west) rectangle (m-6-4.north -| Slightly Left of p)
					(m-4-4.south west) rectangle (m-4-4.north -| Slightly Left of p)
					(m-2-4.south west) rectangle (Top Right);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

			\path[spectral sequence/differentials]
				(m-6-4) edge[highlightcol, swap, "d_n"] (m-4-2)
				(m-4-4) edge[swap, "d_n"] (m-2-2);
		\end{scope}
		\begin{scope}[local bounding box = box 2, xshift = 4cm]
			\matrix[
				spectral sequence/page,
				name = n, 
				every node/.append style = {inner sep = 5pt},
				column sep = {\colsep, between origins},
				row sep = \rowsep, 
				column 1/.append style = {anchor = base},
				row 7/.style = {font = \scriptsize}] {
					\vdotswithin{2n - 2} &[\colsepcorr] \vdotswithin{\bullet} & & \vdotswithin{\bullet} \\
					2n - 2 & \bullet & & \bullet \\
					\vdotswithin{n - 1} & \phantom{0} \\	
					n - 1 & \bullet & & \bullet \\
					\vdotswithin{0} & \phantom{0} \\	
					0 & \bullet & & \bullet & \phantom{\cdots} \\[\rowsepcorr]
					& 0 & \cdots & n & \cdots \\
			};

			\coordinate (Origin) at (n-6-2.south west);

			\draw[spectral sequence/axis] (Origin) -- (Origin |- n-1-2.north) -- ++(0, .8) node[left] (q) {$q$};
			\draw[spectral sequence/axis] (Origin) -- (n-6-5.south east) -- ++(1, 0) node[below] (p) {$p$};

			\coordinate (Top Right) at (p |- q);

			\coordinate (Slightly Left of p) at ($(p) - (0.14, 0)$);
			\coordinate (Slightly Below q) at ($(q) - (0, 0.14)$);

			\begin{pgfonlayer}{background}
				\draw[spectral sequence/zero region] (Origin) rectangle (Slightly Left of p |- Slightly Below q); 

				\fill[white] 
					(n-6-2.south west) rectangle (n-6-2.north east)
					(n-4-2.south west) rectangle (n-4-2.north east)
					(n-2-2.south west) rectangle (n-2-2.east |- Slightly Below q)
					(n-6-4.south west) rectangle (n-6-4.north east)
					(n-4-4.south west) rectangle (n-4-4.north east)
					(n-2-4.south west) rectangle (n-2-4.east |- Slightly Below q);
			\end{pgfonlayer}

			\node[spectral sequence/page label] at ($(Top Right) - (0.3, 0.3)$) {$E^2_{p, q}$};

			\path[spectral sequence/differentials]
				(n-6-4) edge[highlightcol, swap, "d_n", "\isom"'] (n-4-2)
				(n-4-4) edge[swap, "d_n"] (n-2-2);
		\end{scope}

		\path[commutative diagrams/every arrow, line width = 1pt, shorten < = 1ex, shorten > = 1ex] (box 1.east) -- (box 2.west);
		
		\node[below = 3.5ex of m-6-4] {$\begin{aligned}
				E^2_{p, q} &= H_p(X; H_q(\Omega \tau_{\leq n} X; \Q)) \\
						&\Rightarrow H_{p + q}(\tau_{\geq n + 1} X; \Q)
			\end{aligned}$};
		\node[below = 3.5ex of n-6-4] {$\begin{aligned}
				E^2_{p, q} &= H_p(\tau_{\leq n} X; H_q(\Omega \tau_{\leq n} X; \Q)) \\
						&\Rightarrow H_{p + q}(*; \Q)
			\end{aligned}$};
	\end{tikzpicture}
	\caption{The map of spectral sequences considered in the proof of lemma \ref{lmm:rationalhurewiczhelper} above. The differential in question is highlight in \textcolor{highlightcol}{red}.}
\end{figure}
\begin{corollary}
	Let $X$ be a pointed space.
	For $k \in \N$ consider the colimit $\pi_k^\text{st}(X) \tensor \Q = \colim_{n} \pi_{k + n}(\Sigma^n X) \tensor \Q$ along the suspension maps.
	We obtain a Hurewicz map
	\begin{equation*}
		\pi_k^\text{st}(X) \tensor \Q \to H_k(X; \Q)
	\end{equation*}
	via
	\begin{equation*}
		\begin{tikzcd}
			\pi_k(X) \tensor \Q
					\ar[r, "\Hur"]
					\ar[d]
				& H_k(X; \Q)
					\ar[d, "\isom"]
			\\
			\pi_{k + 1}(\Sigma X) \tensor \Q
					\ar[r, "\Hur"]
					\ar[d]
				& H_{k + 1}(\Sigma X; \Q)
					\ar[d, "\isom"]
			\\
			\vdotswithin{=}
				& \vdotswithin{=}
		\end{tikzcd}
	\end{equation*}
	This Hurewicz map is an isomorphism.
\end{corollary}
\begin{proof}
	By the rational Hurewicz theorem, $\pi_{k + n}(\Sigma^n X) \tensor \Q \to H_{k + n}(\Sigma^n X; \Q)$ is an isomorphism up to degree $k + n \leq 2n - 2$ since $\Sigma^n X$ is $(n - 1)$-connected.
	Hence, for fixed $k$ and $n - 2 \geq k$, the maps in the directed system are isomorphisms.
\end{proof}
In particular, $\pi^\text{st}_*({{-}}) \tensor \Q$ is a homology theory, i.e. it has long exact sequences for cofiber sequences even though the unstable $\pi_*$ do not.
We will see in an exercise that in fact $\pi^\text{st}_*({{-}})$ is already a homology theory called \emph{stable homotopy}\index{stable homotopy}.
Its coefficients are the stable homotopy groups of spheres.

\subsection{Cohomology operations and the cohomology of \texorpdfstring{$K(\F_2, n)$}{K(F2, n)}}
\lecture{17.11.23}
\begin{definition}
	A \strong{cohomology operation}\index{cohomology operation} is a natural transformation 
	\begin{equation*}
		\phi\colon H^k({{-}}; A) \to H^l({{-}}; B)
	\end{equation*}
	for abelian groups $A, B$ and $k, l \in \Z$.
	A \strong{stable cohomology operation}\index{cohomology operation!stable}\index{stable cohomology operations|see {cohomology operation!stable}} of degree $n$ is  collection of cohomology operations $\{\phi^{(k)}\colon H^k({{-}}; A) \to H^{k + n}({{-}}; B)\}$ which commute with the suspension isomorphism, i.e. such that the diagram
	\begin{equation*}
		\begin{tikzcd}
			H^k(X; A) 
					\ar[r, "\phi^{(k)}"]
					\ar[d, "\sigma", "\isom"']
				& H^{k + n}(X; B)
					\ar[d, "\sigma", "\isom"']
			\\
			H^{k + 1}(\Sigma X; A)
					\ar[r, "\phi^{(k + 1)}"]
				& H^{k + 1 + n}(\Sigma X; B)
		\end{tikzcd}
	\end{equation*}
	commutes for all spaces $X$.
\end{definition}
\begin{example}
	\leavevmode
	\begin{itemize}
		\item Let $R$ be a ring and $n \in \N$.
			Then
			\begin{align*}
				H^k(X; R) &\to H^{n k}(X; R) \\
				x &\mapsto x^{\smile n}
			\end{align*}
			is a cohomology operation.
			Note that this is typically no additive\footnote{For the purpose of cohomology operations, we consider $H^*({{-}}; A)$ to take values in (pointed) sets, not in abelian groups.} (unless $n = p^k$ and $\chr(R) = p$).
		\item If $f\colon A \to B$ is a map of abelian groups, then $f_*^{(k)}\colon H^k({{-}}; A) \to H^k({{-}}; B)$ is a cohomology operation.
			The family $\{f_*^{(k)}\}$ is a stable operation of degree 0.
		\item Given a short exact sequence $0 \to A \to B \to C \to 0$ of abelian groups, the sequence $0 \to C^*(X; A) \to C^*(X; B) \to C^*(X; C) \to 0$ is exact for any space $X$, so we obtain boundary maps $\delta^{(k)}\colon H^k(X; C) \to H^{k + 1}(X; A)$.
			The family $\{\delta^{(k)}\}$ is stable of degree 1 and known as the \strong{Bockstein homomorphism}\index{Bockstein homomorphism} associated to the given short exact sequence.
	\end{itemize}
\end{example}
\begin{lemma}
	Every stable operation $\{\phi^{(k)}\}$ is additive.
\end{lemma}
\begin{proof}
	Let $Y$ be a pointed $(m - 1)$-connected space for some $m \geq 2$.
	Then $Y \vee Y \to Y \times Y$ induces an isomorphism on $H_k({{-}}; \Z)$ for $k = 0, \ldots, 2m - 1$ by the Künneth theorem.
	We obtain a diagram
	\begin{equation*}
		\begin{tikzcd}[column sep = small]
			{\renewcommand\arraystretch{0.8}\begin{matrix}
				H^k(Y; A) \\
				\times \\
				H^k(Y; A)
			\end{matrix}}
					\ar[r, "\isom"]
					\ar[rrr, highlightcol, bend left = 15, "+"]
					\ar[d, "\phi^{(k)} \times \phi^{(k)}"]
				& H^k(Y \vee Y; A) 
					\ar[d, "\phi^{(k)}"]
				& H^k(Y \times Y; A)
					\ar[l, swap, "\isom"]
					\ar[r, "\Delta^*"]
					\ar[d, "\phi^{(k)}"]
				& H^k(Y; A)
					\ar[d, "\phi^{(k)}"]
			\\
			{\renewcommand\arraystretch{0.8}\begin{matrix}
				H^{k + n}(Y; A) \\
				\times \\
				H^{k + n}(Y; A)
			\end{matrix}}
					\ar[r, "\isom"]
					\ar[rrr, highlightcol, bend right = 15, "+"]
				& H^{k + n}(Y \vee Y; A) 
				& H^{k + n}(Y \times Y; A)
					\ar[l, swap, "\isom"]
					\ar[r, "\Delta^*"]
				& H^{k + n}(Y; A)
		\end{tikzcd}
	\end{equation*}
	if $k + n, k < 2m - 1$.
	By naturality of $\phi^{(k)}$, this diagram commutes.
	Now let $X$ be arbitrary and $k \in \Z$.
	Then $\phi^{(m + l)}\colon H^{m + k}(\Sigma^m X; A) \to H^{m + k + n}(\Sigma^m X; B)$ is additive whenever $m + k < 2m$ and $m + k + n < 2m$ which we can achieve by choosing $m$ large enough.
	By stability, $\phi^{(k)}\colon H^k(X; A) \to H^{k + n}(X; B)$ agrees with this map up to suspension isomorphism, so it is also additive.
\end{proof}
Note that for a ring $R$ and abelian group $A$, the set of cohomology operations $H^k({{-}}; A) \to H^*({{-}}; R)$ forms a graded ring by pointwise sum and cup product.
It is graded commutative if $R$ is commutative.
Moreover, the set of stable cohomology operations $\big\{H^k({{-}}; A) \to H^{k + *}({{-}}; A) \mid k \in \Z\big\}$ forms a graded ring under composition.
This is generally not commutative.
\begin{notation}
	We write
	\begin{itemize}
		\item $\CohOps(k, A, l, B)$ for the set of all cohomology operations $H^k({{-}}; A) \to H^l({{-}}; B)$,
		\item $\CohOps(k, A, R)$ for the ring of cohomology operations $H^k({{-}}; A) \to H^*({{-}}; R)$,
		\item $\CohOpsst(n, A, B)$ for the collection of all stable cohomology operations $H^*({{-}}; A) \to H^{* + n}({{-}}; B)$, and
		\item $\CohOpsst(A)$ for the ring of stable cohomology operations $H^*({{-}}; A) \to H^{* + *}({{-}}; A)$.
	\end{itemize}
\end{notation}
\begin{proposition}\label{prp:cohopsbijections}
	We have bijections
	\begin{align*}
		\CohOps(k, A, l, B) &\xto{\isom} H^l(K(A, k); B) \\
		\phi &\mapsto \phi(\iota_k)
	\end{align*}
	where $\iota_k \in H^k(K(A, k); A)$ is the fundamental class, and
	\begin{align*}
		\CohOpsst(n, A, B) &\xto{\isom} \lim_{k \in \N} H^{k + n}(K(A, k); B)
	\end{align*}
	where the limit is taken along the maps
	\begin{equation*}
		H^{k + 1 + n}(K(A, k + 1), B) \to H^{k + 1 + n}(\Sigma K(A, k); B) \isom H^{k + n}(K(A, k); B)
	\end{equation*}
	with $\Sigma K(A, k) \to K(A, k + 1)$ adjoint to the weak homotopy equivalence $K(A, k) \to \Omega K(A, k + 1)$ that induces $\id_A$ on $\pi_k$.
\end{proposition}
\begin{remark}
	By the Freudenthal suspension theorem, the map $\Sigma K(A, k) \to K(A, k + 1)$ is an isomorphism on $\pi_*$ up to degree $2k - 1$, hence by the Hurewicz theorem also $H^l({{-}}; B)$, so for fixed $n$ the connecting maps stabilize.
\end{remark}
\begin{proof}[Proof of proposition]
	The first bijection is a consequence of the natural isomorphism
	\begin{align*}
		[X, K(A, k)] &\to H^k(X; A) \\
		f &\mapsto f^*(\iota_n)
	\end{align*}
	and the Yoneda lemma.

	For the second bijection, stable operations are by definition the limit over $k$ along the maps
	\begin{align*}
		\CohOps(k + 1, A, k + 1 + n, B) &\to \CohOps(k, A, k + n, B) \\
		\phi &\mapsto \sigma^{-1} \circ \phi \circ \sigma
	\end{align*}
	where $\sigma$ denotes the suspension isomorphism.
	Using the first bijection, it now suffices to observe that we have
	\begin{align*}
		H^{k + 1}(K(A, k + 1); B) &\to H^{k + 1}(\Sigma K(A, k); A) \\
		\iota_{k + 1} &\mapsto \sigma(\iota_k)
	\end{align*}
	which follows from $K(A, k) \to \Omega K(A, k + 1)$ inducing the identity of $A$ on $\pi_k$ and the natural identification
	\begin{align*}
		H^{k + 1}(K(A, k + 1); A) &\isom \Hom(H_{k + 1}(K(A, k + 1); A), A) \\ 
								  &\isom \Hom(\pi_{k + 1} K(A, k + 1), A)
	\end{align*}
	and likewise for $k$.
\end{proof}
\begin{corollary}
	All operations $H^k({{-}}; A) \to H^l({{-}}; B)$ with $l < k$ are trivial.
\end{corollary}
\begin{proof}
	$K(A, k)$ is $(n - 1)$-connected, hence $H^l(K(A, k); B) = 0$ for $0 < l < k$.
\end{proof}
\begin{corollary}
	\leavevmode
	\begin{enumerate}
		\item Let $k$ be odd and $l > 0$.
			Then
			\begin{equation*}
				\CohOps(k, \Q, l, \Q) \isom \begin{cases}
					\Q 	& k = l \\
					0 	& \text{else}
				\end{cases}
			\end{equation*}
		\item For $k$ even, we obtain
			\begin{equation*}
				\CohOps(k, \Q, l, \Q) \isom \begin{cases}
					\Q\{({{-}})^{\smile n}\} 	& l = n k \\
					0 							& \text{else}
				\end{cases}
			\end{equation*}
		\item The graded ring of stable operations $H^*({{-}}; \Q) \to H^{* + *}({{-}}; \Q)$ is a copy of $\Q$ concentraded in degree 0.
	\end{enumerate}
\end{corollary}
\begin{proof}
	This follows from proposition \ref{prp:cohopsbijections} and earlier computations of
	\begin{equation*}
		H^*(K(\Q, k); \Q) \isom \begin{cases}
			\Lambda(x_k) 	& k \text{ odd} \\
			\Q[x_k] 		& k \text{ even}
		\end{cases}
	\end{equation*}
\end{proof}

\lecture{20.11.23}
We now turn to operations on cohomology with $\F_2$-coefficients.
\begin{theorem}[Steenrod]\index{Steenrod squares}
	There are unique cohomology operations
	\begin{equation*}
		\Sq^i\colon H^n(X; \F_2) \to H^{n + i}(X; \F_2)
	\end{equation*}
	for every $n, i \geq 0$ with the following properties:
	\begin{itemize}
		\item $\Sq^0 = \id$.
		\item $\Sq^i\colon H^i(X; \F_2) \to H^{2i}(X; \F_2)$ is the cup square.
		\item If $i > |x|$, then $\Sq^i(x) = 0$.
		\item The \strong{Cartan formula}\index{Cartan formula}
			\begin{equation*}
				\Sq^n(x y) = \sum_{i + j = n} \Sq^i(x) \smile \Sq^j(y)
			\end{equation*}
			holds.
	\end{itemize}
	Moreover, these operations are stable, $\Sq^1$ is the Bockstein homomorphism associated to the short exact sequence $0 \to \F_2 \to \Zn{4} \to \F_2 \to 0$, and they satisfy the \strong{Adem relations}\index{Adem relations}
	\begin{equation*}
		\Sq^i \Sq^j = \sum_{n = 0}^{\lfloor i / 2\rfloor} \binom{j - n - 1}{i - 2n} \Sq^{i + j - n} \Sq^n
	\end{equation*}
	for all $0 < i < 2j$ (the product $\Sq^i \Sq^j$ here is given by composition).
\end{theorem}
Those who took Topology 2 last term have already seen a construction (and proofs of some the properties).
We explain a different way to construct the $\Sq^i$ using the Serre spectral sequence.

Let $S^\infty \isom E C_2 \to B C_2 \isom \RP^\infty$ be the universal cover (here $C_2 \isom \Zn{2}$ is the cyclic group of order 2).
The group $C_2$ acts on $K(\F_2, n)^{\times 2}$ by permuting the factors and likewise on $K(\F_2, n)^{\wedge 2} = K(\F_2, n)^{\times 2} / K(\F_2, n)^{\vee 2}$.
We can form the quotients $E C_2 \times_{C_2} K(\F_2, n)^{\times 2}$ and $(E C_2)_{+} \wedge_{C_2} K(\F_2, n)^{\wedge 2}$ where $(E C_2)_{+}$ is $E C_2$ with a free basepoint adjoined.
\begin{proposition}
	We have a bijection
	\begin{equation*}
		H^{2n}((E C_2)_{+} \wedge_{C_2} K(\F_2, n)^{\wedge 2}; \F_2) \xto{\isom} H^{2n}(K(\F_2, n)^{\wedge 2}; \F_2) \isom \F_2\{\iota_n \smile \iota_n\}
	\end{equation*}
\end{proposition}
Conceptionally, the extension of the cup square $K(\F_2, n)^{\wedge 2} \to K(\F_2, 2n)$ to a map $(E C_2)_{+} \wedge_{C_2} K(\F_2, n)^{\wedge 2} \to K(\F_2, 2n)$ comes from the fact that the cochains $C^*(X; \F_2)$ (or the spectrum $H \F_2$ comes with a so-called $E_\infty$-multiplication (it \enquote{commutes up to all higher homotopies}), and there are maps $(E \Sigma_m)_{+} \wedge_{\Sigma_m} K(\F_2, n)^{\wedge m} \to K(\F_2, m n)$ for all $m, n$).
We can also construct the class in an ad-hoc way using our methods.
This is easiest done using a relative form of the Serre spectral sequence.
\begin{proposition}
	Let $f\colon E \to B$ be a Serre fibration and $E' \subseteq E$ be a subspace such that $f|_{E'}\colon E' \to B$ is again a Serre fibration.
	We write $F = f^{-1}(b)$ and $F' = (f|_{E'})^{-1}(b)$ for the fibres.
	Then there is a spectral sequence of the form
	\begin{equation*}
		E_2^{p, q} = H^p(B; H^q(F, F'; A)) \Rightarrow H^{p + q}(E, E'; A)
	\end{equation*}
	for any abelian group $A$.
	As before, $H^q(F, F'; A)$ is to be interpreted as a local system in general.
\end{proposition}
\begin{proof}[Sketch of proof]
	The spectral sequences can be obtained from the quotient double complex
	\begin{equation*}
		C^{*, *}(f; A) / C^{*, *}(f|_{E'}; A)
	\end{equation*}
	in the usual way.
\end{proof}

We now apply this to the Serre fibration $E C_2 \times_{C_2} K(\F_2, n)^{\times 2} \to B C_2$ with fibre $K(\F_2, n)^{\times 2}$ and its subfibration $E C_2 \times_{C_2} K(\F, n)^{\vee 2} \to B C_2$.
By the Künneth theorem, the groups
\begin{equation*}
	H^q(K(\F_2, n)^{\times 2}, K(\F_2, n)^{\vee 2}; \F_2) \isom \tilde{H}^q(K(\F_2, n)^{\wedge 2}; \F_2)
\end{equation*}
are 0 for $q < 2n$ and isomorphic to a copy of $\F_2$ spanned by $\iota_n \smile \iota_n$ in degree $2n$.
Note that any group action on $\F_2$ is necessarily trivial, so the local system $H^{2n}(K(\F_2, n)^{\times 2}, K(\F_2, n)^{\vee 2}; \F_2)$ is constant.
Hence, for the relative Serre spectral sequence we have that $E_2^{0, 2n} \isom H^0(B C_2; H^{2n}(K(\F_2, n)^{\times 2}, K(\F_2, n)^{\vee 2}; \F_2)) \isom \F_2$.
% TODO picture?
For degree reasons there cannot be any nontrivial differential out of $E_2^{0, 2n}$, so we obtain a unique class $\alpha_n \in H^{2n}((E C_2)_{+} \wedge_{C_2} K(\F_2, n)^{\wedge 2}; \F_2)$ refining the cup square in $H^{2n}(K(\F_2, n)^{\wedge 2}; \F_2)$.
\begin{remark}
	The same proof works for all $m$:
	\begin{equation*}
		H^{n m}((E \Sigma_{m})_{+} \wedge_{\Sigma m} K(\F_2, n)^{\wedge m}; \F_2) \xto{\isom} H^{n m}(K(\F_2, n)^{\wedge m}; \F_2) \isom \F_2\{\iota_n^{\smile m}\}
	\end{equation*}
\end{remark}
We now proceed by pulling back $\alpha_n$ under the map 
\begin{align*}
	H^{2n}((E C_2)_+ \wedge_{C_2} K(\F_2, n)^{\wedge 2}; \F_2) \xto{\Delta^*} & H^{2n}((B C_2)_+ \wedge K(\F_2, n); \F_2) \\ 
																			  &\; \isom \bigdsum_{i = 0}^n H^i(B C_2; \F_2) \tensor \tilde{H}^{2n - i}(K(\F_2, n); \F_2)
\end{align*}
Let $u \in H^1(B C_2; \F_2)$ be a generator.
Then $\Sq^i(\iota_n) \in H^{n + i}(K(\F_2, n); \F_2)$ is uniquely defined by the expression
\begin{equation*}
	\Delta^*(\alpha_n) = \sum_{i = 0}^n u^{n - i} \smile \Sq^i(\iota_n)
\end{equation*}
By the Yoneda lemma (cf. proposition \ref{prp:cohopsbijections}), $\Sq^i(\iota_n)$ corresponds to a cohomology operation $\Sq^i\colon H^n({{-}}; \F_2) \to H^{n + i}({{-}}; \F_2)$.
We omit the proof of the properties from the theorem.

Let $\symcal{A}$ denote the \strong{Steenrod algebra}\index{Steenrod algebra} defined as the free graded algebra on the classes $\Sq^i$ (with $|\Sq^i| = i$) modulo the Adem relations and the relation $\Sq^0 = 1$.
By construction, we obtain a map from $\symcal{A}$ to the ring of stable cohomology operations on $H^*({{-}}; \F_2)$.
We will later show this to be an isomorphism. 
Note that the cohomology ring $H^*(X; \F_2)$ is naturally a module over $\symcal{A}$, satisfying the Cartan formula, the condition $\Sq^i(x) = 0$ for $i > |x|$, and $\Sq^{|x|}(x) = x^2$ (a so-called \enquote{unstable module}).

For now, we record some application.
We say that an element $x \in \symcal{A}_n$ is \strong{decomposable}\index{Steenrod algebra!decomposable element} if it can be written as
\begin{equation*}
	x = x_1 y_1 + \ldots + x_k y_k
\end{equation*}
for homogeneous $x_i, y_i \in \symcal{A}$ of positive degree.
\begin{lemma}
	The class $\Sq^m$ is decomposable if and only if $m$ is not a power of 2.
\end{lemma}
\begin{proof}
	Assume $m$ is not a power of 2.
	Let $i$ be the smallest power of 2 which does not appear in the binary expansion of $m - 1$.
	We consider the Adem relation
	\begin{equation*}
		\Sq^i \Sq^{m - i} = \sum_{n = 0}^{\lfloor i / 2\rfloor} \binom{m - i - n - 1}{i - 2n} \Sq^{m - n} \Sq^n
	\end{equation*}
	The coefficient of $\Sq^m$, i.e. the case $n = 0$ is given by $\binom{m - i -1}{i}$.
	This number is odd since $i$ appears in the binary expansion of $m - i - 1$ (cf. Lucas' theorem). % TODO cite reference
	Hence, $\Sq^m = \Sq^i \Sq^{m - i} + \sum_{n = 1}^{\lfloor i / 2\rfloor} \binom{m - i - n - 1}{i - 2n} \Sq^{m - n} \Sq^n$ is decomposable.

	Now let $m = 2^k$.
	It suffices to give a graded $\symcal{A}$-module $V$ and a homogeneous element $v \in V$ such thath $\Sq^{2^k}(v) \neq 0$ and $\Sq^i(v) = 0$ for all $i = 1, \ldots, 2^k - 1$.
	We claim that $V = H^*(\RP^\infty; \F_2) \isom \F_2[u]$ and $v = u^{2^k}$ does the job.
	For $k = 0$, we have that $\Sq^1(u) = u^2 \neq 0$ and there is no degree between 0 and 1 to consider.
	Let us now inductively asssume that the statement holds up to $k - 1$, given a general $k$.
	We then have
	\begin{align*}
		\Sq^0(u^{2^{k - 1}}) &= u^{2^{k - 1}} \\
		\Sq^{2^{k - 1}}(u^{2^{k - 1}}) &= (u^{2^{k - 1}})^2 = u^{2^k} \qquad\qquad\\
		\Sq^i(u^{2^{k - 1}}) &= 0 \mathrlap{\qquad\qquad\qquad\quad\text{for all } i = 1, \ldots, 2^{k - 1} - 1}
	\end{align*}
	For $l = 1, \ldots, 2^k - 1$ we now have
	\begin{equation*}
		\Sq^l(u^{2^k}) = \Sq^l(u^{2^{k - 1}} \smile u^{2^{k - 1}}) = \sum_{i = 0}^l \Sq^i(u^{2^{k - 1}}) \smile \Sq^{l - i}(u^{2^{k - 1}})
	\end{equation*}
	by the Cartan formula, but $\Sq^i(u^{2^{k - 1}}) \smile \Sq^{l - i}(u^{2^{k - 1}}) \neq 0$ only if $i, l \in \{0, 2^{k - 1}\}$ which in the given range is the case only for $l = 2^{k - 1}, i = 0$ and $l = 0, i = 2^{k - 1}$ whose terms cancel each other out.
	Hence, $\Sq^l(u^k) = 0$ for $l = 1, \ldots, 2^k - 1$ and $\Sq^{2^k}(u^{2^k}) = (u^{2^k})^2 = y^{2^{k + 1}} \neq 0$.
\end{proof}
\begin{remark}
	More conceptually, the total squaring operation\index{Steenrod squares!total square}
	\begin{equation*}
		\Sq \colon \Sq^0 + \Sq^1 + \ldots\colon H^*(X; \F_2) \to H^*(X; \F_2)
	\end{equation*}
	is a ring homomorphism by the Cartan formula, hence $\Sq(u^{2^k}) = \Sq(u)^{2^k} = (u + u^2)^{2^k} = u^{2^k} + u^{2^{k + 1}}$ via the $\F_2$-Frobenius.
\end{remark}
\begin{example}
	Here are a few decompositions of Steenrod squares:
	\begin{itemize}
		\item $\Sq^3 = \Sq^1 \Sq^2$
		\item $\Sq^5 = \Sq^1 \Sq^4$
		\item In general, $\Sq^{2n + 1} = \Sq^1 \Sq^{2n}$
		\item $\Sq^6 = \Sq^2 \Sq^4 + \Sq^5 \Sq^1 = \Sq^2 \Sq^4 + \Sq^1 \Sq^4 \Sq^1$
	\end{itemize}
\end{example}
\begin{corollary}
	If there exists an element $[f] \in \pi_{2n - 1}(S^n)$ of Hopf invariant 1, then $n$ is a power of 2.
\end{corollary}
\begin{proof}
	Let $f\colon S^{2n - 1} \to S^n$ be a representative of such a class.
	By definition, if $x \in H^n(C(f); \Z) \isom \Z$ is a generator, then $x^2$ generates $H^{2n}(C(f); \Z) \isom \Z$.
	Reducing modulo 2, we conclude that the cup square of a generator $\bar{x} \in H^n(C(f); \F_2) \isom \F_2$ generates $H^{2n}(C(f); \F_2) \isom \F_2$.
	Hence $\Sq^n(\bar{x}) = \bar{x}^2 \neq 0$, but $H^k(C(f); \F_2) = 0$ for $k = n + 1, \ldots, 2n - 1$, implying that $\Sq^1(\bar{x}), \ldots, \Sq^{n - 1}(\bar{x})$ are trivial.
	By the previous lemma, we conclude that $n$ must be a power of 2.
\end{proof}
\lecture{24.11.23}
\begin{example}
	We use the Adem relations to show that $f = \eta \circ \Sigma \eta\colon S^4 \to S^2$ is non-trivial in $\pi_4(S^2)$.
	If $f$ was trivial, we could extend $\eta\colon S^3 \to S^2$ over the cone of $\Sigma \eta$, which is given by $\Sigma \CP^2$, as in
	\begin{equation*}
		\begin{tikzcd}[column sep = small]
			S^4 
					\ar[rr, "\Sigma \eta"]
				& & S^3
					\ar[rr, "\eta"]
					\ar[dr]
				& & S^2
			\\
				& & & C(\Sigma \eta)
					\ar[ur, dashed]
		\end{tikzcd}
	\end{equation*}	
	where the triangle at the right commutes.
	Let $g\colon \Sigma \CP^2 \to S^2$ be this extension.
	The mapping cone $C(g)$ has one cell each in dimensions 0, 2, 4, and 6.
	Let $x_2, x_4, x_6 \in H^*(C(g); \F_2)$ denote the generators in the respective degrees.
	We obtain the following picture on cohomology from the maps $\CP^2 = C(\eta) \incl C(g)$ and $C(g) \to \Sigma^2 \CP^2$:
	\begin{equation*}
		\tikzsetnextfilename{specseq_mappingconesteenrodsquares}
		\begin{tikzpicture}[
				dot/.style = {
					shape = circle, 
					fill,
					inner sep = 1.2pt,
					outer sep = 1.5pt
				}, 
				arrow path/.style = {
					commutative diagrams/every arrow,
					commutative diagrams/every label,
				},
				xscale = 4, 
				yscale = 2]
			\node[dot] (LX4) at (-1, -1) {};
			\node[dot] (LX2) at (-1, -2) {};

			\node[dot, label = right:$x_6$] (X6) at (0, 0) {};
			\node[dot, label = right:$x_4$] (X4) at (0, -1) {};
			\node[dot, label = right:$x_2$] (X2) at (0, -2) {};

			\node[dot] (RX6) at (1, 0) {};
			\node[dot] (RX4) at (1, -1) {};

			\node (Left Group) at (-1, .5) {$\tilde{H}^*(\CP^2; \F_2)$};
			\node (Middle Group) at (0, .5) {$\tilde{H}^*(C(g); \F_2)$};
			\node (Right Group) at (1, .5) {$\tilde{H}^*(\Sigma^2 \CP^2; \F_2)$};
			
			\draw[every edge/.append style = {
						arrow path, 
						thick, 
						bend left = 12, 
						"$\Sq^2$"
					}] 
				(LX2) edge (LX4)
				(X2) edge[highlightcol] (X4)
				(X4) edge[highlightcol] (X6)
				(RX4) edge (RX6);

			\def\shiftval{0.25}
			\path[every edge/.append style = {arrow path}]
				($(X4.west) - (\shiftval, 0)$) edge ($(LX4.east) + (\shiftval, 0)$)
				($(X2.west) - (\shiftval, 0)$) edge ($(LX2.east) + (\shiftval, 0)$)
				($(RX6.west) - (\shiftval, 0)$) edge ($(X6.east) + (\shiftval, 0)$)
				($(RX4.west) - (\shiftval, 0)$) edge ($(X4.east) + (\shiftval, 0)$);

			\path[every edge/.append style = {arrow path}]
				(Middle Group) edge (Left Group)
				(Right Group) edge (Middle Group);
		\end{tikzpicture}
	\end{equation*}
	By naturality, we have $\Sq^2 \Sq^2 x_2 = x_6 \neq 0$.
	But $\Sq^2 \Sq^2 = \Sq^3 \Sq^1$ by the Adem relations and $\Sq^1(x_2) = 0$ for degree reasons.

	Note that this also shows that $\Sigma^k(\eta \circ \Sigma \eta)$ is homotopically nontrivial for all $k$.
\end{example}

Now we turn to the computation of $H^*(K(\F_2, n); \F_2)$ for all $n$.
\subsection{Cohomology of Eilenberg-Mac Lane spaces over \texorpdfstring{$\F_2$}{F2}}
\begin{definition}
	For $I = (i_n, i_{n - 1}, \ldots, i_0)$ an $(n + 1)$-tuple of natural numbers, we denote by $\Sq^I \in \symcal{A}$ the composite $\Sq^{i_n} \Sq^{i_{n - 1}} \cdots \Sq^{i_0}$.
	We call $I$ \strong{admissible}\index{Steenrod squares!admissible sequence of} if $i_k \geq 2 i_{k - 1}$ for all $k$ and $i_0 \geq 1$.
	Here, the empty sequence is admissible and $\Sq^{\emptyset} = 1$.
	We further write $\big|I\big| \coloneq i_n + \ldots + i_0 = \big|\Sq^I\big|$ for the total degree.
	The \strong{excess}\index{Steenrod squares!admissible sequence of!excess of} $e(I)$ of an admissible sequence is 
	\begin{equation*}
		e(I) \coloneq (i_n - 2 i_{n - 1}) + \ldots + (i_1 - 2 i_0) + i_0 = 2 i_n - \big|I\big|
	\end{equation*}
\end{definition}
\begin{theorem}[Cartan-Serre]\index{Cartan-Serre theorem}\label{thm:cartanserre}
	For $n \geq 1$ we have 
	\begin{equation*}
		H^*(K(\F_2, n); \F_2) \isom \F_2\big[\big\{\Sq^I \iota_n \mid I \text{ admissible}, e(I) < n\big\}\big]
	\end{equation*}
	where $\iota_n \in H^n(K(\F_2, n); \F_2)$ denotes the fundamental class and the expression on the right hand side denotes the polynomial over $\F_2$ on the given set (with $\Sq^I \iota_n$ sitting in degree $n + \big|I\big|$).
	Moreover, for $n \geq 2$, we have 
	\begin{equation*}
		H^*(K(\Z, n); \F_2) \isom \F_2\big[\big\{\Sq^I \iota_n \mid I \text{ admissible}, i_0 \geq 2, e(I) \leq n\big\}\big]
	\end{equation*}
\end{theorem}
\begin{example}
	\leavevmode
	\begin{itemize}
		\item $H^*(K(\F_2, 1); \F_2) \isom \F_2[\iota_1]$ since every non-empty admissible sequence $I$ has $e(I) \geq 1$.
		\item $H^*(K(\F_2, 2); \F_2) \isom \F_2[\{\Sq^{2^n} \Sq^{2^{n - 1}} \cdots \Sq^1 \iota_2 \mid n \geq -1\}]$.
		\item $H^*(K(\Z, 2); \F_2) \isom \F_2[\iota_2]$ since every non-empty, admissible sequence $I$ with $i_0 \geq 2$ has $e(I) \geq 2$.
	\end{itemize}
\end{example}
For some motivation, consider the fibre sequence $K(\F_2, n) \to * \to K(\F_2, n + 1)$.
% TODO picture

Let $F \to E \xto{p} B$ be a fibre sequence where $F$ is path-connected, $B$ 1-connected, and $b_0 \in B$ a basepoint.
The differentials $d_r\colon E_r^{0, r - 1} \to E_r^{r, 0}$ are each defined on a subgroup of $E_2^{0, r - 1} \isom H^{r - 1}(F; A)$ and take values in a quotient of $H^n(B; A)$ ($A$ any abelian group).
\begin{definition}
	We call these differentials the \strong{transgressions}\index{transgression} and $x \in H^{r - 1}(F; A)$ \strong{transgressive}\index{transgressive element} if it lies in $E_r^{0, r - 1}$ so that its transgression is defined.
	We say that $x$ \emph{transgresses} to $y \in H^r(B; A)$ if $y$ is a representative of $d_r(x)$ in the quotient.
\end{definition}
\begin{theorem}
	In the diagram
	\begin{equation*}
		\begin{tikzcd}
			H^{r - 1}(F; A)
					\ar[r, "\delta"]
				& H^n(E, F; A)
				& H^n(B, b_0; A)
					\ar[l, swap, "p^*"]
		\end{tikzcd}
	\end{equation*}
	where $\delta$ is the coboundary map $x \in H^{r - 1}(F; A)$ is transgressive if and only if $\delta(x) \in \img p^*$.
	Moreover, the kernel of $H^r(B; A) \isom H^r(B, b_0; A) \to E_r^{r, 0}$ agrees with the kernel of $p^*$ and the transgression can be identified with
	\begin{equation*}
		\begin{tikzcd}[column sep = small, row sep = tiny]
			E_r^{0, r - 1}
					\ar[r, isomorphic]
				&[-1.1em] \delta^{-1}(\img p^*)
					\ar[r, "\delta"]
					\ar[d, ar symbol = \subseteq]
				& \img p^*
					\ar[d, ar symbol = \subseteq]
				& H^r(B, b_0; A) / \ker p^*
					\ar[l, swap, "p^*", "\isom"']
					\ar[d, isomorphic]
			\\
				& H^{r - 1}(F; A)
				& H^r(E, F; A)
				& E_r^{r, 0}
		\end{tikzcd}	
	\end{equation*}
\end{theorem}
\begin{proof}[Sketch of proof]
	Let $C_{\bullet, \bullet}(p; \Z)$ denote the double complex of singular $(p, q)-chains$.
	The applying $\Hom({{-}}; A)$ to the quotient
	\begin{equation*}
		C_{\bullet, \bullet}(p; \Z) / C_{\bullet, \bullet}(F \to \{b_0\}; \Z)
	\end{equation*}
	gives rise to a reduced version $\{\tilde{E}_r\}$ of the cohomological Serre spectral sequence of the form
	\begin{equation*}
		\tilde{E}_2^{p, q} = H^p(B, b_0; H^q(F; A)) \Rightarrow H^{p + q}(E, F; A)
	\end{equation*}
	We obtain a map of spectral sequences
	\begin{equation*}
		\{\tilde{E}_r\} \to \{E_r\}
	\end{equation*}
	Note that $\tilde{E}_2^{0, q} = 0$ and $\tilde{E}_2^{p, q} \to E_2^{p, q}$ is an isomorphism for all $p > 0$, so the second pages only differ in the first column.
	Applying our characterization of the edge homomorphism to the reduced spectral sequence, we conclude that
	\begin{equation*}
		\begin{tikzcd}
			E_r^{r, 0}
				& \tilde{E}_r^{r, 0} \isom \img(p^*\colon H^r(B, b_0; A) \to H^n(E, F; A))
					\ar[l, swap, "\isom"]
		\end{tikzcd}
	\end{equation*}
	and that the map
	\begin{equation*}
		\begin{tikzcd}
			H^r(B, b_0; A) \isom \tilde{E}_2^{r, 0}
					\ar[r]
				& \tilde{E}_r^{r, 0} \isom \tilde{E}_{\infty}^{r, 0}
					\ar[r, hook]
				& H^r(E, F; A)
		\end{tikzcd}
	\end{equation*}
	agrees with $p^*$.
	Let $\delta\colon H^{r - 1}(F; A) \to H^r(E, F; A)$ be the coboundary map and let $\alpha \in H^{r - 1}(F; A)$.
	Then the first non-zero differential on $\alpha$ in the absolute spectral sequence determines which filtration entry detects $\delta \alpha \in H^r(E, F; A)$ in the relative spectral sequence.
	Hence $\alpha$ is transgressive if and only if $\delta \alpha$ is of filtration degree $n$ which is isomorphic to the image of $p^*$ and its transgression is the coset $(p^*)^{-1}(\delta \alpha)$.
\end{proof}
\begin{theorem}[Transgression theorem]\index{transgression!theorem}
	The subset of transgressive classes in $H^*(F; \F_2)$ is closed under the application of each $\Sq^i$.
	If $x \in H^{n - 1}(F; \F_2)$ transgresses to $y \in H^n(B; \F_2)$, then $\Sq^i x$ transgresses to $\Sq^i y$.
\end{theorem}
\begin{proof}
	If $\delta(x) = p^*(y)$, then $\delta(\Sq^i x) = \Sq^i(\delta x) = \Sq^i(p^*(y)) = p^*(\Sq^i y)$ since $\delta$ commutes with $\Sq^i$ as it can be written as
	\begin{equation*}
		\begin{tikzcd}[column sep = small]
			H^{n - 1}(F; \F_2)
					\ar[r, "\sigma", "\isom"']
				& \tilde{H}^n(\Sigma F; \F_2)
					\ar[r]
				& \tilde{H}^n(C(i); \F_2) \isom H^n(E, F; \F_2)
		\end{tikzcd}
	\end{equation*}
	where $\sigma$ denotes the suspension isomorphism and $i$ is the inclusion $F \incl E$, and the $\Sq^i$ are stable.
\end{proof}
\begin{lemma}\label{lmm:admissiblesquarestructure}
	Let $X$ be a space, $x \in H^n(X; \F_2)$, and $I = (i_k, \ldots, i_0)$ an admissible sequence of natural numbers.
	Then:
	\begin{enumerate}
		\item If $e(I) > n$, then $\Sq^I x = 0$.
		\item If $e(I) = n$, then $\Sq^I x = \big(\Sq^{I'} x\big)^2$ for some $I'$ admissible with $e(I') \leq n$.
			In particular, each $\Sq^I x$ with $e(I) = n$ can be written as $\big(\Sq^J x\big)^{2^l}$ for some $l \geq 1$ with $e(J) < n$.
	\end{enumerate}
\end{lemma}
\begin{proof}
	\leavevmode
	\begin{enumerate}
		\item Since $i_k = i_{k - 1} + \ldots + i_0 + e(I)$, we have
			\begin{equation*}
				\big|\Sq^{i_{k - 1}} \cdots \Sq^{i_0} x\big| = |x| + i_{k - 1} + \ldots + i_0 = |x| + i_k - e(I) = n - \underbrace{e(I)}_{> n} + i_k < i_k
			\end{equation*}
			hence $\Sq^I x = \Sq^{i_k}\big(\Sq^{i_{k - 1}} \cdots \Sq^{i_0} x\big) = 0$.\footnote{since it is one of the axioms of the squares that $\Sq^l x = 0$ for all $l > |x|$ (from me)}
		\item Similarly, if $e(I) = n$, then $\big|\Sq^{i_{k - 1}} \cdots \Sq^{i_0} x\big| = i_k$, hence 
			\begin{equation*}
				\Sq^I x = \Sq^{i_k}\big(\Sq^{i_{k - 1}} \cdots \Sq^{i_0} x\big) = \big(\Sq^{i_{k - 1}} \cdots \Sq^{i_0} x\big)^2
			\end{equation*}
			and $e(I') - e(I) = n$ where $I' = (i_{k - 1}, \ldots, i_0)$.
			If $e(I') = n$, we can iterate this procedure until we reach a sequence $J$ of lower excess.
			\qedhere
	\end{enumerate}
\end{proof}
\begin{theorem}[Borel's theorem]\index{Borel's theorem}\label{thm:borel}
	Let $F \to E \to B$ be a fibre sequence with $E$ contractible and $B$ 1-connected.
	Assume that there exist transgressive elements $x_i \in H^*(F; \F_2)$ such that the square-free monomials in the $x_i$ form a basis of $H^*(F; \F_2)$.
	Let $y_i \in H^*(B; \F_2)$ denote an element representing the transgression of $x_i$ for all $i$.
	Then $H^*(B; \F_2)$ is a polynomial ring on the classes $y_i$.
\end{theorem}
\begin{remark}
	(from me) This theorem holds more generally for coefficients in an arbitrary field $K$, under the added assumption that $|x_i|$ be odd if $\chr K \neq 2$, see \cite[Thm. 5.34]{hatcher_chapter_nodate}.
\end{remark}
\begin{proof}
	We define a spectral sequence $\{\bar{E}_r^{p, q}\}_{r \geq 2}$ as follows:
	The groups $\bar{E}_r^{p, q}$ shall be given by
	\begin{equation*}
		\bar{E}_r^{p, q} \coloneq \bigdsum_{x_{i_1} \cdots x_{i_k} \in S^p_r} x_{i_1} \cdots x_{i_k} \cdot \F_2[\{y_j \mid |y_j| \geq r\}]_q
	\end{equation*}
	where $S^p_r \coloneq \big\{x_{i_1} \cdots x_{i_k} \mid k \in \N,\ |x_{i_j}| \geq r - 1 \text{ for all } j = 1, \ldots, k,\ |x_{i_1} \cdots x_{i_k}| = p\big\}$ is the set of square free monomials in the $x_i$ of degree $\geq r - 1$ of total degree $p$, the subscript $q$ on the right denotes degree $q$ of the internal grading of the polynomial ring, and the whole expression is graded by extending the degree of the $y_i$ in the obvious way.
	As for the differentials, we put
	\begin{equation*}
		d_r(x_{i_1} \cdots x_{i_k} \cdot P) \coloneq \sum_{j = 1}^k d_r(x_{i_j}) \cdot \prod_{l \neq j} x_{i_l} \cdot P
	\end{equation*}
	for $P \in \F_2[\{y_j \mid |y_j| \geq r\}]$ where
	\begin{equation*}
		d_r(x_i) \coloneq \begin{cases}
			y_i & |x_i| = r - 1 \\
			0 	& \text{else}
		\end{cases}
	\end{equation*}
	We note the following:
	\begin{enumerate}
		\item $d_r(x_{i_1} \cdots x_{i_k} \cdot P) = 0$ if and only if $|x_{i_l}| > r - 1$ for all $l = 1, \ldots, k$.
			This is because of the square-free condition which guarantess that the non-zero summands in $d_r(x_{i_1} \cdots x_{i_k} \cdot P)$ do not sum to 0.
		\item $\img d_r$ is contained in the subgroup generated by expressions of the form $x_{i_1} \cdots x_{i_k} \cdot Q$ where $Q$ is a monomial containing at least one $y_i$ with $|y_i| = r$.
		\item If $x_{i_1} \cdots x_{i_k} \cdot Q$ is such a monomial and $d_r(x_{i_1} \cdots x_{i_k} \cdot Q) = 0$, then $x_{i_1} \cdots x_{i_k} \cdot Q \in \img d_r$.
			\begin{smallproof}
				By the above we must have $|x_{i_l}| \geq r$ for all $l$.
				We can write $Q = Q' \cdot y_i$ with $|y_i| = r$.
				Then $i_l \neq i$ for all $l = 1, \ldots, k$, so $x_{i_1} \cdots x_{i_l} x_i$ is square-free, and
				\begin{equation*}
					d_r(x_{i_1} \cdots x_{i_l} x_i \cdot Q) = x_{i_1} \cdots x_{i_l} y_i \cdot Q' = x_{i_1} \cdots x_{i_l} Q
				\end{equation*}
			\end{smallproof}
		\item $d_r^2 = 0$: We calculate
			\begin{equation*}
				d_r^2(x_{i_1} \cdots x_{i_k} \cdot P) = \sum_{\substack{j \neq l \\ \mathclap{|x_{i_j}| = |x_{i_l}| = r - 1}}} y_{i_j} \cdot y_{i_l} \cdot \prod_{s \neq j, l} x_{i_s} \cdot P = 0
			\end{equation*}
			since every summand applies twice.
	\end{enumerate}
	\lecture{27.11.23}
	Items 1--3 show that the inclusions $\bar{E}_{r + 1} \to \bar{E}_r$ land in the kernel of $d_r$ and induce isomorphisms
	\begin{equation*}
		\bar{E}_{r + 1} \xto{\isom} H^*(\bar{E}_r)
	\end{equation*}
	so we indeed have a spectral sequence.
	Moreover, we obtain a map of spectral sequences 
	\begin{align*}
		\phi\colon \bar{E} &\to E \\
		x_{i_1} \cdots x_{i_k} \cdot P &\mapsto x_{i_1} \cdots x_{i_k} \cdot P
	\end{align*}
	using that the differentials $d_r$ on $E_r$ on elements of the form $x_{i_1} \cdots x_{i_k} \cdot P$ are determined by the differentials on the $x_i$ and the Leibniz rule.
	This map is an isomorphism on $E_r^{0, q}$ for all $r$ and on $E_\infty^{*, *}$.
	We now show that it is an isomorphism on $E_2^{p, q}$ by induction on $p$.
	Assume we know that it is an isomorphism on $E_2^{p, 0}$ for all $p < n$. 
	Then it is an isomorphism on $E_2^{p, q}$ for all $p < n$ and on $E_i^{n - i, i - 1}$ for all $i = 2, \ldots, n$ since all outgoing differentials do not leave that range until $d_i\colon E_i^{n - i, i - 1} \to E_i^{n, 0}$.
	Every $\alpha \in E_2^{n, 0}$ must be in the image of one of these $d_i$ since $E_\infty^{n, 0} = 0$.
	It follows that $\bar{E}_2^{n, 0} \to E_2^{n, 0}$ is surjective.
	Now assume that $\phi\colon \bar{E}_2^{n, 0} \to E_2^{n, 0}$ is not injective.
	Let $\alpha \neq 0 \in E_2^{n, 0}$ be in the kernel of $\phi$.
	Again, we can write $[\alpha] = d_i(\beta)$ for some $i$ and $\beta \in \bar{E}_i^{n - i, i - 1}$.
	Then $d_i(\phi(\beta)) = \phi(d_i(\beta)) = \phi(\alpha) = 0$.
	Hence $\phi(\beta) \in E_2^{n - i, i - 1}$ is a permanent cycle as $d_i$ is the last possible non-trivial differential at that point.
	But $\phi(\beta)$ is not in the image of $d_i$ since $\beta \in \bar{E}_i^{n - i, i - 1}$ is not (as $d_i(\beta) = [\alpha] \neq 0$) and all differentials landing in $E_i^{n - i, i - 1}$ are determined by these up into $\bar{E}_i^{n - i, i - 1}$ by the induction assumption.
	This finishes the proof.
\end{proof}
\begin{proof}[Proof of theorem \ref{thm:cartanserre}]
	For $K(\F_2, n)$ we start the induction with $K(\F_2, 1) \isom \RP^\infty$ for which we know the statement to hold.
	For $K(\Z, n)$ we analogously start with $K(\Z, 2) \isom \CP^\infty$.
	In theorem \ref{thm:borel} applied to the induction step and the Serre spectral sequence for the fibre sequence $K(\F_2, n) \to * \to K(\F_n, n + 1)$ we set the $x_i$ to be all the $\big(\Sq^I \iota_n\big)^{2^k}$ with $I$ an admissible sequence of excess $e(I) < n$.
	Note that the square-free monomials on these form a basis for $H^*(K(\F_2, n); \F_2)$ as powers of the form $\big(\Sq^I \iota_n\big)^m$ can be uniquely determined via their binary expansion\footnote{As an example, consider the graded ring $\F_2[x, y]$. This has as basis the monomials $x^k y^l$ which can be split up as $x^{2^{k_1}} \cdots x^{2^{k_m}} y^{2^{l_1}} \cdots y^{2^{l_n}}$ with the $k_i$ and $l_j$ uniquely determined by the binary expansions of $k$ and $l$}.
	For the integral case we only consider those $I$ with $i_0 \geq 2$.

	Note that $\iota_n$ transgresses to $\iota_{n + 1}$ since the $(n + 1)$-differential on $\iota_n$ is the only possibly nontrivial one.
	% TODO is this really the correct lemma to cite here?
	By lemma \ref{lmm:admissiblesquarestructure}, $\Sq^I \iota_n$ hence transgresses to $\Sq^I \iota_{n + 1}$ and $\big(\Sq^I \iota_n\big)^2$ transgresses to $\Sq^{2^{k - 1}(|I| + n)} \cdots \Sq^{|I| + n}\big(\Sq^I \iota_{n + 1}\big) = \Sq^J \iota_{n + 1}$ for $J = \big(2^{k - 1}(|I| + n), 2^{k - 2}(|I| + n), \ldots, |I| + n, I\big)$ if $k > 0$.
	As we saw, every $J$ with $e(I) = n$ arises in this way from an admissible sequence of smaller excess; this finishes the proof.
\end{proof}
\begin{example}
	Consider the fibre sequence $\RP^\infty \to * \to K(\F_2, 2)$.
	% TODO picture
\end{example}
\begin{corollary}
	The map 
	\begin{equation*}
		\psi\colon \symcal{A} \to \CohOpsst(\F_2)
	\end{equation*}
	is an isomorphism.
\end{corollary}
\begin{proof}
	We saw in proposition \ref{prp:cohopsbijections} that $\CohOpsst(\F_2)$ can be described in degree $k$ as the limit 
	\begin{equation*}
		\lim_{n \in \N} H^{k + n}(K(\F_2, n); \F_2)
	\end{equation*}
	We note that in degree $< n$ all admissible sequences $I$ have excess $e(I) < n$ since $e(I) = 2 i_n - |I| \leq 2 |I| - |I| = |I|$.
	Moreover, every product of the form $\Sq^I \iota_n \cdots \Sq^J \iota_n$ lies in degree $\geq 2n$ inside $H^*(K(\F_2, n); \F_2)$.
	It follows that up to degree $2n - 1$, $H^*(K(\F_2, n); \F_2)$ has a basis consisting of all the $\Sq^I \iota_n$ with $I$ admissible and $|I| < n$.
	Hence, in the limit, the ring of stable operations has a basis given by all $\Sq^I$ with $I$ admissible since the element $(\iota_1, \iota_2, \iota_3, \ldots)$ is the image of $1 \in \symcal{A}$.
	All $\Sq^I$ up to a given degree, all products, and all $\Sq^I \iota_n$ with $e(I) \geq n$ lie outside the stable range.
	In particular, $\psi$ is surjective.
	For injectivity, it suffices to show that every element in $\symcal{A}$ can be written as a sum of elements of the form $\Sq^I$ for $I$ an admissible sequence since $\psi$ is injective on their span given that their images are linearly independent.
	This can be achieved inductively using the Adem relations:
	Consider $\Sq^I = \Sq^{i_1} \cdots \Sq^{i_r}$ not necessarily admissible.
	We define $m(I) \coloneq \sum_{s = 1}^r s \cdot i_s$.
	If $I$ is not admissible, there exists some $j \in \{2, \ldots, r\}$ with $i_j < 2_{i_j} + 1$.
	We can then use the Adem relation
	\begin{equation*}
		\Sq^{i_1}\Sq^{i_{j + 1}} = \sum_{n = 0}^{\lfloor i_j / 2\rfloor} \binom{i_{j + 1} - n - 1}{i_j - 2n} \Sq^{i_j + i_{j + 1} - n}\Sq^n
	\end{equation*}
	to replace $\Sq^I$ with a sum of terms $\Sq^{I'}$ where
	\begin{equation*}
		I' = (i_1, \ldots, i_{j - 1}, i_j + i_{j + 1} - n, n, i_{j + 2}, \ldots, i_r)
	\end{equation*}
	Furthermore, 
	\begin{align*}
		m(I') &= m(I) + j (i_j + i_{j + 1} - n) + (j + 1) n - j i_j - (j + 1) i_{j + 1} \\
			  &= m(I) n - i_{j + 1} \\
			  &< m(I)
	\end{align*}
	since $n \leq i_j / 2$ and $i_j < 2_{i_{j + 1}}$.
	Since $m({{-}})$ cannot decrease beyond 0, this process must terminate.
\end{proof}
The following rather long exercise is not relevant for the exam but highly recommended:
\begin{exercise}
	Use our computation of $H^*(K(\F_2, n); \F_2)$ and $H^*(K(\Z, n); \F_2)$ and our understanding of transgressions to compute $\pi_6(S^3, *)$ as follows:
	\begin{enumerate}
		\item We know that $\pi_6(S^3, *)$ is finite and that its 3-torsion is a copy of $\Zn{3}$, and that there is no $p$-torsion for $p > 3$.
		\item To understand the 2-torsion, proceed inductively:
			\begin{enumerate}
				\item Compute $H^*(\tau_{\geq 4} S^3; \F_2)$ up to sufficiently high degrees via the fibre sequence $\tau_{\geq 4} S^3 \to S^3 \to K(\Z, 3)$.
				\item Compute $H^*(\tau_{\geq 5} S^3; \F_2)$ up to sufficiently high degrees via the fibre sequence $\tau_{\geq 5} S^3 \to \tau_{\geq 4} S^3 \to K(\F_2, 4)$.
				\item Compute $H^*(\tau_{\geq 6} S^3; \F_2)$ in degrees 6 and 7 and use the following fact to understand $H_6(\tau_{\geq 6} S^3; \Z) \isom \pi_6(S^3, *)$:
					If $X$ is a space, then
					\begin{itemize}
						\item every $\Z$-summand in $H_n(X; \Z)$ contributes an $\F_2$-summand in $H^n(X; \F_2)$,
						\item every $\Zn{2}$-summand in $H_n(X; \Z)$ contributes an $\F_2$-summand in $H^n(X; \Z)$ and one in $H^{n + 1}(X; \F_2)$ which are related by a $\Sq^1$, and
						\item every $\Zn{2^k}$-summand with $k > 1$ contributes one $\F_2$-summand in $H^n(X; \F_2)$ and one in $H^{n + 1}(X; \F_2)$ with no $\Sq^1$ between them.
					\end{itemize}
			\end{enumerate}
	\end{enumerate}
\end{exercise}
